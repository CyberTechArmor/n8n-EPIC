{
  "active": true,
  "connections": {
    "If": {
      "main": [
        [
          {
            "node": "Respond to Webhook1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Respond to Webhook7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Operation, do nothing": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook1": {
      "main": [
        [
          {
            "node": "Code12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook3": {
      "main": [
        [
          {
            "node": "Get many rows",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many rows": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Respond to Webhook15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code2": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook4": {
      "main": [
        [
          {
            "node": "Respond to Webhook16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook5": {
      "main": [
        [
          {
            "node": "Paitents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code3": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code4": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code5": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code6": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code7": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code8": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code9": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code10": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code11": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code12": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code13": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Paitents": {
      "main": [
        [
          {
            "node": "Limit",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook6": {
      "main": [
        [
          {
            "node": "Respond to Webhook18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get many rows1": {
      "main": [
        [
          {
            "node": "Respond to Webhook18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit": {
      "main": [
        [
          {
            "node": "Respond to Webhook17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-07-28T16:17:18.782Z",
  "id": "5hWXKfT6UNEFv2SK",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "EPIC PWA",
  "nodes": [
    {
      "parameters": {
        "path": "powerpack",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        40,
        -180
      ],
      "id": "4646e8fa-ec99-41dd-8d9b-e01cc75f4f52",
      "name": "Webhook",
      "webhookId": "d7a536e5-2bbe-4a10-9edb-4b03806808aa"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e3e9f22f-33a6-4254-931e-fd5542ec5a0d",
              "leftValue": "={{ $json.query.standalone }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        160,
        0
      ],
      "id": "2eac8176-5116-4770-b6ea-1cbece6e993e",
      "name": "If"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Embedded Iframe with Zoom Disabled</title>\n  <!-- Prevent zooming via meta tag -->\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\">\n  <meta name=\"theme-color\" content=\"#000000\">\n  <!-- Apple-specific meta tags -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\">\n  \n  <style>\n    /* The container fills the viewport and clips any overflow */\n    .iframe-container {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      overflow: hidden;\n    }\n    /* The iframe dimensions */\n    .iframe-container iframe {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border: none;\n      transform-origin: top left;\n    }\n  </style>\n  \n  <script src=\"https://cdn.jsdelivr.net/npm/keycloak-js@21.1.0/dist/keycloak.min.js\"></script>\n  \n  <script>\n    // Prevent double-tap zoom by intercepting touchend events.\n    let lastTouchEnd = 0;\n    document.addEventListener('touchend', function(event) {\n      const now = Date.now();\n      if (now - lastTouchEnd <= 300) {\n        event.preventDefault();\n      }\n      lastTouchEnd = now;\n    }, false);\n    \n    // Prevent pinch zoom by intercepting touchmove events.\n    document.addEventListener('touchmove', function(event) {\n      if (event.scale && event.scale !== 1) {\n        event.preventDefault();\n      }\n    }, { passive: false });\n\n    // Keycloak config\n    const KEYCLOAK_CONFIG = {\n      url: 'https://keycloak.cybertech.app',\n      realm: 'EPIC',\n      clientId: 'powerpack'\n    };\n\n    document.addEventListener('DOMContentLoaded', () => {\n      // Initialize Keycloak instance\n      const keycloak = new Keycloak(KEYCLOAK_CONFIG);\n\n      keycloak.init({ onLoad: 'login-required' }).then(authenticated => {\n        if (!authenticated) {\n          console.error('Failed to authenticate');\n          return;\n        }\n\n        const username = keycloak.tokenParsed?.preferred_username || 'unknown';\n\n        // Construct entity as \"EPIC/{realm}\"\n        const entity = `${KEYCLOAK_CONFIG.realm}/${KEYCLOAK_CONFIG.realm}`;\n\n        // Base URL updated as requested\n        const baseUrl = 'https://xl.epicpc.com/webhook/e225c70c-13d2-4902-bef9-977e3207b715';\n\n        const url = new URL(baseUrl);\n        url.searchParams.set('standalone', 'yes');\n        url.searchParams.set('entity', entity);\n        url.searchParams.set('user', username);\n\n        const iframeSrc = url.toString();\n\n        // Set iframe src dynamically\n        const iframe = document.querySelector('.iframe-container iframe');\n        iframe.src = iframeSrc;\n\n        console.log('Authenticated URL:', iframeSrc);\n      }).catch(err => {\n        console.error('Keycloak init error:', err);\n      });\n    });\n  </script>\n</head>\n<body>\n  <div class=\"iframe-container\">\n    <!-- iframe src set after Keycloak login -->\n    <iframe allow=\"accelerometer; ambient-light-sensor; autoplay; battery; camera; clipboard-read; clipboard-write; encrypted-media; fullscreen; geolocation; gyroscope; magnetometer; microphone; midi; payment; picture-in-picture; usb; xr-spatial-tracking;\">\n    </iframe>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        40,
        -360
      ],
      "id": "03eafca2-d3a3-4296-8bbe-b64709ad7092",
      "name": "Respond to Webhook7"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        60,
        420
      ],
      "id": "36be4dfa-17b4-47d6-981f-13f3b0256003",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node: This code outputs an HTML string with inline CSS/JS.\n// It dynamically uses incoming JSON with keys \"unlock\", \"ticket\", \"tools\", \n// \"iconunlock\", \"iconticket\", \"icontools\" to build three page contents.\n// All pages are preloaded into a tabbed view; only the active page is visible.\n// A single click on a nav button switches pages; a double click refreshes iframes in an already active page.\n// Additionally, a circular toggle enables drag mode (via a double tap) and collapses/expands the nav menu (via a single tap).\n// When the menu is collapsed, if the active menu item is pressed it fades away (its opacity transitions to 0)\n// but will be visible again if the menu is expanded.\n// Permissions for camera, microphone, geolocation, and fullscreen are enabled via a meta tag and by setting\n// the \"allow\" attribute on all iframes.\nconst inputData = items[0].json;\n\n// Map page content from incoming JSON.\nconst unlockContent = inputData.unlock || '<h1>Unlock</h1><p>Default Unlock Content</p>';\nconst ticketContent = inputData.ticket || '<h1>Ticket</h1><p>Default Ticket Content</p>';\nconst toolsContent = inputData.tools || '<h1>Tools</h1><p>Default Tools Content</p>';\n\n// Map icons using provided URLs (if available); otherwise, use default inline SVGs.\nconst unlockIcon = inputData.iconunlock && inputData.iconunlock.trim() !== \"\" \n  ? `<img src=\"${inputData.iconunlock}\" alt=\"Unlock Icon\" class=\"icon\" style=\"width:24px; height:24px; display:block; margin-bottom:4px;\">`\n  : `<svg class=\"icon\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n       <path d=\"M12 17a2 2 0 0 0 2-2v-4a2 2 0 0 0-4 0v4a2 2 0 0 0 2 2zm6-8h-1V7a5 5 0 0 0-10 0v2H6a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-9a2 2 0 0 0-2-2zM9 7a3 3 0 0 1 6 0v2H9V7z\"/>\n     </svg>`;\n\nconst ticketIcon = inputData.iconticket && inputData.iconticket.trim() !== \"\" \n  ? `<img src=\"${inputData.iconticket}\" alt=\"Ticket Icon\" class=\"icon\" style=\"width:24px; height:24px; display:block; margin-bottom:4px;\">`\n  : `<svg class=\"icon\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n       <path d=\"M2 21l21-9L11 2 2 21zm15-9.5l-1.5 1.5-2-2 1.5-1.5 2 2z\"/>\n     </svg>`;\n\nconst toolsIcon = inputData.icontools && inputData.icontools.trim() !== \"\" \n  ? `<img src=\"${inputData.icontools}\" alt=\"Tools Icon\" class=\"icon\" style=\"width:24px; height:24px; display:block; margin-bottom:4px;\">`\n  : `<svg class=\"icon\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n       <path d=\"M12 2a10 10 0 0 0-3.32 19.4l-1.66 1.66a1 1 0 0 0 1.41 1.41l1.66-1.66A10 10 0 1 0 12 2zm5 11h-2v2h-2v-2H9v-2h4V9h2v2h2v2z\"/>\n     </svg>`;\n\nreturn [\n  {\n    json: {\n      html: `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\" />\n  <!-- viewport-fit=cover for edge-to-edge display -->\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, viewport-fit=cover\">\n  <!-- Permissions Policy to allow camera, microphone, geolocation, and fullscreen -->\n  <meta http-equiv=\"Permissions-Policy\" content=\"camera=*, microphone=*, geolocation=*, fullscreen=*\">\n  <title>Tabbed View with Cached Pages & Enhanced Permissions</title>\n  <!-- Load canvas-confetti library for confetti effects -->\n  <script src=\"https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js\"></script>\n  <style>\n    :root {\n      --nav-height: 60px;\n      --default-offset: 40px;\n      --neon-color: #ff00ff; /* Cyber neon color */\n    }\n    body {\n      margin: 0;\n      font-family: Arial, sans-serif;\n      background-color: #f5f5f5;\n      min-height: 100vh;\n    }\n    /* Content area with three preloaded page containers */\n    #content {\n      padding: 20px;\n      box-sizing: border-box;\n    }\n    .page {\n      display: none;\n      min-height: calc(100vh - var(--nav-height));\n    }\n    .page.active {\n      display: block;\n    }\n    .bottom-nav {\n      position: fixed;\n      left: 0;\n      width: 100%;\n      height: var(--nav-height);\n      background-color: #333;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      z-index: 9999;\n      bottom: var(--default-offset);\n      transition: bottom 0.2s ease-out, background-color 0.2s ease-out;\n      touch-action: none;\n    }\n    .bottom-nav.collapsed {\n      background-color: transparent;\n    }\n    .nav-links {\n      display: flex;\n      flex: 1;\n      transition: opacity 0.2s ease-out;\n    }\n    /* In collapsed mode, only show the active menu item */\n    .bottom-nav.collapsed .nav-links a:not(.active) {\n      display: none;\n    }\n    /* Also hide the text label in collapsed mode */\n    .bottom-nav.collapsed .nav-links a.active span {\n      display: none;\n    }\n    .nav-links a {\n      flex: 1;\n      color: #fff;\n      text-align: center;\n      text-decoration: none;\n      transition: background-color 0.3s;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      font-size: 12px;\n      user-select: none;\n      cursor: pointer;\n      -webkit-tap-highlight-color: transparent;\n      outline: none;\n    }\n    /* Remove default focus and active background */\n    .nav-links a:active,\n    .nav-links a:focus {\n      background-color: transparent;\n      outline: none;\n    }\n    .nav-links a:hover {\n      background-color: #444;\n    }\n    /* Override hover for the active (selected) menu item so no grey change is shown */\n    .nav-links a.active:hover {\n      background-color: transparent;\n    }\n    /* Fade-out effect for active item when pressed in collapsed mode */\n    .nav-links a.faded {\n      opacity: 0;\n      transition: opacity 0.5s ease-out;\n    }\n    .icon {\n      width: 24px;\n      height: 24px;\n      margin-bottom: 4px;\n    }\n    /* Active icon neon effect */\n    .nav-links a.active .icon {\n      border: 2px solid var(--neon-color);\n      border-radius: 50%;\n      padding: 4px;\n      box-shadow: 0 0 8px 2px var(--neon-color);\n    }\n    /* Remove grey hover background in collapsed mode */\n    .bottom-nav.collapsed .nav-links a:hover {\n      background-color: transparent;\n    }\n    /* Toggle button styled as a circle.\n       The swap icon remains the same in all modes.\n    */\n    .drag-toggle {\n      width: 40px;\n      height: 40px;\n      border-radius: 50%;\n      background-color: #fff;\n      color: #333;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n      user-select: none;\n      margin-right: 5px;\n      flex-shrink: 0;\n      transition: background-color 0.2s ease-out, color 0.2s ease-out;\n    }\n    .bottom-nav.drag-mode {\n      background-color: #FF5722;\n    }\n    .bottom-nav.drag-mode .drag-toggle {\n      background-color: #333;\n      color: #fff;\n    }\n  </style>\n</head>\n<body>\n  <!-- Content area with cached pages -->\n  <div id=\"content\">\n    <div id=\"page-home\" class=\"page active\">\n      ${unlockContent}\n    </div>\n    <div id=\"page-search\" class=\"page\">\n      ${ticketContent}\n    </div>\n    <div id=\"page-profile\" class=\"page\">\n      ${toolsContent}\n    </div>\n  </div>\n\n  <div class=\"bottom-nav\" id=\"bottomNav\">\n    <div class=\"nav-links\" id=\"navLinks\">\n      <a data-page=\"home\" id=\"btnUnlock\">\n        ${unlockIcon}\n        <span>Unlock</span>\n      </a>\n      <a data-page=\"search\" id=\"btnTicket\">\n        ${ticketIcon}\n        <span>Ticket</span>\n      </a>\n      <a data-page=\"profile\" id=\"btnTools\">\n        ${toolsIcon}\n        <span>Tools</span>\n      </a>\n    </div>\n    <div class=\"drag-toggle\" id=\"dragToggle\">\n      <!-- Swap icon (always the same) -->\n      <svg fill=\"currentColor\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\">\n        <path d=\"M8 5v4H5l4 4 4-4h-3V5H8zm8 14v-4h3l-4-4-4 4h3v4h2z\"/>\n      </svg>\n    </div>\n  </div>\n\n  <script>\n    // --- Cached Pages Setup ---\n    const pages = {\n      home: document.getElementById('page-home'),\n      search: document.getElementById('page-search'),\n      profile: document.getElementById('page-profile')\n    };\n    let currentPage = 'home'; // default active page\n\n    // Track collapsed state and move mode.\n    let menuCollapsed = false;\n    let dragEnabled = false;\n\n    // Timer for detecting double tap.\n    let toggleTapTimer = null;\n    const tapDelay = 300; // milliseconds\n\n    // Function to update the toggle icon (always the same swap icon).\n    function updateToggleIcon() {\n      document.getElementById('dragToggle').innerHTML =\n        '<svg fill=\"currentColor\" viewBox=\"0 0 24 24\" width=\"20\" height=\"20\">' +\n        '<path d=\"M8 5v4H5l4 4 4-4h-3V5H8zm8 14v-4h3l-4-4-4 4h3v4h2z\"/>' +\n        '</svg>';\n    }\n\n    function showPage(page) {\n      // Hide all pages, then show the selected page.\n      for (const key in pages) {\n        pages[key].classList.remove('active');\n      }\n      pages[page].classList.add('active');\n      currentPage = page;\n      // Ensure any iframes in the newly visible page have proper permissions.\n      applyIframePermissions();\n    }\n\n    // --- Refresh Iframes in a Given Page ---\n    function refreshIframes(page) {\n      const iframes = pages[page].querySelectorAll('iframe');\n      iframes.forEach(iframe => {\n        iframe.src = iframe.src;\n      });\n    }\n\n    // --- Apply Permissions to Iframes ---\n    function applyIframePermissions() {\n      document.querySelectorAll('#content iframe').forEach(iframe => {\n        iframe.setAttribute('allow', 'camera; microphone; geolocation; fullscreen');\n      });\n    }\n\n    // --- Cookie Helpers ---\n    function getCookie(name) {\n      const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));\n      return match ? match[2] : null;\n    }\n    function setCookie(name, value, days) {\n      let expires = \"\";\n      if (days) {\n        const date = new Date();\n        date.setTime(date.getTime() + (days*24*60*60*1000));\n        expires = \"; expires=\" + date.toUTCString();\n      }\n      document.cookie = name + \"=\" + value + expires + \"; path=/; Secure\";\n    }\n\n    // --- Navigation Button Events ---\n    const navButtons = document.querySelectorAll('.nav-links a');\n    navButtons.forEach(button => {\n      let lastTap = 0;\n      button.addEventListener('click', function(e) {\n        const now = Date.now();\n        const page = button.getAttribute('data-page');\n        // If the menu is collapsed and the active button is pressed, fade it away.\n        if (nav.classList.contains('collapsed') && button.classList.contains('active')) {\n          button.classList.add('faded');\n          return;\n        }\n        // Otherwise, handle tap timing.\n        if (now - lastTap >= 300) {\n          showPage(page);\n          document.querySelectorAll('.nav-links a').forEach(btn => btn.classList.remove('active'));\n          button.classList.add('active');\n          updateToggleIcon();\n        }\n        else if (now - lastTap < 300) {\n          if (page === currentPage) {\n            refreshIframes(page);\n          }\n        }\n        lastTap = now;\n      });\n    });\n\n    // --- Draggable Navbar & Toggle Button ---\n    const nav = document.getElementById('bottomNav');\n    const dragToggle = document.getElementById('dragToggle');\n    let dragging = false;\n    let startY = 0;\n    let startOffset = 0;\n\n    // Single click handler for the toggle that waits for a possible double tap.\n    dragToggle.addEventListener('click', function(e) {\n      e.stopPropagation();\n      if (toggleTapTimer === null) {\n        toggleTapTimer = setTimeout(function() {\n          // Timer expired: treat as single tap.\n          if (dragEnabled) {\n            // If in move mode, exit move mode.\n            dragEnabled = false;\n            nav.classList.remove('drag-mode');\n          } else {\n            // Otherwise toggle collapse state.\n            menuCollapsed = !menuCollapsed;\n            if (menuCollapsed) {\n              nav.classList.add('collapsed');\n            } else {\n              nav.classList.remove('collapsed');\n              // Restore any faded nav buttons when expanded.\n              document.querySelectorAll('.nav-links a').forEach(btn => btn.classList.remove('faded'));\n            }\n          }\n          updateToggleIcon();\n          toggleTapTimer = null;\n        }, tapDelay);\n      } else {\n        // Second tap detected: cancel single tap action.\n        clearTimeout(toggleTapTimer);\n        toggleTapTimer = null;\n        // Double tap action: toggle move (drag) mode.\n        dragEnabled = !dragEnabled;\n        if (dragEnabled) {\n          nav.classList.add('drag-mode');\n        } else {\n          nav.classList.remove('drag-mode');\n        }\n      }\n    });\n\n    // Pointer events for dragging the nav bar when move mode is enabled.\n    nav.addEventListener('pointerdown', function(e) {\n      if (!dragEnabled) return;\n      startY = e.clientY;\n      startOffset = parseInt(nav.style.bottom) || parseInt(getComputedStyle(nav).bottom);\n      dragging = true;\n    });\n    nav.addEventListener('pointermove', function(e) {\n      if (!dragEnabled || !dragging) return;\n      const currentY = e.clientY;\n      const delta = startY - currentY;\n      const newOffset = startOffset + delta;\n      nav.style.bottom = newOffset + \"px\";\n      e.preventDefault();\n    });\n    nav.addEventListener('pointerup', function(e) {\n      if (!dragEnabled || !dragging) return;\n      dragging = false;\n      localStorage.setItem('navBarOffset', nav.style.bottom);\n      setCookie('navBarOffset', nav.style.bottom, 30);\n    });\n    nav.addEventListener('pointercancel', function(e) {\n      if (!dragEnabled || !dragging) return;\n      dragging = false;\n    });\n\n    // --- Initialization ---\n    function initNavBarPosition() {\n      let savedOffset = localStorage.getItem('navBarOffset');\n      if (!savedOffset) {\n        savedOffset = getCookie('navBarOffset');\n      }\n      if (savedOffset !== null) {\n        nav.style.bottom = savedOffset;\n      } else {\n        nav.style.bottom = \"var(--default-offset)\";\n      }\n    }\n    initNavBarPosition();\n    // Apply permissions to any iframes on initial load.\n    applyIframePermissions();\n\n    // --- Shake Detection for Confetti (3 discrete shakes) ---\n    const shakeThreshold = 15; // Acceleration threshold.\n    let shakeCount = 0;\n    let isShaking = false;\n    let lastShakeTime = 0;\n    const shakeResetTimeout = 3000; // Reset shake count if no shake within 3 seconds.\n\n    function handleShake(event) {\n      const acc = event.accelerationIncludingGravity;\n      if (!acc) return;\n      const totalAcc = Math.sqrt(acc.x * acc.x + acc.y * acc.y + acc.z * acc.z);\n      const now = Date.now();\n\n      // Reset count if enough time has passed since the last shake.\n      if (now - lastShakeTime > shakeResetTimeout) {\n        shakeCount = 0;\n      }\n      if (totalAcc > shakeThreshold) {\n        if (!isShaking) {\n          isShaking = true;\n          shakeCount++;\n          lastShakeTime = now;\n          if (shakeCount >= 3) {\n            triggerConfetti();\n            shakeCount = 0;\n          }\n        }\n      } else {\n        isShaking = false;\n      }\n    }\n\n    function triggerConfetti() {\n      // Explode confetti using canvas-confetti.\n      confetti({\n        particleCount: 100,\n        spread: 70,\n        origin: { y: 0.6 }\n      });\n    }\n\n    // Request permission for motion events on iOS 13+.\n    if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {\n      DeviceMotionEvent.requestPermission()\n      .then(permissionState => {\n        if (permissionState === 'granted') {\n          window.addEventListener('devicemotion', handleShake, false);\n        }\n      })\n      .catch(console.error);\n    } else {\n      window.addEventListener('devicemotion', handleShake, false);\n    }\n  </script>\n</body>\n</html>\n      `\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        580,
        420
      ],
      "id": "e8ad84ed-377c-4276-b781-aac48d460124",
      "name": "Code1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "bbd7a644-70bb-4298-89e5-0589d29f98d6",
              "name": "unlock",
              "value": "=<iframe src=\"https://n8n.cybertech.app/webhook/9d31760d-8307-48e0-a534-52b396d1d8f2?user=tstilwell%40epichs.org&role=Nuwell\" style=\"position: fixed; top: 0; left: 0; width: 100%; height: 100%; border: none; overflow: hidden;\" allow=\"camera; microphone;\"></iframe>",
              "type": "string"
            },
            {
              "id": "5b039444-93d1-405b-a7c8-c00b43b012f7",
              "name": "iconunlock",
              "value": "https://file.cybertech.app/CyberTech/PWA/NIT/icons8-lock-48%20(1).png",
              "type": "string"
            },
            {
              "id": "19b2f8ce-b3b3-4b6c-9ba0-8e9fc7fdaa95",
              "name": "ticket",
              "value": "=<iframe src=\"https://xl.epicpc.com/webhook/514a4954-d74e-4183-9694-94d76671c483?user=tstilwell%40epichs.org&role=Nuwell\" style=\"position: fixed; top: 0; left: 0; width: 100%; height: 100%; border: none; overflow: hidden;\" allow=\"camera; microphone;\"></iframe>",
              "type": "string"
            },
            {
              "id": "90a9c8f6-abbe-4300-abf1-89b50f533489",
              "name": "iconticket",
              "value": "https://file.cybertech.app/CyberTech/PWA/NIT/icons8-rocket-24.png",
              "type": "string"
            },
            {
              "id": "bee9d37f-8f52-4eee-85d7-043d9d84cc40",
              "name": "tools",
              "value": "=<iframe src=\"https://xl.epicpc.com/webhook/a43dadf7-5f56-42c0-b7a1-241bc6901507?user=tstilwell\" style=\"position: fixed; top: 0; left: 0; width: 100%; height: 100%; border: none; overflow: hidden;\" allow=\"camera; microphone;\"></iframe>",
              "type": "string"
            },
            {
              "id": "7905b8fe-7484-4880-8cf9-78af413172d9",
              "name": "icontools",
              "value": "https://file.cybertech.app/CyberTech/PWA/NIT/icons8-gps-signal-24.png",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        320,
        420
      ],
      "id": "d10c1d20-4643-4e20-8cb9-09528b450c96",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "path": "e225c70c-13d2-4902-bef9-977e3207b715",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -220,
        420
      ],
      "id": "40c6ba00-c089-4570-b706-4209cf020d4d",
      "name": "Webhook1",
      "webhookId": "e225c70c-13d2-4902-bef9-977e3207b715"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $json.html }}",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        860,
        420
      ],
      "id": "916522fa-97f3-42b5-a737-d6a5ae621a98",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta\n    name=\"msapplication-TileImage\"\n    content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Apple-specific meta tags for native-like appearance -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link\n    rel=\"apple-touch-icon\"\n    href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Use a more readable font -->\n  <link\n    href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\"\n    rel=\"stylesheet\"\n  />\n\n  <!-- Early redirect: if running standalone, redirect to webhook with standalone=yes -->\n  <script>\n    if (\n      window.matchMedia(\"(display-mode: standalone)\").matches ||\n      window.navigator.standalone === true\n    ) {\n      window.location.href =\n        \"https://xl.epicpc.com/webhook/e225c70c-13d2-4902-bef9-977e3207b715?standalone=yes\";\n    }\n  </script>\n\n  <script>\n    let deferredPrompt = null;\n\n    // Helper functions\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return (\n        (\"standalone\" in window.navigator && window.navigator.standalone) ||\n        window.matchMedia(\"(display-mode: standalone)\").matches\n      );\n    }\n\n    // Add manifest dynamically\n    const manifestData = {\n      name: \"EPIC Power Pack\",\n      short_name: \"PowerPack\",\n      start_url: \".\",\n      display: \"standalone\",\n      background_color: \"#ffffff\",\n      theme_color: \"#000000\",\n      icons: [\n        {\n          src:\n            \"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\",\n          sizes: \"512x512\",\n          type: \"image/png\",\n        },\n      ],\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], {\n      type: \"application/json\",\n    });\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement(\"link\");\n    manifestLink.rel = \"manifest\";\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    // Service worker registration\n    if (\"serviceWorker\" in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => {\n          console.log('Service Worker: Installed');\n          self.skipWaiting();\n        });\n        self.addEventListener('activate', event => {\n          console.log('Service Worker: Activated');\n        });\n      `;\n      const blob = new Blob([swCode], { type: \"text/javascript\" });\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker\n        .register(swURL)\n        .then((reg) => console.log(\"Service Worker registered with scope:\", reg.scope))\n        .catch((err) => console.error(\"Service Worker registration failed:\", err));\n    }\n\n    // Listen for beforeinstallprompt on supported platforms\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      if (window.innerWidth <= 768) {\n        document.getElementById(\"installBtnMobile\").style.display = \"inline-flex\";\n      } else {\n        document.getElementById(\"installBtnWindows\").style.display = \"inline-flex\";\n      }\n    });\n\n    // Show prompt or modal after load\n    window.addEventListener(\"load\", () => {\n      if (isIos() && !isInStandaloneMode()) {\n        setTimeout(() => {\n          document.getElementById(\"iosInstallModal\").style.display = \"flex\";\n        }, 1000);\n      } else if (deferredPrompt) {\n        if (window.innerWidth <= 768) {\n          document.getElementById(\"installBtnMobile\").style.display = \"inline-flex\";\n        } else {\n          document.getElementById(\"installBtnWindows\").style.display = \"inline-flex\";\n        }\n      }\n    });\n\n    // Handle install button clicks\n    document.addEventListener(\"DOMContentLoaded\", () => {\n      document.querySelectorAll(\".button-fancy\").forEach((button) => {\n        button.addEventListener(\"click\", async () => {\n          if (isIos() && !isInStandaloneMode()) {\n            document.getElementById(\"iosInstallModal\").style.display = \"flex\";\n          } else if (deferredPrompt) {\n            deferredPrompt.prompt();\n            const { outcome } = await deferredPrompt.userChoice;\n            console.log(\"User response to install prompt:\", outcome);\n            deferredPrompt = null;\n            // Hide buttons after prompt\n            document.getElementById(\"installBtnMobile\").style.display = \"none\";\n            document.getElementById(\"installBtnWindows\").style.display = \"none\";\n          }\n        });\n      });\n    });\n\n    function closeIosModal() {\n      document.getElementById(\"iosInstallModal\").style.display = \"none\";\n    }\n  </script>\n\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n    }\n\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.5);\n      padding: 30px;\n      margin: 50px auto;\n      width: 90%;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    .button-fancy {\n      display: none;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 10px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n    }\n\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n\n    .button-fancy:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n\n    .button-fancy:active {\n      transform: scale(0.95);\n    }\n\n    .button-fancy:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n\n    @keyframes ripple {\n      from {\n        transform: scale(0);\n        opacity: 1;\n      }\n      to {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      font-family: \"Roboto\", sans-serif;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n    }\n\n    #iosInstallModal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.8);\n      align-items: center;\n      justify-content: center;\n      z-index: 1000;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n    }\n\n    #iosInstallModal .modal-content {\n      background: #222;\n      padding: 20px;\n      border-radius: 10px;\n      text-align: center;\n      max-width: 90%;\n      color: #fff;\n      font-size: 18px;\n    }\n\n    #iosInstallModal .modal-content h3 {\n      margin-top: 0;\n    }\n\n    #iosInstallModal .close-btn {\n      background: #0ff;\n      border: none;\n      padding: 10px 20px;\n      margin-top: 15px;\n      border-radius: 5px;\n      cursor: pointer;\n      color: #000;\n      font-size: 16px;\n    }\n\n    @media only screen and (max-width: 768px) {\n      #installBtnMobile {\n        display: none;\n      }\n      #installBtnWindows {\n        display: none;\n      }\n    }\n\n    @media only screen and (min-width: 769px) {\n      #installBtnMobile {\n        display: none;\n      }\n      #installBtnWindows {\n        display: none;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <button id=\"installBtnMobile\" class=\"button-fancy\" aria-label=\"Install EPIC Power Pack (Mobile)\">\n      <svg\n        class=\"power-icon\"\n        viewBox=\"0 0 64 64\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        role=\"img\"\n      >\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n\n    <button id=\"installBtnWindows\" class=\"button-fancy\" aria-label=\"Install EPIC Power Pack (Desktop)\">\n      <svg\n        class=\"power-icon\"\n        viewBox=\"0 0 64 64\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        role=\"img\"\n      >\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n  </div>\n\n  <div id=\"iosInstallModal\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modalTitle\" tabindex=\"-1\">\n    <div class=\"modal-content\">\n      <h3 id=\"modalTitle\">Install Instructions</h3>\n      <p>\n        To install this app on your iOS device, tap the Share icon (<strong>the square with arrow</strong>) in Safari or Chrome and then select <strong>\"Add to Home Screen\"</strong>.\n      </p>\n      <button class=\"close-btn\" onclick=\"closeIosModal()\">Close</button>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        2120,
        -40
      ],
      "id": "a6dcfeee-154e-4717-8ee3-eb14259ae1d0",
      "name": "Respond to Webhook2"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta\n    name=\"msapplication-TileImage\"\n    content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Apple-specific meta tags for native-like appearance -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link\n    rel=\"apple-touch-icon\"\n    href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Use a more readable font -->\n  <link\n    href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\"\n    rel=\"stylesheet\"\n  />\n\n  <script>\n    let deferredPrompt = null;\n\n    // Helpers\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return (\n        ('standalone' in window.navigator && window.navigator.standalone) ||\n        window.matchMedia('(display-mode: standalone)').matches\n      );\n    }\n\n    // Dynamically add web app manifest\n    const manifestData = {\n      name: \"EPIC Power Pack\",\n      short_name: \"PowerPack\",\n      start_url: \".\",\n      display: \"standalone\",\n      background_color: \"#ffffff\",\n      theme_color: \"#000000\",\n      icons: [\n        {\n          src:\n            \"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\",\n          sizes: \"512x512\",\n          type: \"image/png\",\n        },\n      ],\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], {\n      type: \"application/json\",\n    });\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement(\"link\");\n    manifestLink.rel = \"manifest\";\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    // Register minimal Service Worker\n    if (\"serviceWorker\" in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => {\n          self.skipWaiting();\n        });\n        self.addEventListener('activate', event => {\n          // no-op\n        });\n      `;\n      const blob = new Blob([swCode], { type: \"text/javascript\" });\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker\n        .register(swURL)\n        .catch((err) => console.error('Service Worker registration failed:', err));\n    }\n\n    // beforeinstallprompt for native install on supported devices (Chrome/Edge)\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      document.getElementById(\"installBtn\").style.display = \"inline-flex\";\n    });\n\n    window.addEventListener(\"load\", () => {\n      if (isIos() && !isInStandaloneMode()) {\n        // Show install button even on iOS for consistency\n        document.getElementById(\"installBtn\").style.display = \"inline-flex\";\n      } else if (deferredPrompt) {\n        // Also show on Android/etc after beforeinstallprompt event fires\n        document.getElementById(\"installBtn\").style.display = \"inline-flex\";\n      }\n    });\n\n    document.addEventListener(\"DOMContentLoaded\", () => {\n      const btn = document.getElementById(\"installBtn\");\n      const modal = document.getElementById(\"installModal\");\n      const closeBtn = document.getElementById(\"closeModalBtn\");\n\n      btn.addEventListener(\"click\", async () => {\n        if (isIos() && !isInStandaloneMode()) {\n          modal.style.display = \"flex\";\n        } else if (deferredPrompt) {\n          deferredPrompt.prompt();\n          const { outcome } = await deferredPrompt.userChoice;\n          console.log(\"User response to install prompt:\", outcome);\n          deferredPrompt = null;\n          btn.style.display = \"none\";\n        } else {\n          // Fallback modal for any other unsupported devices\n          modal.style.display = \"flex\";\n        }\n      });\n\n      closeBtn.addEventListener(\"click\", () => {\n        modal.style.display = \"none\";\n      });\n    });\n  </script>\n\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n      overflow-x: hidden;\n    }\n\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.5);\n      padding: 30px;\n      margin: 50px auto;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    #installBtn {\n      display: none;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 20px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      user-select: none;\n    }\n\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n\n    #installBtn:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n\n    #installBtn:active {\n      transform: scale(0.95);\n    }\n\n    #installBtn:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n\n    @keyframes ripple {\n      from {\n        transform: scale(0);\n        opacity: 1;\n      }\n      to {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n      font-family: \"Roboto\", sans-serif;\n    }\n\n    /* Modal styling */\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: rgba(0, 0, 0, 0.85);\n      align-items: center;\n      justify-content: center;\n      z-index: 10000;\n      padding: 20px;\n      box-sizing: border-box;\n      overflow-y: auto;\n      flex-direction: column;\n    }\n\n    #installModal.flex {\n      display: flex;\n    }\n\n    #installModal .modal-content {\n      background: #222;\n      border-radius: 10px;\n      max-width: 450px;\n      width: 100%;\n      color: #fff;\n      font-size: 16px;\n      padding: 25px;\n      box-sizing: border-box;\n    }\n\n    #installModal h3 {\n      margin-top: 0;\n      text-align: center;\n      font-size: 1.5em;\n    }\n\n    #installModal ul {\n      list-style: none;\n      padding: 0;\n      margin: 15px 0 0 0;\n    }\n\n    #installModal li {\n      margin-bottom: 18px;\n      display: flex;\n      align-items: center;\n      gap: 12px;\n    }\n\n    #installModal li svg,\n    #installModal li img {\n      width: 28px;\n      height: 28px;\n      flex-shrink: 0;\n      fill: #0ff;\n      stroke: #0ff;\n    }\n\n    #installModal .close-btn {\n      margin-top: 20px;\n      width: 100%;\n      background: #0ff;\n      border: none;\n      padding: 12px 0;\n      font-weight: bold;\n      color: #000;\n      border-radius: 5px;\n      cursor: pointer;\n      font-size: 16px;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <button id=\"installBtn\" class=\"button-fancy\" aria-label=\"Install EPIC Power Pack\">\n      <svg\n        class=\"power-icon\"\n        viewBox=\"0 0 64 64\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        role=\"img\"\n      >\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\"></circle>\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\"></line>\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n  </div>\n\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modalTitle\" tabindex=\"-1\" style=\"display:none; flex-direction: column; align-items:center;\">\n    <div class=\"modal-content\">\n      <h3 id=\"modalTitle\">Install Instructions</h3>\n      <ul>\n        <li>\n          <!-- Android Chrome icon -->\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\"><rect x=\"3\" y=\"11\" width=\"18\" height=\"8\" rx=\"2\" ry=\"2\"/><path d=\"M7 11V7a5 5 0 0 1 10 0v4\"/></svg>\n          <span><strong>Android Chrome/Edge:</strong> Tap the browser menu and select <em>Add to Home screen</em>.</span>\n        </li>\n        <li>\n          <!-- iOS Safari share icon -->\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\"><path d=\"M18 19a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2h3l2-3 2 3h3a2 2 0 0 1 2 2z\"/></svg>\n          <span><strong>iOS Safari:</strong> Tap the <em>Share</em> icon (the square with arrow) then tap <em>Add to Home Screen</em>.</span>\n        </li>\n        <li>\n          <!-- Desktop icon -->\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\"><rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\"/><line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\"/><line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\"/></svg>\n          <span><strong>Desktop Browsers:</strong> Use the browser menu and select <em>Install App</em> or <em>Add to Desktop</em> if available.</span>\n        </li>\n      </ul>\n      <button id=\"closeModalBtn\" class=\"close-btn\" aria-label=\"Close install instructions\">Close</button>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        2320,
        -40
      ],
      "id": "f791400f-37e6-4d57-965d-bbf76d4a531c",
      "name": "Respond to Webhook3"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Embedded Iframe with Zoom Disabled</title>\n  <!-- Prevent zooming via meta tag -->\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\">\n  <meta name=\"theme-color\" content=\"#000000\">\n  <!-- Apple-specific meta tags -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\">\n  \n  <style>\n    /* The container fills the viewport and clips any overflow */\n    .iframe-container {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      overflow: hidden;\n    }\n    /* The iframe's intrinsic size is half of the container,\n       then scaled up 2× to fill the space */\n    .iframe-container iframe {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: calc(100% / 1);\n      height: calc(100% / 1);\n      transform: scale(1);\n      transform-origin: top left;\n      border: none;\n    }\n  </style>\n  \n  <script>\n    // Prevent double-tap zoom by intercepting touchend events.\n    let lastTouchEnd = 0;\n    document.addEventListener('touchend', function(event) {\n      const now = Date.now();\n      if (now - lastTouchEnd <= 300) {\n        event.preventDefault();\n      }\n      lastTouchEnd = now;\n    }, false);\n    \n    // Prevent pinch zoom by intercepting touchmove events.\n    document.addEventListener('touchmove', function(event) {\n      if (event.scale && event.scale !== 1) {\n        event.preventDefault();\n      }\n    }, { passive: false });\n  </script>\n</head>\n<body>\n  <div class=\"iframe-container\">\n    <iframe src=\"https://n8n.cybertech.app/webhook/e225c70c-13d2-4902-bef9-977e3207b715\"\n            allow=\"accelerometer; ambient-light-sensor; autoplay; battery; camera; clipboard-read; clipboard-write; encrypted-media; fullscreen; geolocation; gyroscope; magnetometer; microphone; midi; payment; picture-in-picture; usb; xr-spatial-tracking;\">\n    </iframe>\n  </div>\n</body>\n</html>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        240,
        -360
      ],
      "id": "e5c31469-5eef-4b64-b377-d0ef0264d355",
      "name": "Respond to Webhook8"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta\n    name=\"msapplication-TileImage\"\n    content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Apple-specific meta tags for native-like appearance -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link\n    rel=\"apple-touch-icon\"\n    href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Use a readable font -->\n  <link\n    href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\"\n    rel=\"stylesheet\"\n  />\n\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n      overflow-x: hidden;\n    }\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.6);\n      padding: 30px;\n      margin: 50px auto;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    #installBtn {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 20px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      user-select: none;\n    }\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n    #installBtn:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n    #installBtn:active {\n      transform: scale(0.95);\n    }\n    #installBtn:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n    @keyframes ripple {\n      from {\n        transform: scale(0);\n        opacity: 1;\n      }\n      to {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n      font-family: \"Roboto\", sans-serif;\n    }\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: rgba(0, 0, 0, 0.9);\n      align-items: center;\n      justify-content: center;\n      z-index: 10000;\n      padding: 20px;\n      box-sizing: border-box;\n      overflow-y: auto;\n      flex-direction: column;\n    }\n    #installModal.flex {\n      display: flex;\n    }\n    #installModal .modal-content {\n      background: #222;\n      border-radius: 10px;\n      max-width: 460px;\n      width: 100%;\n      color: #fff;\n      font-size: 16px;\n      padding: 25px 30px;\n      box-sizing: border-box;\n    }\n    #installModal h3 {\n      margin-top: 0;\n      text-align: center;\n      font-size: 1.6em;\n    }\n    #installModal ul {\n      list-style: none;\n      padding: 0;\n      margin: 15px 0 0 0;\n    }\n    #installModal li {\n      margin-bottom: 20px;\n      display: flex;\n      align-items: center;\n      gap: 14px;\n      line-height: 1.3;\n    }\n    #installModal li svg {\n      width: 28px;\n      height: 28px;\n      flex-shrink: 0;\n      stroke: #0ff;\n      fill: none;\n    }\n    #installModal .close-btn {\n      margin-top: 25px;\n      width: 100%;\n      background: #0ff;\n      border: none;\n      padding: 12px 0;\n      font-weight: bold;\n      color: #000;\n      border-radius: 5px;\n      cursor: pointer;\n      font-size: 16px;\n      transition: background 0.2s ease;\n    }\n    #installModal .close-btn:hover,\n    #installModal .close-btn:focus {\n      background: #33ffff;\n      outline: none;\n    }\n    /* Confetti container */\n    #confetti-wrapper {\n      pointer-events: none;\n      position: fixed;\n      top: 0; left: 0;\n      width: 100%;\n      height: 100%;\n      overflow: visible;\n      z-index: 11000;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <button id=\"installBtn\" class=\"button-fancy\" aria-label=\"Activate Power On\">\n      <svg\n        class=\"power-icon\"\n        viewBox=\"0 0 64 64\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        role=\"img\"\n      >\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\"></circle>\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\"></line>\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n  </div>\n\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modalTitle\" tabindex=\"-1\" style=\"display:none;\">\n    <div class=\"modal-content\">\n      <h3 id=\"modalTitle\">Install Instructions</h3>\n      <ul>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <rect x=\"3\" y=\"11\" width=\"18\" height=\"8\" rx=\"2\" ry=\"2\"/>\n            <path d=\"M7 11V7a5 5 0 0 1 10 0v4\"/>\n          </svg>\n          <strong>Android Chrome/Edge:</strong> Tap the browser menu and select <em>Add to Home screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <path d=\"M18 19a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2h3l2-3 2 3h3a2 2 0 0 1 2 2z\"/>\n          </svg>\n          <strong>iOS Safari:</strong> Tap the <em>Share</em> icon (the square with arrow) then tap <em>Add to Home Screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\"/>\n            <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\"/>\n            <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\"/>\n          </svg>\n          <strong>Desktop Browsers:</strong> Use the browser menu and select <em>Install App</em> or <em>Add to Desktop</em> if available.\n        </li>\n      </ul>\n      <button id=\"closeModalBtn\" class=\"close-btn\" aria-label=\"Close install instructions\">Close</button>\n    </div>\n  </div>\n\n  <!-- Confetti container -->\n  <div id=\"confetti-wrapper\"></div>\n\n  <script>\n    let deferredPrompt = null;\n\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return (\n        ('standalone' in window.navigator && window.navigator.standalone) ||\n        window.matchMedia('(display-mode: standalone)').matches\n      );\n    }\n\n    // Setup manifest dynamically\n    const manifestData = {\n      name: 'EPIC Power Pack',\n      short_name: 'PowerPack',\n      start_url: '.',\n      display: 'standalone',\n      background_color: '#ffffff',\n      theme_color: '#000000',\n      icons: [\n        {\n          src: 'https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png',\n          sizes: '512x512',\n          type: 'image/png'\n        }\n      ]\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], {type:'application/json'});\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement('link');\n    manifestLink.rel = 'manifest';\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    // Service worker registration\n    if ('serviceWorker' in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => { self.skipWaiting(); });\n        self.addEventListener('activate', event => {});\n      `;\n      const blob = new Blob([swCode], {type:'text/javascript'});\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker.register(swURL).catch(e => console.error('SW Reg failed', e));\n    }\n\n    // Show install button on beforeinstallprompt\n    window.addEventListener('beforeinstallprompt', e => {\n      e.preventDefault();\n      deferredPrompt = e;\n      document.getElementById('installBtn').style.display = 'inline-flex';\n    });\n\n    // Show install button on iOS if not installed\n    window.addEventListener('load', () => {\n      if (isIos() && !isInStandaloneMode()) {\n        document.getElementById('installBtn').style.display = 'inline-flex';\n      } else if (deferredPrompt) {\n        document.getElementById('installBtn').style.display = 'inline-flex';\n      }\n    });\n\n    // Confetti utility\n    function createConfettiParticle(x, y) {\n      const particle = document.createElement('div');\n      const size = Math.floor(Math.random() * 8) + 6 + 'px';\n      particle.style.position = 'fixed';\n      particle.style.left = x + 'px';\n      particle.style.top = y + 'px';\n      particle.style.width = size;\n      particle.style.height = size;\n      particle.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;\n      particle.style.borderRadius = '50%';\n      particle.style.pointerEvents = 'none';\n      particle.style.zIndex = 11000;\n      particle.style.opacity = 1;\n      particle.style.transform = `translate(0, 0)`;\n      particle.style.willChange = 'transform, opacity';\n\n      const directionX = (Math.random() - 0.5) * 200;\n      const directionY = (Math.random() - 1) * 200;\n\n      let start = null;\n      function animate(timestamp) {\n        if (!start) start = timestamp;\n        const progress = timestamp - start;\n        const easeOut = 1 - Math.pow(1 - progress / 1000, 3);\n\n        particle.style.transform = `translate(${directionX * easeOut}px, ${directionY * easeOut}px)`;\n        particle.style.opacity = String(1 - easeOut);\n\n        if (progress < 1000) {\n          requestAnimationFrame(animate);\n        } else {\n          particle.remove();\n        }\n      }\n\n      requestAnimationFrame(animate);\n      return particle;\n    }\n\n    function runConfetti(x, y) {\n      const container = document.getElementById('confetti-wrapper');\n      for (let i = 0; i < 30; i++) {\n        const particle = createConfettiParticle(x, y);\n        container.appendChild(particle);\n      }\n    }\n\n    document.addEventListener('DOMContentLoaded', () => {\n      const btn = document.getElementById('installBtn');\n      const modal = document.getElementById('installModal');\n      const closeBtn = document.getElementById('closeModalBtn');\n\n      btn.addEventListener('click', async (e) => {\n        // Run confetti at button center\n        const rect = btn.getBoundingClientRect();\n        runConfetti(rect.left + rect.width / 2, rect.top + rect.height / 2);\n\n        if (isIos() && !isInStandaloneMode()) {\n          modal.style.display = 'flex';\n          modal.focus();\n        } else if (deferredPrompt) {\n          deferredPrompt.prompt();\n          const { outcome } = await deferredPrompt.userChoice;\n          console.log('User response to install prompt:', outcome);\n          deferredPrompt = null;\n          btn.style.display = 'none';\n        } else {\n          modal.style.display = 'flex';\n          modal.focus();\n        }\n      });\n\n      closeBtn.addEventListener('click', () => {\n        modal.style.display = 'none';\n        btn.focus();\n      });\n\n      // Close modal on Escape key\n      window.addEventListener('keydown', (e) => {\n        if (e.key === 'Escape' && modal.style.display === 'flex') {\n          modal.style.display = 'none';\n          btn.focus();\n        }\n      });\n    });\n  </script>\n\n  <!-- Confetti container -->\n  <div id=\"confetti-wrapper\"></div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        2540,
        -40
      ],
      "id": "1ca8453a-1935-495a-958d-ceb955d5a8f6",
      "name": "Respond to Webhook4"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta\n    name=\"msapplication-TileImage\"\n    content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Apple-specific meta tags for native-like appearance -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link\n    rel=\"apple-touch-icon\"\n    href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Use a readable font -->\n  <link\n    href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\"\n    rel=\"stylesheet\"\n  />\n\n  <style>\n    /* Your existing styles unchanged */\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n      overflow-x: hidden;\n    }\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.6);\n      padding: 30px;\n      margin: 50px auto;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    #installBtn {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 20px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      user-select: none;\n    }\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n    #installBtn:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n    #installBtn:active {\n      transform: scale(0.95);\n    }\n    #installBtn:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n    @keyframes ripple {\n      from {\n        transform: scale(0);\n        opacity: 1;\n      }\n      to {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n      font-family: \"Roboto\", sans-serif;\n    }\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: rgba(0, 0, 0, 0.9);\n      align-items: center;\n      justify-content: center;\n      z-index: 10000;\n      padding: 20px;\n      box-sizing: border-box;\n      overflow-y: auto;\n      flex-direction: column;\n    }\n    #installModal.flex {\n      display: flex;\n    }\n    #installModal .modal-content {\n      background: #222;\n      border-radius: 10px;\n      max-width: 460px;\n      width: 100%;\n      color: #fff;\n      font-size: 16px;\n      padding: 25px 30px;\n      box-sizing: border-box;\n    }\n    #installModal h3 {\n      margin-top: 0;\n      text-align: center;\n      font-size: 1.6em;\n    }\n    #installModal ul {\n      list-style: none;\n      padding: 0;\n      margin: 15px 0 0 0;\n    }\n    #installModal li {\n      margin-bottom: 20px;\n      display: flex;\n      align-items: center;\n      gap: 14px;\n      line-height: 1.3;\n    }\n    #installModal li svg {\n      width: 28px;\n      height: 28px;\n      flex-shrink: 0;\n      stroke: #0ff;\n      fill: none;\n    }\n    #installModal .close-btn {\n      margin-top: 25px;\n      width: 100%;\n      background: #0ff;\n      border: none;\n      padding: 12px 0;\n      font-weight: bold;\n      color: #000;\n      border-radius: 5px;\n      cursor: pointer;\n      font-size: 16px;\n      transition: background 0.2s ease;\n    }\n    #installModal .close-btn:hover,\n    #installModal .close-btn:focus {\n      background: #33ffff;\n      outline: none;\n    }\n    /* Confetti container */\n    #confetti-wrapper {\n      pointer-events: none;\n      position: fixed;\n      top: 0; left: 0;\n      width: 100%;\n      height: 100%;\n      overflow: visible;\n      z-index: 11000;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <button id=\"installBtn\" class=\"button-fancy\" aria-label=\"Activate Power On\" style=\"display:none;\">\n      <svg\n        class=\"power-icon\"\n        viewBox=\"0 0 64 64\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        role=\"img\"\n      >\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\"></circle>\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\"></line>\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n  </div>\n\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modalTitle\" tabindex=\"-1\" style=\"display:none;\">\n    <div class=\"modal-content\">\n      <h3 id=\"modalTitle\">Install Instructions</h3>\n      <ul>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <rect x=\"3\" y=\"11\" width=\"18\" height=\"8\" rx=\"2\" ry=\"2\"/>\n            <path d=\"M7 11V7a5 5 0 0 1 10 0v4\"/>\n          </svg>\n          <strong>Android Chrome/Edge:</strong> Tap the browser menu and select <em>Add to Home screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <path d=\"M18 19a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2h3l2-3 2 3h3a2 2 0 0 1 2 2z\"/>\n          </svg>\n          <strong>iOS Safari:</strong> Tap the <em>Share</em> icon (the square with arrow) then tap <em>Add to Home Screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\"/>\n            <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\"/>\n            <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\"/>\n          </svg>\n          <strong>Desktop Browsers:</strong> Use the browser menu and select <em>Install App</em> or <em>Add to Desktop</em> if available.\n        </li>\n      </ul>\n      <button id=\"closeModalBtn\" class=\"close-btn\" aria-label=\"Close install instructions\">Close</button>\n    </div>\n  </div>\n\n  <!-- Confetti container -->\n  <div id=\"confetti-wrapper\"></div>\n\n  <script src=\"https://cdn.jsdelivr.net/npm/keycloak-js@latest/dist/keycloak.min.js\"></script>\n  <script>\n    // Stored constants for Keycloak config & entity / base url\n    const KEYCLOAK_CONFIG = {\n      url: 'https://keycloak.cybertech.app',\n      realm: 'EPIC',\n      clientId: 'powerpack'  // your client id here\n    };\n    const ENTITY = 'e225c70c-13d2-4902-bef9-977e3207b715';\n    const BASE_IFRAME_URL = 'https://xl.epicpc.com/webhook/powerpack';\n\n    const KEYCLOAK_STORAGE_KEY = 'epic_powerpack_authenticated_url';\n\n    // Keycloak instance global\n    let keycloak = null;\n\n    // Initialize Keycloak and handle authentication & storing url\n    async function initKeycloak() {\n      keycloak = new Keycloak(KEYCLOAK_CONFIG);\n\n      try {\n        const authenticated = await keycloak.init({ onLoad: 'login-required' });\n        if (!authenticated) {\n          alert('Authentication failed, please refresh and try again.');\n          return;\n        }\n        const user = keycloak.tokenParsed.preferred_username || 'unknown';\n\n        // Build the full URL with query params\n        const url = new URL(BASE_IFRAME_URL);\n        url.searchParams.set('entity', ENTITY);\n        url.searchParams.set('user', user);\n        const fullUrl = url.toString();\n\n        // Store it locally for subsequent use\n        localStorage.setItem(KEYCLOAK_STORAGE_KEY, fullUrl);\n\n        // Show \"Power On\" button (if hidden)\n        document.getElementById('installBtn').style.display = 'inline-flex';\n\n        // Optionally: You could auto-launch the iframe/page here or wait for user click\n        // window.location.href = fullUrl;\n\n      } catch (err) {\n        console.error('Keycloak init error:', err);\n        alert('Authentication or initialization error.');\n      }\n    }\n\n    // On Power On button click, launch the stored URL\n    function launchApp() {\n      const storedUrl = localStorage.getItem(KEYCLOAK_STORAGE_KEY);\n      if (storedUrl) {\n        // Redirect user to the constructed URL\n        window.location.href = storedUrl;\n      } else {\n        alert('No authenticated session found, please refresh and login again.');\n      }\n    }\n\n    // Your existing install and confetti code left unchanged \n    let deferredPrompt = null;\n\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return (\n        ('standalone' in window.navigator && window.navigator.standalone) ||\n        window.matchMedia('(display-mode: standalone)').matches\n      );\n    }\n\n    // Setup manifest dynamically\n    const manifestData = {\n      name: 'EPIC Power Pack',\n      short_name: 'PowerPack',\n      start_url: '.',\n      display: 'standalone',\n      background_color: '#ffffff',\n      theme_color: '#000000',\n      icons: [\n        {\n          src: 'https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png',\n          sizes: '512x512',\n          type: 'image/png'\n        }\n      ]\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], {type:'application/json'});\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement('link');\n    manifestLink.rel = 'manifest';\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    // Service worker registration\n    if ('serviceWorker' in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => { self.skipWaiting(); });\n        self.addEventListener('activate', event => {});\n      `;\n      const blob = new Blob([swCode], {type:'text/javascript'});\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker.register(swURL).catch(e => console.error('SW Reg failed', e));\n    }\n\n    // Show install button on beforeinstallprompt\n    window.addEventListener('beforeinstallprompt', e => {\n      e.preventDefault();\n      deferredPrompt = e;\n      // Wait for authentication before showing install button (done in initKeycloak)\n    });\n\n    // Show install button on iOS if not installed\n    window.addEventListener('load', () => {\n      // Initiate Keycloak and show button when ready\n      initKeycloak();\n\n      if (isIos() && !isInStandaloneMode()) {\n        document.getElementById('installBtn').style.display = 'inline-flex';\n      } else if (deferredPrompt) {\n        // deferredPrompt is set in beforeinstallprompt event, but we show the button only after auth\n        // so no action here\n      }\n    });\n\n    document.addEventListener('DOMContentLoaded', () => {\n      const btn = document.getElementById('installBtn');\n      const modal = document.getElementById('installModal');\n      const closeBtn = document.getElementById('closeModalBtn');\n\n      btn.addEventListener('click', async (e) => {\n        // Run confetti at button center\n        const rect = btn.getBoundingClientRect();\n        runConfetti(rect.left + rect.width / 2, rect.top + rect.height / 2);\n\n        launchApp();\n\n        if (isIos() && !isInStandaloneMode()) {\n          modal.style.display = 'flex';\n          modal.focus();\n        } else if (deferredPrompt) {\n          deferredPrompt.prompt();\n          const { outcome } = await deferredPrompt.userChoice;\n          console.log('User response to install prompt:', outcome);\n          deferredPrompt = null;\n          btn.style.display = 'none';\n        } else {\n          modal.style.display = 'flex';\n          modal.focus();\n        }\n      });\n\n      closeBtn.addEventListener('click', () => {\n        modal.style.display = 'none';\n        btn.focus();\n      });\n\n      // Close modal on Escape key\n      window.addEventListener('keydown', (e) => {\n        if (e.key === 'Escape' && modal.style.display === 'flex') {\n          modal.style.display = 'none';\n          btn.focus();\n        }\n      });\n    });\n\n    // Confetti utility functions (unchanged)\n    function createConfettiParticle(x, y) {\n      const particle = document.createElement('div');\n      const size = Math.floor(Math.random() * 8) + 6 + 'px';\n      particle.style.position = 'fixed';\n      particle.style.left = x + 'px';\n      particle.style.top = y + 'px';\n      particle.style.width = size;\n      particle.style.height = size;\n      particle.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;\n      particle.style.borderRadius = '50%';\n      particle.style.pointerEvents = 'none';\n      particle.style.zIndex = 11000;\n      particle.style.opacity = 1;\n      particle.style.transform = `translate(0, 0)`;\n      particle.style.willChange = 'transform, opacity';\n\n      const directionX = (Math.random() - 0.5) * 200;\n      const directionY = (Math.random() - 1) * 200;\n\n      let start = null;\n      function animate(timestamp) {\n        if (!start) start = timestamp;\n        const progress = timestamp - start;\n        const easeOut = 1 - Math.pow(1 - progress / 1000, 3);\n\n        particle.style.transform = `translate(${directionX * easeOut}px, ${directionY * easeOut}px)`;\n        particle.style.opacity = String(1 - easeOut);\n\n        if (progress < 1000) {\n          requestAnimationFrame(animate);\n        } else {\n          particle.remove();\n        }\n      }\n\n      requestAnimationFrame(animate);\n      return particle;\n    }\n\n    function runConfetti(x, y) {\n      const container = document.getElementById('confetti-wrapper');\n      for (let i = 0; i < 30; i++) {\n        const particle = createConfettiParticle(x, y);\n        container.appendChild(particle);\n      }\n    }\n  </script>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        2540,
        -180
      ],
      "id": "6451c170-6335-4dd4-876f-0cd5ba4db2bb",
      "name": "Respond to Webhook5"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta\n    name=\"msapplication-TileImage\"\n    content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Apple-specific meta tags for native-like appearance -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link\n    rel=\"apple-touch-icon\"\n    href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Use a readable font -->\n  <link\n    href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\"\n    rel=\"stylesheet\"\n  />\n\n  <style>\n    /* Your full existing CSS styles */\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n      overflow-x: hidden;\n    }\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.6);\n      padding: 30px;\n      margin: 50px auto;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    #installBtn {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 20px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      user-select: none;\n      display: none; /* initially hidden, show after login */\n    }\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n    #installBtn:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n    #installBtn:active {\n      transform: scale(0.95);\n    }\n    #installBtn:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n    @keyframes ripple {\n      from {\n        transform: scale(0);\n        opacity: 1;\n      }\n      to {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n      font-family: \"Roboto\", sans-serif;\n    }\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: rgba(0, 0, 0, 0.9);\n      align-items: center;\n      justify-content: center;\n      z-index: 10000;\n      padding: 20px;\n      box-sizing: border-box;\n      overflow-y: auto;\n      flex-direction: column;\n    }\n    #installModal.flex {\n      display: flex;\n    }\n    #installModal .modal-content {\n      background: #222;\n      border-radius: 10px;\n      max-width: 460px;\n      width: 100%;\n      color: #fff;\n      font-size: 16px;\n      padding: 25px 30px;\n      box-sizing: border-box;\n    }\n    #installModal h3 {\n      margin-top: 0;\n      text-align: center;\n      font-size: 1.6em;\n    }\n    #installModal ul {\n      list-style: none;\n      padding: 0;\n      margin: 15px 0 0 0;\n    }\n    #installModal li {\n      margin-bottom: 20px;\n      display: flex;\n      align-items: center;\n      gap: 14px;\n      line-height: 1.3;\n    }\n    #installModal li svg {\n      width: 28px;\n      height: 28px;\n      flex-shrink: 0;\n      stroke: #0ff;\n      fill: none;\n    }\n    #installModal .close-btn {\n      margin-top: 25px;\n      width: 100%;\n      background: #0ff;\n      border: none;\n      padding: 12px 0;\n      font-weight: bold;\n      color: #000;\n      border-radius: 5px;\n      cursor: pointer;\n      font-size: 16px;\n      transition: background 0.2s ease;\n    }\n    #installModal .close-btn:hover,\n    #installModal .close-btn:focus {\n      background: #33ffff;\n      outline: none;\n    }\n    /* Confetti container */\n    #confetti-wrapper {\n      pointer-events: none;\n      position: fixed;\n      top: 0; left: 0;\n      width: 100%;\n      height: 100%;\n      overflow: visible;\n      z-index: 11000;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <button id=\"installBtn\" class=\"button-fancy\" aria-label=\"Activate Power On\">\n      <svg\n        class=\"power-icon\"\n        viewBox=\"0 0 64 64\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        role=\"img\"\n      >\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\"></circle>\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\"></line>\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n  </div>\n\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modalTitle\" tabindex=\"-1\" style=\"display:none;\">\n    <div class=\"modal-content\">\n      <h3 id=\"modalTitle\">Install Instructions</h3>\n      <ul>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <rect x=\"3\" y=\"11\" width=\"18\" height=\"8\" rx=\"2\" ry=\"2\"/>\n            <path d=\"M7 11V7a5 5 0 0 1 10 0v4\"/>\n          </svg>\n          <strong>Android Chrome/Edge:</strong> Tap the browser menu and select <em>Add to Home screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <path d=\"M18 19a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2h3l2-3 2 3h3a2 2 0 0 1 2 2z\"/>\n          </svg>\n          <strong>iOS Safari:</strong> Tap the <em>Share</em> icon (the square with arrow) then tap <em>Add to Home Screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\" >\n            <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\"/>\n            <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\"/>\n            <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\"/>\n          </svg>\n          <strong>Desktop Browsers:</strong> Use the browser menu and select <em>Install App</em> or <em>Add to Desktop</em> if available.\n        </li>\n      </ul>\n      <button id=\"closeModalBtn\" class=\"close-btn\" aria-label=\"Close install instructions\">Close</button>\n    </div>\n  </div>\n\n  <!-- Confetti container -->\n  <div id=\"confetti-wrapper\"></div>\n\n  <script src=\"https://cdn.jsdelivr.net/npm/keycloak-js@latest/dist/keycloak.min.js\"></script>\n  <script>\n    // Config & URLs\n    const KEYCLOAK_CONFIG = {\n      url: 'https://keycloak.cybertech.app',\n      realm: 'EPIC',\n      clientId: 'powerpack'\n    };\n\n    const MAIN_APP_URL = 'https://xl.epicpc.com/webhook/powerpack';  // Your app's main page and redirect URI in Keycloak\n    const INSTALLED_APP_BASE_URL = 'https://xl.epicpc.com/webhook/e225c70c-13d2-4902-bef9-977e3207b715';  // Installed app base URL\n    const ENTITY = 'e225c70c-13d2-4902-bef9-977e3207b715';\n\n    const STORAGE_KEY = 'epic_powerpack_authenticated_url';\n\n    let keycloak;\n\n    async function initKeycloak() {\n      keycloak = new Keycloak(KEYCLOAK_CONFIG);\n      try {\n        const authenticated = await keycloak.init({\n          onLoad: 'login-required',\n          redirectUri: MAIN_APP_URL\n        });\n\n        if (!authenticated) {\n          alert('Authentication failed, please refresh and try again.');\n          return;\n        }\n\n        const user = keycloak.tokenParsed?.preferred_username || 'unknown';\n\n        const url = new URL(INSTALLED_APP_BASE_URL);\n        url.searchParams.set('standalone', 'yes');\n        url.searchParams.set('entity', ENTITY);\n        url.searchParams.set('user', user);\n\n        localStorage.setItem(STORAGE_KEY, url.toString());\n\n        const installBtn = document.getElementById('installBtn');\n        if (installBtn) installBtn.style.display = 'inline-flex';\n\n      } catch (err) {\n        console.error('Keycloak init error:', err);\n        alert('Authentication or initialization error.');\n      }\n    }\n\n    function launchApp() {\n      const url = localStorage.getItem(STORAGE_KEY);\n      if (url) {\n        window.location.href = url;\n      } else {\n        alert('No authenticated session found, please refresh and login again.');\n      }\n    }\n\n    // PWA install & confetti code\n    let deferredPrompt = null;\n\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return (\n        ('standalone' in window.navigator && window.navigator.standalone) ||\n        window.matchMedia('(display-mode: standalone)').matches\n      );\n    }\n\n    window.addEventListener('beforeinstallprompt', (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      // Show install button only after successful auth\n    });\n\n    window.addEventListener('load', () => {\n      initKeycloak();\n\n      if (isIos() && !isInStandaloneMode()) {\n        const installBtn = document.getElementById('installBtn');\n        if (installBtn) installBtn.style.display = 'inline-flex';\n      }\n    });\n\n    document.addEventListener('DOMContentLoaded', () => {\n      const btn = document.getElementById('installBtn');\n      const modal = document.getElementById('installModal');\n      const closeBtn = document.getElementById('closeModalBtn');\n\n      if (!btn || !modal || !closeBtn) {\n        console.error('Missing required DOM elements for event listeners');\n        return;\n      }\n\n      btn.addEventListener('click', async () => {\n        const rect = btn.getBoundingClientRect();\n        runConfetti(rect.left + rect.width / 2, rect.top + rect.height / 2);\n\n        launchApp();\n\n        if (isIos() && !isInStandaloneMode()) {\n          modal.style.display = 'flex';\n          modal.focus();\n        } else if (deferredPrompt) {\n          deferredPrompt.prompt();\n          const { outcome } = await deferredPrompt.userChoice;\n          deferredPrompt = null;\n          btn.style.display = 'none';\n        } else {\n          modal.style.display = 'flex';\n          modal.focus();\n        }\n      });\n\n      closeBtn.addEventListener('click', () => {\n        modal.style.display = 'none';\n        btn.focus();\n      });\n\n      window.addEventListener('keydown', (e) => {\n        if (e.key === 'Escape' && modal.style.display === 'flex') {\n          modal.style.display = 'none';\n          btn.focus();\n        }\n      });\n    });\n\n    // Confetti functions\n    function createConfettiParticle(x, y) {\n      const particle = document.createElement('div');\n      const size = Math.floor(Math.random() * 8) + 6 + 'px';\n      particle.style.position = 'fixed';\n      particle.style.left = x + 'px';\n      particle.style.top = y + 'px';\n      particle.style.width = size;\n      particle.style.height = size;\n      particle.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;\n      particle.style.borderRadius = '50%';\n      particle.style.pointerEvents = 'none';\n      particle.style.zIndex = 11000;\n      particle.style.opacity = 1;\n      particle.style.transform = `translate(0, 0)`;\n      particle.style.willChange = 'transform, opacity';\n\n      const directionX = (Math.random() - 0.5) * 200;\n      const directionY = (Math.random() - 1) * 200;\n\n      let start = null;\n      function animate(timestamp) {\n        if (!start) start = timestamp;\n        const progress = timestamp - start;\n        const easeOut = 1 - Math.pow(1 - progress / 1000, 3);\n\n        particle.style.transform = `translate(${directionX * easeOut}px, ${directionY * easeOut}px)`;\n        particle.style.opacity = String(1 - easeOut);\n\n        if (progress < 1000) {\n          requestAnimationFrame(animate);\n        } else {\n          particle.remove();\n        }\n      }\n\n      requestAnimationFrame(animate);\n      return particle;\n    }\n\n    function runConfetti(x, y) {\n      const container = document.getElementById('confetti-wrapper');\n      for (let i = 0; i < 30; i++) {\n        const particle = createConfettiParticle(x, y);\n        container.appendChild(particle);\n      }\n    }\n  </script>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        2120,
        -200
      ],
      "id": "36586211-3e4a-4f9e-869e-d7be19923284",
      "name": "Respond to Webhook6"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n  <!-- Windows and Apple meta tags (unchanged) -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta name=\"msapplication-TileImage\" content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link rel=\"apple-touch-icon\" href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n  <link href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" rel=\"stylesheet\" />\n  <style>\n    /* Your existing CSS */\n    body {\n      margin: 0; padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\") no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n      overflow-x: hidden;\n    }\n    .overlay {\n      background-color: rgba(0,0,0,0.6);\n      padding: 30px;\n      margin: 50px auto;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);\n    }\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);\n    }\n    #installBtn {\n      display: none; /* hidden initially; show after auth */\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 20px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      user-select: none;\n      display: flex;\n    }\n    @keyframes pulse {\n      0% { box-shadow: 0 0 10px #0ff; }\n      50% { box-shadow: 0 0 20px #0ff; }\n      100% { box-shadow: 0 0 10px #0ff; }\n    }\n    #installBtn:hover { box-shadow: 0 0 30px #0ff; }\n    #installBtn:active { transform: scale(0.95); }\n    #installBtn:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px; height: 120px;\n      border-radius: 50%;\n      background: rgba(0,255,255,0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0; left: 0;\n    }\n    @keyframes ripple {\n      from { transform: scale(0); opacity: 1; }\n      to { transform: scale(1.5); opacity: 0;}\n    }\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0,0,0,0.7);\n      font-family: \"Roboto\", sans-serif;\n    }\n    /* Modal and confetti styles omitted for brevity - copy from your original */\n    /* ... */\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <button id=\"installBtn\" class=\"button-fancy\" aria-label=\"Activate Power On\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\" role=\"img\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\"></circle>\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\"></line>\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n  </div>\n\n  <!-- Install modal and confetti wrapper HTML... (copy as is from your original) -->\n\n  <script src=\"https://cdn.jsdelivr.net/npm/keycloak-js@latest/dist/keycloak.min.js\"></script>\n  <script>\n    const KEYCLOAK_CONFIG = {\n      url: 'https://keycloak.cybertech.app',\n      realm: 'EPIC',\n      clientId: 'powerpack'\n    };\n    const MAIN_APP_URL = 'https://xl.epicpc.com/webhook/powerpack';\n    const INSTALLED_APP_BASE_URL = 'https://xl.epicpc.com/webhook/e225c70c-13d2-4902-bef9-977e3207b715';\n    const ENTITY = 'e225c70c-13d2-4902-bef9-977e3207b715';\n\n    const STORAGE_KEY = 'epic_powerpack_authenticated_url';\n\n    let keycloak;\n\n    async function initKeycloak() {\n      keycloak = new Keycloak(KEYCLOAK_CONFIG);\n      try {\n        // Use \"check-sso\" to try silent login, no forced redirect\n        const authenticated = await keycloak.init({\n          onLoad: 'check-sso',\n          silentCheckSsoRedirectUri: window.location.origin + '/silent-check-sso.html',\n          redirectUri: MAIN_APP_URL,\n          pkceMethod: 'S256'\n        });\n\n        if (authenticated) {\n          const user = keycloak.tokenParsed?.preferred_username || 'unknown';\n\n          const url = new URL(INSTALLED_APP_BASE_URL);\n          url.searchParams.set('standalone', 'yes');\n          url.searchParams.set('entity', ENTITY);\n          url.searchParams.set('user', user);\n\n          localStorage.setItem(STORAGE_KEY, url.toString());\n\n          document.getElementById('installBtn').style.display = 'inline-flex';\n        }\n        // If not authenticated, just remain on page. You may trigger login on button click if you prefer.\n      } catch (err) {\n        console.error('Keycloak init error:', err);\n        alert('Error initializing authentication.');\n      }\n    }\n\n    function launchApp() {\n      const url = localStorage.getItem(STORAGE_KEY);\n      if(url) {\n        window.location.href = url;\n      } else {\n        alert('No authenticated session available. Please login and try again.');\n      }\n    }\n\n    // Wait for DOM to be ready\n    document.addEventListener('DOMContentLoaded', () => {\n      initKeycloak();\n\n      const btn = document.getElementById('installBtn');\n      if(btn) {\n        btn.addEventListener('click', () => {\n          launchApp();\n        });\n      }\n    });\n\n    // Add your confetti and install modal code as you had it before (unchanged)\n    // ...\n  </script>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        2780,
        -40
      ],
      "id": "c8c462f5-7fe5-4f8a-a046-19c5bf09f3ef",
      "name": "Respond to Webhook9"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta\n    name=\"msapplication-TileImage\"\n    content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Apple-specific meta tags for native-like appearance -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link\n    rel=\"apple-touch-icon\"\n    href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\"\n  />\n\n  <!-- Google Fonts -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" rel=\"stylesheet\" />\n\n  <!-- Redirect if app is installed to the standalone URL -->\n  <script>\n    if (\n      window.matchMedia(\"(display-mode: standalone)\").matches ||\n      window.navigator.standalone === true\n    ) {\n      window.location.href =\n        \"https://xl.epicpc.com/webhook/powerpack?standalone=yes\";\n    }\n  </script>\n\n  <script>\n    let deferredPrompt = null;\n\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return (\n        (\"standalone\" in window.navigator && window.navigator.standalone) ||\n        window.matchMedia(\"(display-mode: standalone)\").matches\n      );\n    }\n\n    // Dynamically add manifest with start_url including standalone=yes\n    const manifestData = {\n      name: \"EPIC Power Pack\",\n      short_name: \"PowerPack\",\n      start_url: \"/webhook/powerpack?standalone=yes\",\n      display: \"standalone\",\n      background_color: \"#ffffff\",\n      theme_color: \"#000000\",\n      icons: [\n        {\n          src: \"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\",\n          sizes: \"512x512\",\n          type: \"image/png\",\n        },\n      ],\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], {\n      type: \"application/json\",\n    });\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement(\"link\");\n    manifestLink.rel = \"manifest\";\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    // Register a minimal service worker\n    if (\"serviceWorker\" in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => { self.skipWaiting(); });\n        self.addEventListener('activate', event => {});\n      `;\n      const blob = new Blob([swCode], { type: \"text/javascript\" });\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker\n        .register(swURL)\n        .catch((err) => console.error(\"Service Worker registration failed:\", err));\n    }\n\n    // Listen for beforeinstallprompt event on supported platforms\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      document.getElementById(\"installBtn\").style.display = \"inline-flex\";\n    });\n\n    window.addEventListener(\"load\", () => {\n      if (isIos() && !isInStandaloneMode()) {\n        // Show install button on iOS if not installed\n        document.getElementById(\"installBtn\").style.display = \"inline-flex\";\n      } else if (deferredPrompt) {\n        // Show install button if prompt available (Android etc)\n        document.getElementById(\"installBtn\").style.display = \"inline-flex\";\n      }\n    });\n\n    // Confetti helper functions\n    function createConfettiParticle(x, y) {\n      const particle = document.createElement(\"div\");\n      const size = Math.floor(Math.random() * 8) + 6 + \"px\";\n      particle.style.position = \"fixed\";\n      particle.style.left = x + \"px\";\n      particle.style.top = y + \"px\";\n      particle.style.width = size;\n      particle.style.height = size;\n      particle.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;\n      particle.style.borderRadius = \"50%\";\n      particle.style.pointerEvents = \"none\";\n      particle.style.zIndex = 11000;\n      particle.style.opacity = 1;\n      particle.style.transform = `translate(0, 0)`;\n      particle.style.willChange = \"transform, opacity\";\n\n      const directionX = (Math.random() - 0.5) * 200;\n      const directionY = (Math.random() - 1) * 200;\n\n      let start = null;\n      function animate(timestamp) {\n        if (!start) start = timestamp;\n        const progress = timestamp - start;\n        const easeOut = 1 - Math.pow(1 - progress / 1000, 3);\n\n        particle.style.transform = `translate(${directionX * easeOut}px, ${directionY * easeOut}px)`;\n        particle.style.opacity = String(1 - easeOut);\n\n        if (progress < 1000) {\n          requestAnimationFrame(animate);\n        } else {\n          particle.remove();\n        }\n      }\n\n      requestAnimationFrame(animate);\n      return particle;\n    }\n\n    function runConfetti(x, y) {\n      const container = document.getElementById(\"confetti-wrapper\");\n      for (let i = 0; i < 30; i++) {\n        const particle = createConfettiParticle(x, y);\n        container.appendChild(particle);\n      }\n    }\n\n    document.addEventListener(\"DOMContentLoaded\", () => {\n      const btn = document.getElementById(\"installBtn\");\n      const modal = document.getElementById(\"installModal\");\n      const closeBtn = document.getElementById(\"closeModalBtn\");\n\n      btn.addEventListener(\"click\", async (e) => {\n        const rect = btn.getBoundingClientRect();\n        runConfetti(rect.left + rect.width / 2, rect.top + rect.height / 2);\n\n        if (isIos() && !isInStandaloneMode()) {\n          modal.style.display = \"flex\";\n          modal.focus();\n        } else if (deferredPrompt) {\n          deferredPrompt.prompt();\n          const { outcome } = await deferredPrompt.userChoice;\n          console.log(\"User response to install prompt:\", outcome);\n          deferredPrompt = null;\n          btn.style.display = \"none\";\n        } else {\n          modal.style.display = \"flex\";\n          modal.focus();\n        }\n      });\n\n      closeBtn.addEventListener(\"click\", () => {\n        modal.style.display = \"none\";\n        btn.focus();\n      });\n\n      window.addEventListener(\"keydown\", (e) => {\n        if (e.key === \"Escape\" && modal.style.display === \"flex\") {\n          modal.style.display = \"none\";\n          btn.focus();\n        }\n      });\n    });\n  </script>\n\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n      overflow-x: hidden;\n    }\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.6);\n      padding: 30px;\n      margin: 50px auto;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    #installBtn {\n      display: none;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 20px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      user-select: none;\n    }\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n    #installBtn:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n    #installBtn:active {\n      transform: scale(0.95);\n    }\n    #installBtn:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n    @keyframes ripple {\n      from {\n        transform: scale(0);\n        opacity: 1;\n      }\n      to {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n      font-family: \"Roboto\", sans-serif;\n    }\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: rgba(0, 0, 0, 0.9);\n      align-items: center;\n      justify-content: center;\n      z-index: 10000;\n      padding: 20px;\n      box-sizing: border-box;\n      overflow-y: auto;\n      flex-direction: column;\n    }\n    #installModal.flex {\n      display: flex;\n    }\n    #installModal .modal-content {\n      background: #222;\n      border-radius: 10px;\n      max-width: 460px;\n      width: 100%;\n      color: #fff;\n      font-size: 16px;\n      padding: 25px 30px;\n      box-sizing: border-box;\n    }\n    #installModal h3 {\n      margin-top: 0;\n      text-align: center;\n      font-size: 1.6em;\n    }\n    #installModal ul {\n      list-style: none;\n      padding: 0;\n      margin: 15px 0 0 0;\n    }\n    #installModal li {\n      margin-bottom: 20px;\n      display: flex;\n      align-items: center;\n      gap: 14px;\n      line-height: 1.3;\n    }\n    #installModal li svg {\n      width: 28px;\n      height: 28px;\n      flex-shrink: 0;\n      stroke: #0ff;\n      fill: none;\n    }\n    #installModal .close-btn {\n      margin-top: 25px;\n      width: 100%;\n      background: #0ff;\n      border: none;\n      padding: 12px 0;\n      font-weight: bold;\n      color: #000;\n      border-radius: 5px;\n      cursor: pointer;\n      font-size: 16px;\n      transition: background 0.2s ease;\n    }\n    #installModal .close-btn:hover,\n    #installModal .close-btn:focus {\n      background: #33ffff;\n      outline: none;\n    }\n    /* Confetti container */\n    #confetti-wrapper {\n      pointer-events: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      overflow: visible;\n      z-index: 11000;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <button id=\"installBtn\" class=\"button-fancy\" aria-label=\"Activate Power On\">\n      <svg\n        class=\"power-icon\"\n        viewBox=\"0 0 64 64\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        aria-hidden=\"true\"\n        focusable=\"false\"\n        role=\"img\"\n      >\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\"></circle>\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\"></line>\n      </svg>\n      <span class=\"btn-text\">Power On</span>\n    </button>\n  </div>\n\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modalTitle\" tabindex=\"-1\">\n    <div class=\"modal-content\">\n      <h3 id=\"modalTitle\">Install Instructions</h3>\n      <ul>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n            <rect x=\"3\" y=\"11\" width=\"18\" height=\"8\" rx=\"2\" ry=\"2\"/>\n            <path d=\"M7 11V7a5 5 0 0 1 10 0v4\"/>\n          </svg>\n          <strong>Android Chrome/Edge:</strong> Tap the browser menu and select <em>Add to Home screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n            <path d=\"M18 19a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2h3l2-3 2 3h3a2 2 0 0 1 2 2z\"/>\n          </svg>\n          <strong>iOS Safari:</strong> Tap the <em>Share</em> icon (the square with arrow) then tap <em>Add to Home Screen</em>.\n        </li>\n        <li>\n          <svg viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" aria-hidden=\"true\">\n            <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" ry=\"2\"/>\n            <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\"/>\n            <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\"/>\n          </svg>\n          <strong>Desktop Browsers:</strong> Use the browser menu and select <em>Install App</em> or <em>Add to Desktop</em> if available.\n        </li>\n      </ul>\n      <button id=\"closeModalBtn\" class=\"close-btn\" aria-label=\"Close install instructions\">Close</button>\n    </div>\n  </div>\n\n  <div id=\"confetti-wrapper\"></div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        3000,
        -20
      ],
      "id": "6de9a5e3-3848-4edf-b312-2f95f2c4527d",
      "name": "Respond to Webhook10"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta name=\"msapplication-TileImage\" content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n\n  <!-- Apple-specific meta tags -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link rel=\"apple-touch-icon\" href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n\n  <!-- Google Fonts -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" rel=\"stylesheet\" />\n\n  <script>\n    // Redirect if running standalone PWA (browser or iOS)\n    if (\n      window.matchMedia('(display-mode: standalone)').matches ||\n      window.navigator.standalone === true\n    ) {\n      window.location.href = \"https://xl.epicpc.com/webhook/powerpack?standalone=yes\";\n    }\n  </script>\n\n  <script>\n    let deferredPrompt = null;\n\n    // Detect iOS devices\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    // Detect standalone mode in iOS Safari\n    function isInStandaloneMode() {\n      return ('standalone' in window.navigator) && window.navigator.standalone;\n    }\n\n    // Dynamically add manifest\n    const manifestData = {\n      name: \"EPIC Power Pack\",\n      short_name: \"PowerPack\",\n      start_url: \".\",\n      display: \"standalone\",\n      background_color: \"#ffffff\",\n      theme_color: \"#000000\",\n      icons: [\n        {\n          src: \"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\",\n          sizes: \"512x512\",\n          type: \"image/png\"\n        }\n      ]\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], { type: 'application/json' });\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement('link');\n    manifestLink.rel = 'manifest';\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    // Listen for beforeinstallprompt\n    window.addEventListener('beforeinstallprompt', (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      // Show buttons according to screen\n      if (window.innerWidth <= 768) {\n        document.getElementById('installBtnMobile').style.display = 'inline-flex';\n      } else {\n        document.getElementById('installBtnWindows').style.display = 'inline-flex';\n      }\n    });\n\n    // Register minimal service worker\n    if ('serviceWorker' in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => {\n          console.log('Service Worker: Installed');\n          self.skipWaiting();\n        });\n        self.addEventListener('activate', event => {\n          console.log('Service Worker: Activated');\n        });\n      `;\n      const blob = new Blob([swCode], { type: 'text/javascript' });\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker.register(swURL)\n        .then(reg => console.log('Service Worker registered with scope:', reg.scope))\n        .catch(err => console.error('Service Worker registration failed:', err));\n    }\n\n    // Show iOS modal or install buttons on load\n    window.addEventListener('load', () => {\n      if (isIos() && !isInStandaloneMode()) {\n        setTimeout(() => showInstallModal(), 1000);\n      } else if (deferredPrompt) {\n        if (window.innerWidth <= 768) {\n          document.getElementById('installBtnMobile').style.display = 'inline-flex';\n        } else {\n          document.getElementById('installBtnWindows').style.display = 'inline-flex';\n        }\n      }\n    });\n\n    // Show shared install modal\n    function showInstallModal() {\n      const modal = document.getElementById('installModal');\n      modal.style.display = 'flex';\n      modal.style.alignItems = 'center';\n      modal.style.justifyContent = 'center';\n      // For accessibility\n      modal.setAttribute('aria-hidden', 'false');\n      modal.focus();\n    }\n\n    // Hide shared install modal\n    function closeInstallModal() {\n      const modal = document.getElementById('installModal');\n      modal.style.display = 'none';\n      modal.setAttribute('aria-hidden', 'true');\n    }\n\n    // Install button behavior\n    function installApp() {\n      if (isIos() && !isInStandaloneMode()) {\n        showInstallModal();\n      } else if (deferredPrompt) {\n        deferredPrompt.prompt();\n        deferredPrompt.userChoice.then((choiceResult) => {\n          console.log('User response to install prompt:', choiceResult.outcome);\n          deferredPrompt = null;\n          document.getElementById('installBtnMobile').style.display = 'none';\n          document.getElementById('installBtnWindows').style.display = 'none';\n        });\n      }\n    }\n\n    // Attach install button event handlers after DOM loads\n    window.addEventListener('DOMContentLoaded', () => {\n      document.querySelectorAll('.button-fancy.install-btn').forEach(btn => {\n        btn.addEventListener('click', installApp);\n      });\n      // Attach modal close on button\n      document.getElementById('installModalCloseBtn').addEventListener('click', closeInstallModal);\n\n      // Close modal on Escape key\n      window.addEventListener('keydown', e => {\n        const modal = document.getElementById('installModal');\n        if (e.key === 'Escape' && modal.style.display === 'flex') {\n          closeInstallModal();\n        }\n      });\n\n      // Power button (refresh page) is #powerBtn\n      const powerBtn = document.getElementById('powerBtn');\n      if (powerBtn) {\n        powerBtn.addEventListener('click', () => {\n          location.reload();\n        });\n      }\n    });\n  </script>\n\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      background: url('https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png') no-repeat center center fixed;\n      background-size: cover;\n      font-family: 'Roboto', sans-serif;\n      color: #fff;\n    }\n\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.5);\n      padding: 30px;\n      margin: 50px auto;\n      width: 90%;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n    }\n\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    .button-fancy {\n      display: none; /* Initially hidden */\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 10px auto;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n    }\n\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n\n    .button-fancy:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n\n    .button-fancy:active {\n      transform: scale(0.95);\n    }\n\n    .button-fancy:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n\n    @keyframes ripple {\n      from {\n        transform: scale(0);\n        opacity: 1;\n      }\n      to {\n        transform: scale(1.5);\n        opacity: 0;\n      }\n    }\n\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      font-family: 'Roboto', sans-serif;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n    }\n\n    /* Modal styles */\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.8);\n      align-items: center;\n      justify-content: center;\n      z-index: 1000;\n      outline: none;\n    }\n\n    #installModal .modal-content {\n      background: #222;\n      padding: 20px;\n      border-radius: 10px;\n      text-align: center;\n      max-width: 90%;\n      color: #fff;\n    }\n\n    #installModal .modal-content h3 {\n      margin-top: 0;\n    }\n\n    #installModal .close-btn {\n      background: #0ff;\n      border: none;\n      padding: 10px 20px;\n      margin-top: 15px;\n      border-radius: 5px;\n      cursor: pointer;\n      color: #000;\n      font-size: 16px;\n    }\n\n    /* Media queries: only one install button visible per screen width */\n    @media only screen and (max-width: 768px) {\n      #installBtnMobile {\n        display: none; /* will be shown by JS */\n      }\n      #installBtnWindows {\n        display: none;\n      }\n      #powerBtn {\n        display: inline-flex;\n      }\n    }\n\n    @media only screen and (min-width: 769px) {\n      #installBtnMobile {\n        display: none;\n      }\n      #installBtnWindows {\n        display: none; /* shown by JS */\n      }\n      #powerBtn {\n        display: inline-flex;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <!-- Install Buttons -->\n    <button id=\"installBtnMobile\" class=\"button-fancy install-btn\" aria-label=\"Install EPIC Power Pack on mobile devices\" type=\"button\" style=\"display:none;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Install</span>\n    </button>\n\n    <button id=\"installBtnWindows\" class=\"button-fancy install-btn\" aria-label=\"Install EPIC Power Pack on desktop devices\" type=\"button\" style=\"display:none;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Install</span>\n    </button>\n\n    <!-- Power Button: refresh page -->\n    <button id=\"powerBtn\" class=\"button-fancy\" aria-label=\"Power button: Refresh Page\" type=\"button\" style=\"display: inline-flex;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Power</span>\n    </button>\n  </div>\n\n  <!-- Shared Modal for Install Instructions -->\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" tabindex=\"-1\" aria-hidden=\"true\">\n    <div class=\"modal-content\">\n      <h3>Install Instructions</h3>\n      <p>To install this app on your iOS device, tap the <strong>Share</strong> icon in Safari or Chrome, then select <strong>Add to Home Screen</strong>.</p>\n      <button id=\"installModalCloseBtn\" class=\"close-btn\" type=\"button\">OK</button>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        660,
        0
      ],
      "id": "a8e53b14-fe1d-41fb-a9dd-07d856794dde",
      "name": "Respond to Webhook11"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta name=\"msapplication-TileImage\" content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n\n  <!-- Apple-specific meta tags -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link rel=\"apple-touch-icon\" href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n\n  <!-- Google Fonts -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" rel=\"stylesheet\" />\n\n  <script>\n    // Redirect if running standalone PWA (browser or iOS)\n    if (\n      window.matchMedia('(display-mode: standalone)').matches ||\n      window.navigator.standalone === true\n    ) {\n      window.location.href = \"https://xl.epicpc.com/webhook/powerpack?standalone=yes\";\n    }\n  </script>\n\n  <script>\n    let deferredPrompt = null;\n\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return ('standalone' in window.navigator) && window.navigator.standalone;\n    }\n\n    // Add manifest dynamically\n    const manifestData = {\n      name: \"EPIC Power Pack\",\n      short_name: \"PowerPack\",\n      start_url: \".\",\n      display: \"standalone\",\n      background_color: \"#ffffff\",\n      theme_color: \"#000000\",\n      icons: [\n        {\n          src: \"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\",\n          sizes: \"512x512\",\n          type: \"image/png\"\n        }\n      ]\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], { type: \"application/json\" });\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement(\"link\");\n    manifestLink.rel = \"manifest\";\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      if (window.innerWidth <= 768) {\n        document.getElementById(\"installBtnMobile\").style.display = \"inline-flex\";\n      } else {\n        document.getElementById(\"installBtnWindows\").style.display = \"inline-flex\";\n      }\n    });\n\n    // Minimal Service Worker\n    if (\"serviceWorker\" in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => {\n          console.log('Service Worker: Installed');\n          self.skipWaiting();\n        });\n        self.addEventListener('activate', event => {\n          console.log('Service Worker: Activated');\n        });\n      `;\n      const blob = new Blob([swCode], { type: \"text/javascript\" });\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker.register(swURL)\n        .then(reg => console.log(\"Service Worker registered with scope:\", reg.scope))\n        .catch(err => console.error(\"Service Worker registration failed:\", err));\n    }\n\n    function showInstallModal() {\n      const modal = document.getElementById(\"installModal\");\n      modal.style.display = \"flex\";\n      modal.setAttribute(\"aria-hidden\", \"false\");\n      modal.focus();\n    }\n\n    function closeInstallModal() {\n      const modal = document.getElementById(\"installModal\");\n      modal.style.display = \"none\";\n      modal.setAttribute(\"aria-hidden\", \"true\");\n    }\n\n    function installApp() {\n      if (isIos() && !isInStandaloneMode()) {\n        showInstallModal();\n      } else if (deferredPrompt) {\n        deferredPrompt.prompt();\n        deferredPrompt.userChoice.then((choiceResult) => {\n          console.log(\"User response to install prompt:\", choiceResult.outcome);\n          deferredPrompt = null;\n          document.getElementById(\"installBtnMobile\").style.display = \"none\";\n          document.getElementById(\"installBtnWindows\").style.display = \"none\";\n        });\n      }\n    }\n\n    window.addEventListener(\"load\", () => {\n      if (isIos() && !isInStandaloneMode()) {\n        setTimeout(() => {\n          showInstallModal();\n        }, 1000);\n      } else if (deferredPrompt) {\n        if (window.innerWidth <= 768) {\n          document.getElementById(\"installBtnMobile\").style.display = \"inline-flex\";\n        } else {\n          document.getElementById(\"installBtnWindows\").style.display = \"inline-flex\";\n        }\n      }\n    });\n\n    window.addEventListener(\"DOMContentLoaded\", () => {\n      // Attach install buttons\n      document.querySelectorAll(\".button-fancy.install-btn\").forEach(btn => {\n        btn.addEventListener(\"click\", installApp);\n      });\n\n      // Attach modal close\n      document.getElementById(\"installModalCloseBtn\").addEventListener(\"click\", closeInstallModal);\n\n      // Attach \"Install Instructions\" button to open modal\n      document.getElementById(\"showInstallInstructionsBtn\").addEventListener(\"click\", showInstallModal);\n\n      // Modal - close on Escape\n      window.addEventListener(\"keydown\", e => {\n        const modal = document.getElementById(\"installModal\");\n        if (e.key === \"Escape\" && modal.style.display === \"flex\") {\n          closeInstallModal();\n        }\n      });\n\n      // Power button refresh\n      const powerBtn = document.getElementById(\"powerBtn\");\n      if (powerBtn) {\n        powerBtn.addEventListener(\"click\", () => {\n          location.reload();\n        });\n      }\n    });\n  </script>\n\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n    }\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.5);\n      padding: 30px;\n      margin: 50px auto;\n      width: 90%;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n    }\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    /* Base button style */\n    .button-fancy {\n      display: none; /* default hidden, shown by JS or forced */\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 12px 0; /* vertical spacing */\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      font-family: \"Roboto\", sans-serif;\n      user-select: none;\n    }\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n    .button-fancy:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n    .button-fancy:active {\n      transform: scale(0.95);\n    }\n    .button-fancy:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n    @keyframes ripple {\n      from { transform: scale(0); opacity: 1; }\n      to { transform: scale(1.5); opacity: 0; }\n    }\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n    }\n\n    /* === Pink/red style for install buttons === */\n    #installBtnMobile,\n    #installBtnWindows {\n      border-color: #ff2a68;\n      box-shadow: 0 0 10px #ff2a68;\n      background: #220013;\n      animation: pulsePink 2s infinite;\n    }\n    #installBtnMobile:hover,\n    #installBtnWindows:hover {\n      box-shadow: 0 0 30px #ff2a68;\n    }\n    #installBtnMobile .btn-text,\n    #installBtnWindows .btn-text {\n      color: #ff2a68;\n    }\n    @keyframes pulsePink {\n      0% {\n        box-shadow: 0 0 10px #ff2a68;\n      }\n      50% {\n        box-shadow: 0 0 20px #ff2a68;\n      }\n      100% {\n        box-shadow: 0 0 10px #ff2a68;\n      }\n    }\n\n    /* Neon pink style for Install Instructions button */\n    #showInstallInstructionsBtn {\n      display: inline-flex !important; /* always visible */\n      flex-direction: row;\n      width: 220px;\n      height: 50px;\n      border-radius: 12px;\n      animation: pulsePink 2s infinite;\n      background: #220013;\n      border: 2px solid #ff2a68;\n      box-shadow: 0 0 10px #ff2a68;\n      cursor: pointer;\n      user-select: none;\n      margin-top: 12px;\n      font-family: \"Roboto\", sans-serif;\n      transition: box-shadow 0.3s ease;\n    }\n    #showInstallInstructionsBtn:hover,\n    #showInstallInstructionsBtn:focus {\n      box-shadow: 0 0 30px #ff2a68;\n      outline: none;\n    }\n    #showInstallInstructionsBtn .btn-text {\n      color: #ff2a68;\n      font-size: 16px;\n      margin-top: 0;\n    }\n    #showInstallInstructionsBtn .power-icon {\n      width: 28px;\n      height: 28px;\n      margin-right: 12px;\n      stroke: #ff2a68;\n    }\n\n    /* Modal styles */\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0; left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0,0,0,0.85);\n      align-items: center;\n      justify-content: center;\n      z-index: 1000;\n      outline: none;\n      padding: 20px;\n      box-sizing: border-box;\n    }\n    #installModal .modal-content {\n      background: #222;\n      padding: 25px 30px;\n      border-radius: 12px;\n      width: 100%;\n      max-width: 450px;\n      max-height: 70vh; /* limit height */\n      overflow-y: auto; /* scroll if content is too tall */\n      color: #fff;\n      font-family: \"Roboto\", sans-serif;\n      box-shadow: 0 0 25px #ff2a68aa;\n      text-align: left;\n    }\n    #installModal h3 {\n      margin-top: 0;\n      margin-bottom: 15px;\n      font-size: 1.6em;\n      color: #ff2a68;\n      text-align: center;\n    }\n    #installModal p {\n      line-height: 1.5em;\n      font-size: 1em;\n      margin-bottom: 25px;\n      font-weight: 500;\n      white-space: normal;\n    }\n    /* Improve formatting: bullet style with margins */\n    #installModal p br + strong {\n      margin-top: 12px;\n      display: block;\n    }\n    #installModal ul {\n      list-style: none;\n      padding-left: 0;\n      margin: 0 0 25px 0;\n    }\n    #installModal ul li {\n      margin-bottom: 1em;\n      line-height: 1.4;\n      font-weight: 500;\n    }\n    #installModal ul li strong {\n      font-weight: 700;\n    }\n\n    #installModal .close-btn {\n      display: block;\n      margin: 0 auto;\n      padding: 12px 28px;\n      background: #ff2a68;\n      color: #fff;\n      border: none;\n      border-radius: 8px;\n      font-size: 16px;\n      cursor: pointer;\n      font-weight: 600;\n      user-select: none;\n      box-shadow: 0 0 12px #ff2a68;\n      transition: background-color 0.3s ease;\n    }\n    #installModal .close-btn:hover,\n    #installModal .close-btn:focus {\n      background: #e12050;\n      outline: none;\n    }\n\n    /* Media Queries for layout and sizes */\n    @media (max-width: 768px) {\n      .overlay {\n        max-width: 90%;\n        padding: 20px;\n      }\n\n      .button-fancy {\n        width: 100px;\n        height: 100px;\n        margin: 14px 0;\n      }\n      .power-icon {\n        width: 50px;\n        height: 50px;\n      }\n      .btn-text {\n        font-size: 14px;\n        margin-top: 6px;\n      }\n      /* Override for Install Instructions button on small */\n      #showInstallInstructionsBtn {\n        width: 100%;\n        height: 50px;\n        border-radius: 10px;\n      }\n    }\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <!-- INSTALL BUTTON (pink/red, above Power button) -->\n    <button id=\"installBtnMobile\" class=\"button-fancy install-btn\" aria-label=\"Install EPIC Power Pack on mobile devices\" type=\"button\" style=\"display:none;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#ff2a68\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#ff2a68\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Install</span>\n    </button>\n\n    <button id=\"installBtnWindows\" class=\"button-fancy install-btn\" aria-label=\"Install EPIC Power Pack on desktop devices\" type=\"button\" style=\"display:none;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#ff2a68\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#ff2a68\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Install</span>\n    </button>\n\n    <!-- POWER BUTTON (below Install) -->\n    <button id=\"powerBtn\" class=\"button-fancy\" aria-label=\"Power button: Refresh Page\" type=\"button\" style=\"display:inline-flex;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Power</span>\n    </button>\n\n    <!-- INSTALL INSTRUCTIONS BUTTON (changed neon pink) -->\n    <button id=\"showInstallInstructionsBtn\" class=\"button-fancy\" aria-label=\"Show Install Instructions\" type=\"button\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\" style=\"stroke-width: 3;\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#ff2a68\" fill=\"none\" />\n        <line x1=\"32\" y1=\"14\" x2=\"32\" y2=\"34\" stroke=\"#ff2a68\" />\n        <circle cx=\"32\" cy=\"44\" r=\"4\" fill=\"#ff2a68\" />\n      </svg>\n      <span class=\"btn-text\">Install Instructions</span>\n    </button>\n  </div>\n\n  <!-- INSTALL INSTRUCTIONS MODAL -->\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" tabindex=\"-1\" aria-hidden=\"true\">\n    <div class=\"modal-content\">\n      <h3>Install Instructions</h3>\n      <p>\n        <strong>Android Chrome / Edge</strong><br>\n        🟩 (Icon: smartphone with a download arrow or Android phone)<br><br>\n        <strong>Android Chrome/Edge:</strong><br>\n        Tap the browser menu and select <strong>Add to Home screen</strong>.<br><br>\n        <strong>iOS Safari</strong><br>\n        📱 (Icon: iPhone outline or Safari share icon)<br><br>\n        <strong>iOS Safari:</strong><br>\n        Tap the <strong>Share</strong> icon (the square with an arrow) then tap <strong>Add to Home Screen</strong>.<br><br>\n        <strong>Desktop Browsers</strong><br>\n        💻 (Icon: desktop monitor)<br><br>\n        <strong>Desktop Browsers:</strong><br>\n        Use the browser menu and select <strong>Install App</strong> or <strong>Add to Desktop</strong> if available.\n      </p>\n      <button id=\"installModalCloseBtn\" class=\"close-btn\" type=\"button\">OK</button>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        460,
        0
      ],
      "id": "0afb8fdb-3b5e-4230-850b-7b211b5e607c",
      "name": "Respond to Webhook1"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>EPIC Power Pack</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n  <meta name=\"theme-color\" content=\"#000000\" />\n\n  <!-- Windows compatibility meta tags -->\n  <meta name=\"msapplication-TileColor\" content=\"#000000\" />\n  <meta name=\"msapplication-TileImage\" content=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n\n  <!-- Apple-specific meta tags -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\n  <meta name=\"apple-mobile-web-app-title\" content=\"EPIC Power Pack\" />\n  <link rel=\"apple-touch-icon\" href=\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\" />\n\n  <!-- Google Fonts -->\n  <link href=\"https://fonts.googleapis.com/css2?family=Roboto&display=swap\" rel=\"stylesheet\" />\n\n  <script>\n    // Redirect if running standalone PWA (browser or iOS)\n    if (\n      window.matchMedia('(display-mode: standalone)').matches ||\n      window.navigator.standalone === true\n    ) {\n      window.location.href = \"https://xl.epicpc.com/webhook/powerpack?standalone=yes\";\n    }\n  </script>\n\n  <script>\n    let deferredPrompt = null;\n\n    function isIos() {\n      const ua = window.navigator.userAgent.toLowerCase();\n      return /iphone|ipad|ipod/.test(ua);\n    }\n\n    function isInStandaloneMode() {\n      return ('standalone' in window.navigator) && window.navigator.standalone;\n    }\n\n    // Add manifest dynamically\n    const manifestData = {\n      name: \"EPIC Power Pack\",\n      short_name: \"PowerPack\",\n      start_url: \".\",\n      display: \"standalone\",\n      background_color: \"#ffffff\",\n      theme_color: \"#000000\",\n      icons: [\n        {\n          src: \"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\",\n          sizes: \"512x512\",\n          type: \"image/png\"\n        }\n      ]\n    };\n    const manifestBlob = new Blob([JSON.stringify(manifestData)], { type: \"application/json\" });\n    const manifestURL = URL.createObjectURL(manifestBlob);\n    const manifestLink = document.createElement(\"link\");\n    manifestLink.rel = \"manifest\";\n    manifestLink.href = manifestURL;\n    document.head.appendChild(manifestLink);\n\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      e.preventDefault();\n      deferredPrompt = e;\n      if (window.innerWidth <= 768) {\n        document.getElementById(\"installBtnMobile\").style.display = \"inline-flex\";\n      } else {\n        document.getElementById(\"installBtnWindows\").style.display = \"inline-flex\";\n      }\n    });\n\n    // Minimal Service Worker\n    if (\"serviceWorker\" in navigator) {\n      const swCode = `\n        self.addEventListener('install', event => {\n          console.log('Service Worker: Installed');\n          self.skipWaiting();\n        });\n        self.addEventListener('activate', event => {\n          console.log('Service Worker: Activated');\n        });\n      `;\n      const blob = new Blob([swCode], { type: \"text/javascript\" });\n      const swURL = URL.createObjectURL(blob);\n      navigator.serviceWorker.register(swURL)\n        .then(reg => console.log(\"Service Worker registered with scope:\", reg.scope))\n        .catch(err => console.error(\"Service Worker registration failed:\", err));\n    }\n\n    function showInstallModal() {\n      const modal = document.getElementById(\"installModal\");\n      modal.style.display = \"flex\";\n      modal.setAttribute(\"aria-hidden\", \"false\");\n      modal.focus();\n    }\n\n    function closeInstallModal() {\n      const modal = document.getElementById(\"installModal\");\n      modal.style.display = \"none\";\n      modal.setAttribute(\"aria-hidden\", \"true\");\n    }\n\n    function installApp() {\n      if (isIos() && !isInStandaloneMode()) {\n        showInstallModal();\n      } else if (deferredPrompt) {\n        deferredPrompt.prompt();\n        deferredPrompt.userChoice.then((choiceResult) => {\n          console.log(\"User response to install prompt:\", choiceResult.outcome);\n          deferredPrompt = null;\n          document.getElementById(\"installBtnMobile\").style.display = \"none\";\n          document.getElementById(\"installBtnWindows\").style.display = \"none\";\n        });\n      }\n    }\n\n    window.addEventListener(\"load\", () => {\n      if (isIos() && !isInStandaloneMode()) {\n        setTimeout(() => {\n          showInstallModal();\n        }, 1000);\n      } else if (deferredPrompt) {\n        if (window.innerWidth <= 768) {\n          document.getElementById(\"installBtnMobile\").style.display = \"inline-flex\";\n        } else {\n          document.getElementById(\"installBtnWindows\").style.display = \"inline-flex\";\n        }\n      }\n    });\n\n    window.addEventListener(\"DOMContentLoaded\", () => {\n      // Attach install buttons\n      document.querySelectorAll(\".button-fancy.install-btn\").forEach(btn => {\n        btn.addEventListener(\"click\", installApp);\n      });\n\n      // Attach modal close\n      document.getElementById(\"installModalCloseBtn\").addEventListener(\"click\", closeInstallModal);\n\n      // Attach \"Install Instructions\" button to open modal\n      document.getElementById(\"showInstallInstructionsBtn\").addEventListener(\"click\", showInstallModal);\n\n      // Modal - close on Escape\n      window.addEventListener(\"keydown\", e => {\n        const modal = document.getElementById(\"installModal\");\n        if (e.key === \"Escape\" && modal.style.display === \"flex\") {\n          closeInstallModal();\n        }\n      });\n\n      // Power button refresh\n      const powerBtn = document.getElementById(\"powerBtn\");\n      if (powerBtn) {\n        powerBtn.addEventListener(\"click\", () => {\n          location.reload();\n        });\n      }\n    });\n  </script>\n\n  <style>\n    body {\n      margin: 0;\n      padding: 0;\n      background: url(\"https://file.cybertech.app/CyberTech/PWA/NIT/icon%3Dpwa-cyberpunk.png\")\n        no-repeat center center fixed;\n      background-size: cover;\n      font-family: \"Roboto\", sans-serif;\n      color: #fff;\n    }\n    .overlay {\n      background-color: rgba(0, 0, 0, 0.5);\n      padding: 30px;\n      margin: 50px auto;\n      width: 90%;\n      max-width: 600px;\n      border-radius: 10px;\n      text-align: center;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n    }\n    h1 {\n      margin-bottom: 0.3em;\n      font-size: 2em;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n    h2 {\n      margin-top: 0;\n      margin-bottom: 1em;\n      font-size: 1.2em;\n      font-weight: normal;\n      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);\n    }\n\n    /* Base button style */\n    .button-fancy {\n      display: none; /* default hidden, shown by JS or forced */\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      margin: 12px 0; /* vertical spacing */\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: #111;\n      border: 2px solid #0ff;\n      cursor: pointer;\n      box-shadow: 0 0 10px #0ff;\n      transition: transform 0.2s ease, box-shadow 0.2s ease;\n      position: relative;\n      overflow: hidden;\n      animation: pulse 2s infinite;\n      font-family: \"Roboto\", sans-serif;\n      user-select: none;\n    }\n    @keyframes pulse {\n      0% {\n        box-shadow: 0 0 10px #0ff;\n      }\n      50% {\n        box-shadow: 0 0 20px #0ff;\n      }\n      100% {\n        box-shadow: 0 0 10px #0ff;\n      }\n    }\n    .button-fancy:hover {\n      box-shadow: 0 0 30px #0ff;\n    }\n    .button-fancy:active {\n      transform: scale(0.95);\n    }\n    .button-fancy:active::after {\n      content: \"\";\n      position: absolute;\n      width: 120px;\n      height: 120px;\n      border-radius: 50%;\n      background: rgba(0, 255, 255, 0.2);\n      animation: ripple 0.6s ease-out;\n      top: 0;\n      left: 0;\n    }\n    @keyframes ripple {\n      from { transform: scale(0); opacity: 1; }\n      to { transform: scale(1.5); opacity: 0; }\n    }\n    .power-icon {\n      width: 60px;\n      height: 60px;\n    }\n    .btn-text {\n      font-size: 16px;\n      color: #0ff;\n      margin-top: 5px;\n      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);\n    }\n\n    /* === Pink/red style for install buttons === */\n    #installBtnMobile,\n    #installBtnWindows {\n      border-color: #ff2a68;\n      box-shadow: 0 0 10px #ff2a68;\n      background: #220013;\n      animation: pulsePink 2s infinite;\n    }\n    #installBtnMobile:hover,\n    #installBtnWindows:hover {\n      box-shadow: 0 0 30px #ff2a68;\n    }\n    #installBtnMobile .btn-text,\n    #installBtnWindows .btn-text {\n      color: #ff2a68;\n    }\n    @keyframes pulsePink {\n      0% {\n        box-shadow: 0 0 10px #ff2a68;\n      }\n      50% {\n        box-shadow: 0 0 20px #ff2a68;\n      }\n      100% {\n        box-shadow: 0 0 10px #ff2a68;\n      }\n    }\n\n    /* Modal styles */\n    #installModal {\n      display: none;\n      position: fixed;\n      top: 0; left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0,0,0,0.85);\n      align-items: center;\n      justify-content: center;\n      z-index: 1000;\n      outline: none;\n      padding: 20px;\n      box-sizing: border-box;\n    }\n    #installModal .modal-content {\n      background: #222;\n      padding: 25px 30px;\n      border-radius: 12px;\n      max-width: 450px;\n      width: 100%;\n      text-align: left;\n      color: #fff;\n      font-family: \"Roboto\", sans-serif;\n      box-shadow: 0 0 25px #ff2a68aa;\n    }\n    #installModal h3 {\n      margin-top: 0;\n      margin-bottom: 15px;\n      font-size: 1.6em;\n      color: #ff2a68;\n      text-align: center;\n    }\n    #installModal p {\n      white-space: pre-line;\n      line-height: 1.4em;\n      font-size: 1em;\n      margin-bottom: 25px;\n      font-weight: 500;\n    }\n    #installModal .close-btn {\n      display: block;\n      margin: 0 auto;\n      padding: 12px 28px;\n      background: #ff2a68;\n      color: #fff;\n      border: none;\n      border-radius: 8px;\n      font-size: 16px;\n      cursor: pointer;\n      font-weight: 600;\n      user-select: none;\n      box-shadow: 0 0 12px #ff2a68;\n      transition: background-color 0.3s ease;\n    }\n    #installModal .close-btn:hover,\n    #installModal .close-btn:focus {\n      background: #e12050;\n      outline: none;\n    }\n\n    /* Media Queries for layout and sizes */\n    @media (max-width: 768px) {\n      .overlay {\n        max-width: 90%;\n        padding: 20px;\n      }\n\n      .button-fancy {\n        width: 100px;\n        height: 100px;\n        margin: 14px 0;\n      }\n      .power-icon {\n        width: 50px;\n        height: 50px;\n      }\n      .btn-text {\n        font-size: 14px;\n        margin-top: 6px;\n      }\n      #installModal .modal-content {\n        max-width: 90vw;\n      }\n    }\n\n  </style>\n</head>\n<body>\n  <div class=\"overlay\" role=\"main\">\n    <h1>EPIC Power Pack</h1>\n    <h2>Turbocharge your Superpower 🚀</h2>\n\n    <!-- INSTALL BUTTON (pink/red, above Power button) -->\n    <button id=\"installBtnMobile\" class=\"button-fancy install-btn\" aria-label=\"Install EPIC Power Pack on mobile devices\" type=\"button\" style=\"display:none;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#ff2a68\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#ff2a68\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Install</span>\n    </button>\n\n    <button id=\"installBtnWindows\" class=\"button-fancy install-btn\" aria-label=\"Install EPIC Power Pack on desktop devices\" type=\"button\" style=\"display:none;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#ff2a68\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#ff2a68\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Install</span>\n    </button>\n\n    <!-- POWER BUTTON (below Install) -->\n    <button id=\"powerBtn\" class=\"button-fancy\" aria-label=\"Power button: Refresh Page\" type=\"button\" style=\"display:inline-flex;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" stroke-width=\"4\" fill=\"none\" />\n        <line x1=\"32\" y1=\"10\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" stroke-width=\"4\" />\n      </svg>\n      <span class=\"btn-text\">Power</span>\n    </button>\n\n    <!-- INSTALL INSTRUCTIONS BUTTON (below Power) -->\n    <button id=\"showInstallInstructionsBtn\" class=\"button-fancy\" aria-label=\"Show Install Instructions\" type=\"button\" style=\"display:inline-flex; flex-direction: row; width: 220px; height: 50px; border-radius: 12px; animation:none; box-shadow: 0 0 10px #0ff;\">\n      <svg class=\"power-icon\" viewBox=\"0 0 64 64\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" focusable=\"false\" style=\"stroke-width: 3; width: 28px; height: 28px; margin-right: 12px;\">\n        <circle cx=\"32\" cy=\"32\" r=\"30\" stroke=\"#0ff\" fill=\"none\" />\n        <line x1=\"32\" y1=\"14\" x2=\"32\" y2=\"34\" stroke=\"#0ff\" />\n        <circle cx=\"32\" cy=\"44\" r=\"4\" fill=\"#0ff\" />\n      </svg>\n      <span class=\"btn-text\" style=\"font-size: 16px; color: #0ff; margin-top: 0;\">Install Instructions</span>\n    </button>\n  </div>\n\n  <!-- INSTALL INSTRUCTIONS MODAL -->\n  <div id=\"installModal\" role=\"dialog\" aria-modal=\"true\" tabindex=\"-1\" aria-hidden=\"true\">\n    <div class=\"modal-content\">\n      <h3>Install Instructions</h3>\n      <p>\n        Android Chrome / Edge<br>\n        🟩 (Icon: smartphone with a download arrow or Android phone)<br><br>\n\n        Android Chrome/Edge:<br>\n        Tap the browser menu and select <strong>Add to Home screen</strong>.<br><br>\n\n        iOS Safari<br>\n        📱 (Icon: iPhone outline or Safari share icon)<br><br>\n\n        iOS Safari:<br>\n        Tap the <strong>Share</strong> icon (the square with an arrow) then tap <strong>Add to Home Screen</strong>.<br><br>\n\n        Desktop Browsers<br>\n        💻 (Icon: desktop monitor)<br><br>\n\n        Desktop Browsers:<br>\n        Use the browser menu and select <strong>Install App</strong> or <strong>Add to Desktop</strong> if available.\n      </p>\n      <button id=\"installModalCloseBtn\" class=\"close-btn\" type=\"button\">OK</button>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        460,
        -140
      ],
      "id": "640da36d-1800-4f8a-b96a-76d4fe5d817f",
      "name": "Respond to Webhook12"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Embedded Iframe with Zoom Disabled</title>\n  <!-- Prevent zooming via meta tag -->\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\">\n  <meta name=\"theme-color\" content=\"#000000\">\n  <!-- Apple-specific meta tags -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\">\n  \n  <style>\n    /* The container fills the viewport and clips any overflow */\n    .iframe-container {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      overflow: hidden;\n    }\n    /* The iframe's intrinsic size is half of the container,\n       then scaled up 2× to fill the space */\n    .iframe-container iframe {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: calc(100% / 1);\n      height: calc(100% / 1);\n      transform: scale(1);\n      transform-origin: top left;\n      border: none;\n    }\n  </style>\n  \n  <script>\n    // Prevent double-tap zoom by intercepting touchend events.\n    let lastTouchEnd = 0;\n    document.addEventListener('touchend', function(event) {\n      const now = Date.now();\n      if (now - lastTouchEnd <= 300) {\n        event.preventDefault();\n      }\n      lastTouchEnd = now;\n    }, false);\n    \n    // Prevent pinch zoom by intercepting touchmove events.\n    document.addEventListener('touchmove', function(event) {\n      if (event.scale && event.scale !== 1) {\n        event.preventDefault();\n      }\n    }, { passive: false });\n  </script>\n</head>\n<body>\n  <div class=\"iframe-container\">\n    <iframe src=\"https://n8n.cybertech.app/webhook/e225c70c-13d2-4902-bef9-977e3207b715\"\n            allow=\"accelerometer; ambient-light-sensor; autoplay; battery; camera; clipboard-read; clipboard-write; encrypted-media; fullscreen; geolocation; gyroscope; magnetometer; microphone; midi; payment; picture-in-picture; usb; xr-spatial-tracking;\">\n    </iframe>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        380,
        -360
      ],
      "id": "f84d6575-0965-42db-9b42-00794b8dcad7",
      "name": "Respond to Webhook13"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "=<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <title>Embedded Iframe with Zoom Disabled</title>\n  <!-- Prevent zooming via meta tag -->\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\">\n  <meta name=\"theme-color\" content=\"#000000\">\n  <!-- Apple-specific meta tags -->\n  <meta name=\"apple-mobile-web-app-capable\" content=\"yes\">\n  <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\">\n  \n  <style>\n    /* The container fills the viewport and clips any overflow */\n    .iframe-container {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      overflow: hidden;\n    }\n    /* The iframe dimensions */\n    .iframe-container iframe {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      border: none;\n      transform-origin: top left;\n    }\n  </style>\n  \n  <script src=\"https://cdn.jsdelivr.net/npm/keycloak-js@21.1.0/dist/keycloak.min.js\"></script>\n  \n  <script>\n    // Prevent double-tap zoom by intercepting touchend events.\n    let lastTouchEnd = 0;\n    document.addEventListener('touchend', function(event) {\n      const now = Date.now();\n      if (now - lastTouchEnd <= 300) {\n        event.preventDefault();\n      }\n      lastTouchEnd = now;\n    }, false);\n    \n    // Prevent pinch zoom by intercepting touchmove events.\n    document.addEventListener('touchmove', function(event) {\n      if (event.scale && event.scale !== 1) {\n        event.preventDefault();\n      }\n    }, { passive: false });\n\n    // Keycloak config\n    const KEYCLOAK_CONFIG = {\n      url: 'https://keycloak.cybertech.app',\n      realm: 'EPIC',\n      clientId: 'powerpack'\n    };\n\n    const ENTITY = 'e225c70c-13d2-4902-bef9-977e3207b715';\n\n    document.addEventListener('DOMContentLoaded', () => {\n      // Initialize Keycloak instance\n      const keycloak = new Keycloak(KEYCLOAK_CONFIG);\n\n      keycloak.init({ onLoad: 'login-required' }).then(authenticated => {\n        if (!authenticated) {\n          console.error('Failed to authenticate');\n          return;\n        }\n\n        const username = keycloak.tokenParsed?.preferred_username || 'unknown';\n\n        // Construct base URL (you mentioned baseurl + \"?standalone=yes\" + entity + user)\n        // Base URL from original iframe\n        const baseUrl = 'https://n8n.cybertech.app/webhook/' + ENTITY;\n\n        const url = new URL(baseUrl);\n        url.searchParams.set('standalone', 'yes');\n        url.searchParams.set('entity', ENTITY);\n        url.searchParams.set('user', username);\n\n        const iframeSrc = url.toString();\n\n        // Set iframe src dynamically\n        const iframe = document.querySelector('.iframe-container iframe');\n        iframe.src = iframeSrc;\n\n        console.log('Authenticated URL:', iframeSrc);\n      }).catch(err => {\n        console.error('Keycloak init error:', err);\n      });\n    });\n  </script>\n</head>\n<body>\n  <div class=\"iframe-container\">\n    <!-- Initially empty src, set after Keycloak login -->\n    <iframe allow=\"accelerometer; ambient-light-sensor; autoplay; battery; camera; clipboard-read; clipboard-write; encrypted-media; fullscreen; geolocation; gyroscope; magnetometer; microphone; midi; payment; picture-in-picture; usb; xr-spatial-tracking;\">\n    </iframe>\n  </div>\n</body>\n</html>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        520,
        -360
      ],
      "id": "ac9567cd-6129-46fe-a2eb-27b273b179f6",
      "name": "Respond to Webhook14"
    },
    {
      "parameters": {
        "content": "# PWA Download/Routing",
        "height": 660,
        "width": 1360,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -320,
        -420
      ],
      "id": "f3da5133-4f62-42f7-aef3-c2864f4317a7",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "# PWA Main Page",
        "height": 300,
        "width": 1360,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -320,
        320
      ],
      "id": "2875895f-9fa1-45b3-875c-31ba950c4bf2",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "# Other Website",
        "height": 300,
        "width": 1500
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1180,
        320
      ],
      "id": "a56385ef-439c-4c8e-9a95-0166271700aa",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "path": "cd8a8176-16de-482c-ac61-8150ba72e33d",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        1400,
        440
      ],
      "id": "19a18649-d8b0-4e89-a7db-1245a0f668a0",
      "name": "Webhook2",
      "webhookId": "cd8a8176-16de-482c-ac61-8150ba72e33d"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "46551f79-7e2c-4222-8c14-8eb335257994",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        3020,
        900
      ],
      "id": "4c3af5a9-fd1f-4aee-a9bd-deeb9bc27215",
      "name": "Webhook3",
      "webhookId": "46551f79-7e2c-4222-8c14-8eb335257994"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "29fcc38d-2ae6-45f4-bce2-b6097cf84c55",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        3040,
        1600
      ],
      "id": "307940d3-1570-4734-8638-b6b428c723df",
      "name": "Webhook4",
      "webhookId": "29fcc38d-2ae6-45f4-bce2-b6097cf84c55"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        180,
        660
      ],
      "id": "66709b0e-ad91-4a73-9bdd-77e9b1d2ed5a",
      "name": "Code"
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "getAll",
        "projectId": "pg461bptu3aimnk",
        "table": "mx0a7l9g3403nip",
        "returnAll": true,
        "options": {}
      },
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        3260,
        900
      ],
      "id": "00d8b97c-9692-4bcc-acb2-e51f848a59be",
      "name": "Get many rows",
      "credentials": {
        "nocoDbApiToken": {
          "id": "tJrRYhH9PABi968X",
          "name": "NCDB http"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b9a8eab2-6027-40b8-b7c6-8d34dc7e1d4b",
              "name": "imageurl",
              "value": "=https://ncdb.epicpc.com/{{ $json.DevicePicture[0].signedPath }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3480,
        900
      ],
      "id": "35850344-4d63-44df-8579-aaeecda50469",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        3700,
        900
      ],
      "id": "ea3e58fb-ea04-4a33-bfcd-9949e942f450",
      "name": "Respond to Webhook15"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture with QR Scan</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: calc(100% - 120px);\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n    vertical-align: middle;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  #mrn-controls {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 12px;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    flex: 1;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  button.small {\n    padding: 14px 8px;\n    max-width: 112px;\n    flex: none;\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video, #qr-video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n  #qr-scanner-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.9);\n    display: none;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    z-index: 10000;\n  }\n  #qr-video {\n    border-radius: 14px;\n    width: 90vw;\n    max-width: 400px;\n    height: auto;\n  }\n  #qr-instruction {\n    color: white;\n    margin-top: 12px;\n    font-size: 1.1rem;\n  }\n  #qr-cancel-btn {\n    margin-top: 20px;\n    padding: 12px 24px;\n    border-radius: 12px;\n    border: none;\n    background: #ff385c;\n    color: white;\n    font-size: 1.1rem;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    transition: background 0.3s;\n  }\n  #qr-cancel-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <div id=\"mrn-controls\">\n        <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n        <button id=\"start-qr-btn\" class=\"small\" aria-label=\"Start QR code scanner\">Scan QR</button>\n      </div>\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null; // For photo capture camera\n  let qrStream = null;     // For QR scanner camera\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n\n  // ---- Helpers ----\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // ----- Load Devices -----\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      const json = await res.json();\n      if(!Array.isArray(json) && !Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      // If json is array, use it, else use json.devices\n      currentDevices = Array.isArray(json) ? json : json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // ----- Render device cards -----\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  // ----- Device confirm button -----\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  // ----- Camera (Photo) functions -----\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  // ----- Load Devices Button -----\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // ----- Modal Close -----\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // ----- QR Scanner -----\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n\n  // QR decode - use minimalistic js QR code reader - jsQR https://github.com/cozmo/jsQR\n  // We'll inline jsQR code minified as a single function here for demo - I included a minified version below.\n  // For simplicity, we'll load it dynamically from CDN, safer for this snippet:\n\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically from CDN for QR decode.\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        180,
        820
      ],
      "id": "e281b274-26cf-4f9f-a1e1-4af2d0909032",
      "name": "Code2"
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "Thank you",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        3240,
        1600
      ],
      "id": "b79defe4-bc77-4895-ad46-4ae5a4864328",
      "name": "Respond to Webhook16"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "529e525f-c819-4520-a8c6-ee412032cd57",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        3040,
        480
      ],
      "id": "8de413c0-d890-4a57-957a-ba549ff41b71",
      "name": "Webhook5",
      "webhookId": "529e525f-c819-4520-a8c6-ee412032cd57"
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        3920,
        480
      ],
      "id": "14c9f694-1dda-4ae9-b6ae-ca785ba688e2",
      "name": "Respond to Webhook17"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n    }\n    video, #qr-video {\n      width: 100%;\n      border-radius: 16px;\n      background: black;\n    }\n    #capture-btns {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #capture-btns button {\n      flex-grow: 1;\n      margin: 0 6px;\n    }\n    #captured-photo {\n      width: 100%;\n      margin-top: 12px;\n      border-radius: 16px;\n      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n    }\n    .hidden {\n      display: none;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 24px auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for returned HTML */\n    #modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    }\n    #modal-content {\n      background: white;\n      border-radius: 14px;\n      max-width: 95vw;\n      max-height: 90vh;\n      overflow: auto;\n      padding: 16px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      animation: fadeInScale 0.35s ease forwards;\n    }\n    @keyframes fadeInScale {\n      0% {opacity: 0; transform: scale(0.85);}\n      100% {opacity: 1; transform: scale(1);}\n    }\n    #modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 10000;\n      transition: background 0.3s;\n    }\n    #modal-close-btn:hover {\n      background: #d72950;\n    }\n    /* QR Scanner Overlay */\n    #qr-scanner-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.9);\n      display: none;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      z-index: 10000;\n    }\n    #qr-video {\n      border-radius: 14px;\n      width: 90vw;\n      max-width: 400px;\n      height: auto;\n    }\n    #qr-instruction {\n      color: white;\n      margin-top: 12px;\n      font-size: 1.1rem;\n    }\n    #qr-cancel-btn {\n      margin-top: 20px;\n      padding: 12px 24px;\n      border-radius: 12px;\n      border: none;\n      background: #ff385c;\n      color: white;\n      font-size: 1.1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n    }\n    #qr-cancel-btn:hover {\n      background: #d72950;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n        <div id=\"capture-btns\">\n          <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n          <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n        </div>\n\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n          <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n          <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n        </div>\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null; // For photo capture camera\n  let qrStream = null;     // For QR scanner camera\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n\n  // --- Helper Functions ---\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // ----- Fetch patient info, show MRN + name -----\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Patient info fetch failed: \\${res.status}\\`);\n      const json = await res.json();\n\n      // The webhook should return patient's name info. We'll assume json.patientName or json.name\n      let patientName = '';\n      if(typeof json === 'object' && json !== null){\n        patientName = json.patientName || json.name || '';\n      }\n\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  // ----- Load Devices -----\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let json = await res.json();\n\n      // Your expected response is an array directly\n      if(!Array.isArray(json)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      currentDevices = json;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // ----- Render device cards, clicking immediately opens camera for that device -----\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n\n      // Keep focus style and accessible description\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n\n      // On click or keyboard Enter/space, start photo capture for that device\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n        startCamera();\n      };\n\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  // ----- Camera photo capture functions -----\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n  });\n  captureBtn.addEventListener('click', takePhoto);\n\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  // Load Devices button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value (or on input change)\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Modal close event\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // ----- QR Scanner setup and functions -----\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.dispatchEvent(new Event('input')); // trigger input listeners to enable button\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically for QR scan decoding (CDN)\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n  // --- On Page Load: try to load patient info + devices if MRN in URL ---\n\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        180,
        1000
      ],
      "id": "8d12ba55-d139-4aad-9919-dba23a2968af",
      "name": "Code3"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture with Saved Data</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    #show-submissions-btn {\n      background: linear-gradient(135deg, #ffa500, #cc8400);\n      width: auto;\n      padding: 10px 16px;\n      font-size: 1rem;\n      border-radius: 12px;\n      box-shadow: 0 4px 10px rgba(255,165,0, 0.5);\n      transition: background 0.3s, transform 0.15s;\n      margin-left: auto;\n    }\n    #show-submissions-btn:hover {\n      background: linear-gradient(135deg, #cc8400, #aa6a00);\n      transform: translateY(-2px);\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n    }\n    video, #qr-video {\n      width: 100%;\n      border-radius: 16px;\n      background: black;\n    }\n    #capture-btns {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #capture-btns button {\n      flex-grow: 1;\n      margin: 0 6px;\n    }\n    #captured-photo {\n      width: 100%;\n      margin-top: 12px;\n      border-radius: 16px;\n      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n    }\n    .hidden {\n      display: none;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 24px auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for returned HTML */\n    #modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    }\n    #modal-content {\n      background: white;\n      border-radius: 14px;\n      max-width: 95vw;\n      max-height: 90vh;\n      overflow: auto;\n      padding: 16px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      animation: fadeInScale 0.35s ease forwards;\n    }\n    @keyframes fadeInScale {\n      0% {opacity: 0; transform: scale(0.85);}\n      100% {opacity: 1; transform: scale(1);}\n    }\n    #modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 10000;\n      transition: background 0.3s;\n    }\n    #modal-close-btn:hover {\n      background: #d72950;\n    }\n    /* QR Scanner Overlay */\n    #qr-scanner-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.9);\n      display: none;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      z-index: 10000;\n    }\n    #qr-video {\n      border-radius: 14px;\n      width: 90vw;\n      max-width: 400px;\n      height: auto;\n    }\n    #qr-instruction {\n      color: white;\n      margin-top: 12px;\n      font-size: 1.1rem;\n    }\n    #qr-cancel-btn {\n      margin-top: 20px;\n      padding: 12px 24px;\n      border-radius: 12px;\n      border: none;\n      background: #ff385c;\n      color: white;\n      font-size: 1.1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n    }\n    #qr-cancel-btn:hover {\n      background: #d72950;\n    }\n    /* Saved Submissions Panel */\n    #saved-submissions-panel {\n      background: #fff8e1;\n      border: 2px solid #fcbf49;\n      padding: 12px;\n      border-radius: 12px;\n      box-shadow: 0 4px 16px rgba(252, 191, 73, 0.5);\n      max-height: 300px;\n      overflow: auto;\n      margin-top: 16px;\n      display: none;\n    }\n    #saved-submissions-panel h2 {\n      margin-bottom: 8px;\n      font-weight: 700;\n      color: #cf8f00;\n      font-size: 1.25rem;\n    }\n    #saved-submissions-table {\n      width: 100%;\n      border-collapse: collapse;\n    }\n    #saved-submissions-table th, #saved-submissions-table td {\n      border: 1px solid #f0c96e;\n      padding: 6px 8px;\n      text-align: center;\n      font-size: 0.9rem;\n    }\n    #saved-submissions-table th {\n      background-color: #fde6a3;\n      position: sticky;\n      top: 0;\n      z-index: 1;\n    }\n    .status-pending {\n      color: #d18e00;\n      font-weight: 600;\n    }\n    .status-success {\n      color: #2b7a0b;\n      font-weight: 600;\n    }\n    .status-failed {\n      color: #b00020;\n      font-weight: 600;\n    }\n    .retry-btn {\n      background: #b00020;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      padding: 6px 10px;\n      font-size: 0.85rem;\n      cursor: pointer;\n      transition: background 0.3s;\n    }\n    .retry-btn:hover {\n      background: #7a000f;\n    }\n    .thumbnail-img {\n      max-width: 80px;\n      max-height: 60px;\n      border-radius: 8px;\n      object-fit: contain;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <div style=\"display:flex; align-items:center; gap:8px;\">\n        <button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n      </div>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n        <div id=\"capture-btns\">\n          <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n          <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n        </div>\n\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n          <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n          <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n        </div>\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n\n      <!-- Saved Submissions Panel -->\n      <section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n        <h2>Saved Submissions</h2>\n        <table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n          <thead>\n            <tr>\n              <th>Picture</th>\n              <th>MRN</th>\n              <th>Device</th>\n              <th>Status</th>\n              <th>Action</th>\n            </tr>\n          </thead>\n          <tbody id=\"saved-submissions-body\">\n            <!-- Entries dynamically inserted -->\n          </tbody>\n        </table>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // Saved submissions elements\n  const showSubmissionsBtn = document.getElementById('show-submissions-btn');\n  const savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\n  const savedSubmissionsBody = document.getElementById('saved-submissions-body');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null; // For photo capture camera\n  let qrStream = null;     // For QR scanner camera\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n\n  // Key for localStorage\n  const STORAGE_KEY = 'patientDeviceSubmissions';\n\n  // --- Helper Functions ---\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // ----- Fetch patient info, show MRN + name -----\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Patient info fetch failed: \\${res.status}\\`);\n      const json = await res.json();\n\n      let patientName = '';\n      if(typeof json === 'object' && json !== null){\n        patientName = json.patientName || json.name || '';\n      }\n\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  // ----- Load Devices -----\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let json = await res.json();\n\n      if(!Array.isArray(json)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      currentDevices = json;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // ----- Render device cards, clicking immediately opens camera for that device -----\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n        startCamera();\n      };\n\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  // ----- Camera photo capture functions -----\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n  });\n  captureBtn.addEventListener('click', takePhoto);\n\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  // Save submission records to localStorage\n\n  function loadSavedSubmissions() {\n    try {\n      const dataStr = localStorage.getItem(STORAGE_KEY);\n      if(!dataStr) return [];\n      return JSON.parse(dataStr);\n    } catch(e){\n      console.warn('Failed to parse saved submissions in localStorage', e);\n      return [];\n    }\n  }\n\n  function saveSubmissions(submissions) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n    } catch(e){\n      console.warn('Failed to save submissions to localStorage', e);\n    }\n  }\n\n  function addSubmissionRecord(record) {\n    const submissions = loadSavedSubmissions();\n    submissions.push(record);\n    saveSubmissions(submissions);\n  }\n\n  function updateSubmissionStatus(id, newStatus) {\n    const submissions = loadSavedSubmissions();\n    const idx = submissions.findIndex(s => s.id === id);\n    if(idx !== -1){\n      submissions[idx].status = newStatus;\n      saveSubmissions(submissions);\n    }\n    renderSavedSubmissions();\n  }\n\n  // Render the submissions in the table with retry button on failures\n  function renderSavedSubmissions() {\n    clearChildren(savedSubmissionsBody);\n    const submissions = loadSavedSubmissions();\n    if(submissions.length === 0){\n      const row = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 5;\n      td.textContent = 'No saved submissions yet.';\n      td.style.fontStyle = 'italic';\n      row.appendChild(td);\n      savedSubmissionsBody.appendChild(row);\n      return;\n    }\n    submissions.forEach(sub => {\n      const row = document.createElement('tr');\n\n      // Picture thumbnail\n      const picTd = document.createElement('td');\n      const img = document.createElement('img');\n      // Image is stored as base64 blob string URL\n      img.src = sub.photoDataUrl || '';\n      img.alt = 'Submitted device photo';\n      img.className = 'thumbnail-img';\n      picTd.appendChild(img);\n      row.appendChild(picTd);\n\n      // MRN\n      const mrnTd = document.createElement('td');\n      mrnTd.textContent = sub.mrn || '';\n      row.appendChild(mrnTd);\n\n      // Device display string\n      const deviceTd = document.createElement('td');\n      try{\n        const device = JSON.parse(sub.device);\n        deviceTd.textContent = device.POCEquipment || '';\n      } catch {\n        deviceTd.textContent = '';\n      }\n      row.appendChild(deviceTd);\n\n      // Status with colors\n      const statusTd = document.createElement('td');\n      statusTd.textContent = sub.status;\n      statusTd.classList.add(\n        sub.status === 'Pending' ? 'status-pending' :\n        sub.status === 'Success' ? 'status-success' :\n        'status-failed'\n      );\n      row.appendChild(statusTd);\n\n      // Action retry button if failed\n      const actionTd = document.createElement('td');\n      if(sub.status === 'Failed'){\n        const retryBtn = document.createElement('button');\n        retryBtn.textContent = 'Retry';\n        retryBtn.className = 'retry-btn';\n        retryBtn.addEventListener('click', () => retrySubmission(sub));\n        actionTd.appendChild(retryBtn);\n      } else {\n        actionTd.textContent = '-';\n      }\n      row.appendChild(actionTd);\n\n      savedSubmissionsBody.appendChild(row);\n    });\n  }\n\n  // Retry a failed upload\n  async function retrySubmission(sub) {\n    updateSubmissionStatus(sub.id, 'Pending');\n    try {\n      // Convert base64 data URL to Blob\n      const blob = await (await fetch(sub.photoDataUrl)).blob();\n      const formData = new FormData();\n      formData.append('mrn', sub.mrn);\n      formData.append('device', sub.device);\n      formData.append('photo', blob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      updateSubmissionStatus(sub.id, 'Success');\n      alert('Submission upload succeeded!');\n    } catch(e) {\n      updateSubmissionStatus(sub.id, 'Failed');\n      alert('Submission upload failed: ' + e.message);\n    }\n  }\n\n\n  // ----- Upload photo and save record -----\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      // Prepare base64 for thumbnail save\n      const base64DataUrl = await blobToDataURL(photoBlob);\n\n      // Create record with unique id (timestamp + random)\n      const submissionRecord = {\n        id: Date.now() + '-' + Math.random().toString(36).substr(2,9),\n        mrn: currentMRN,\n        device: JSON.stringify(selectedDevice),\n        photoDataUrl: base64DataUrl,\n        status: 'Pending'\n      };\n      addSubmissionRecord(submissionRecord);\n      renderSavedSubmissions();\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      const html = await res.text();\n\n      // Update status success\n      updateSubmissionStatus(submissionRecord.id, 'Success');\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n      // Update last added submission to failed\n      const submissions = loadSavedSubmissions();\n      if(submissions.length > 0){\n        updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n      }\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  // Convert Blob/image to base64 data url\n  function blobToDataURL(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {resolve(reader.result)};\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // Load Devices and Patient Info button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value (or on input change)\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Modal close event\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // Show/Hide Saved Submissions panel\n  showSubmissionsBtn.addEventListener('click', () => {\n    const isVisible = savedSubmissionsPanel.style.display === 'block';\n    if(isVisible){\n      savedSubmissionsPanel.style.display = 'none';\n      showSubmissionsBtn.textContent = 'Show Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n    } else {\n      savedSubmissionsPanel.style.display = 'block';\n      showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n      renderSavedSubmissions();\n    }\n  });\n\n  // QR Scanner setup and functions\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.dispatchEvent(new Event('input'));\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically for QR scan decoding (CDN)\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n  // --- On Page Load: try to load patient info + devices if MRN in URL ---\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        180,
        1180
      ],
      "id": "5d9b4be5-c1db-42d1-b92a-c0fa2ef67e06",
      "name": "Code4"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n      user-select:none;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    #show-submissions-btn {\n      background: linear-gradient(135deg, #ffa500, #cc8400);\n      width: auto;\n      padding: 10px 16px;\n      font-size: 1rem;\n      border-radius: 12px;\n      box-shadow: 0 4px 10px rgba(255,165,0, 0.5);\n      transition: background 0.3s, transform 0.15s;\n      margin-left: auto;\n      user-select:none;\n    }\n    #show-submissions-btn:hover {\n      background: linear-gradient(135deg, #cc8400, #aa6a00);\n      transform: translateY(-2px);\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n    }\n    video, #qr-video {\n      width: 100%;\n      border-radius: 16px;\n      background: black;\n    }\n    #capture-btns {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #capture-btns button {\n      flex-grow: 1;\n      margin: 0 6px;\n    }\n    #captured-photo {\n      width: 100%;\n      margin-top: 12px;\n      border-radius: 16px;\n      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n    }\n    .hidden {\n      display: none;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 24px auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for returned HTML */\n    #modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n    }\n    #modal-content {\n      background: white;\n      border-radius: 14px;\n      max-width: 95vw;\n      max-height: 90vh;\n      overflow: auto;\n      padding: 16px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      animation: fadeInScale 0.35s ease forwards;\n    }\n    @keyframes fadeInScale {\n      0% {opacity: 0; transform: scale(0.85);}\n      100% {opacity: 1; transform: scale(1);}\n    }\n    #modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 10000;\n      transition: background 0.3s;\n    }\n    #modal-close-btn:hover {\n      background: #d72950;\n    }\n    /* QR Scanner Overlay */\n    #qr-scanner-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.9);\n      display: none;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      z-index: 10000;\n    }\n    #qr-video {\n      border-radius: 14px;\n      width: 90vw;\n      max-width: 400px;\n      height: auto;\n    }\n    #qr-instruction {\n      color: white;\n      margin-top: 12px;\n      font-size: 1.1rem;\n    }\n    #qr-cancel-btn {\n      margin-top: 20px;\n      padding: 12px 24px;\n      border-radius: 12px;\n      border: none;\n      background: #ff385c;\n      color: white;\n      font-size: 1.1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n    }\n    #qr-cancel-btn:hover {\n      background: #d72950;\n    }\n    /* Saved Submissions Panel Full Screen */\n    #saved-submissions-panel {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: #fff8e1;\n      border: 2px solid #fcbf49;\n      border-radius: 0;\n      box-shadow: none;\n      padding: 16px;\n      box-sizing: border-box;\n      display: none;\n      flex-direction: column;\n      user-select:none;\n      z-index: 100000;\n    }\n    #saved-submissions-panel h2 {\n      margin-bottom: 8px;\n      font-weight: 700;\n      color: #cf8f00;\n      font-size: 1.8rem;\n      text-align: center;\n    }\n    #saved-submissions-close {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 28px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n      user-select:none;\n      z-index: 100001;\n    }\n    #saved-submissions-close:hover {\n      background: #d72950;\n    }\n    #pagination-controls {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin: 12px 0;\n      gap: 8px;\n      flex-wrap: wrap;\n    }\n    #pagination-controls label {\n      font-weight: 700;\n      font-size: 1.1rem;\n      color: #996700;\n    }\n    #pagination-controls input[type=date], #pagination-controls input[type=search] {\n      padding: 8px 10px;\n      font-size: 1.1rem;\n      border-radius: 8px;\n      border: 1.5px solid #fcbf49;\n      width: 180px;\n      max-width: 45vw;\n      box-sizing: border-box;\n    }\n    #saved-submissions-table {\n      width: 100%;\n      border-collapse: collapse;\n      flex-grow: 1;\n      display: block;\n      overflow-y: auto;\n      max-height: calc(100vh - 160px);\n    }\n    #saved-submissions-table thead, #saved-submissions-table tbody {\n      display: table;\n      width: 100%;\n      table-layout: fixed;\n    }\n    #saved-submissions-table tbody {\n      display: block;\n      overflow-y: auto;\n      max-height: calc(100vh - 200px);\n    }\n    #saved-submissions-table th, #saved-submissions-table td {\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      text-align: center;\n      font-size: 1rem;\n      vertical-align: middle;\n      word-wrap: break-word;\n    }\n    #saved-submissions-table th {\n      background-color: #fde6a3;\n      position: sticky;\n      top: 0;\n      z-index: 1;\n    }\n    .status-pending {\n      color: #d18e00;\n      font-weight: 700;\n    }\n    .status-success {\n      color: #2b7a0b;\n      font-weight: 700;\n    }\n    .status-failed {\n      color: #b00020;\n      font-weight: 700;\n    }\n    .retry-btn {\n      background: #b00020;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      padding: 6px 12px;\n      font-size: 1rem;\n      cursor: pointer;\n      transition: background 0.3s;\n      user-select:none;\n    }\n    .retry-btn:hover {\n      background: #7a000f;\n    }\n    .thumbnail-img {\n      max-width: 80px;\n      max-height: 60px;\n      border-radius: 8px;\n      object-fit: contain;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <div style=\"display:flex; align-items:center; gap:8px;\">\n        <button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n      </div>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n        <div id=\"capture-btns\">\n          <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n          <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n        </div>\n\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n          <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n          <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n        </div>\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n\n      <!-- Saved Submissions Panel -->\n      <section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n        <h2>Saved Submissions</h2>\n        <button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n        <div id=\"pagination-controls\">\n          <label for=\"date-filter-input\">Select Date:</label>\n          <input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n          <label for=\"search-input\">Search:</label>\n          <input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n        </div>\n        <table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n          <thead>\n            <tr>\n              <th>Picture</th>\n              <th>MRN</th>\n              <th>Device</th>\n              <th>Date/Time Captured</th>\n              <th>Status</th>\n              <th>Action</th>\n            </tr>\n          </thead>\n          <tbody id=\"saved-submissions-body\">\n            <!-- Entries dynamically inserted -->\n          </tbody>\n        </table>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // Saved submissions elements\n  const showSubmissionsBtn = document.getElementById('show-submissions-btn');\n  const savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\n  const savedSubmissionsBody = document.getElementById('saved-submissions-body');\n  const dateFilterInput = document.getElementById('date-filter-input');\n  const searchInput = document.getElementById('search-input');\n  const savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null;\n  let qrStream = null;\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n\n  // Storage key\n  const STORAGE_KEY = 'patientDeviceSubmissions';\n\n  // --- Helper Functions ---\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // Date format helpers\n  function formatDateTime(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n  }\n  function formatDate(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${dt.getFullYear()}-\\${pad(dt.getMonth()+1)}-\\${pad(dt.getDate())}\\`; // yyyy-MM-dd for input[type=date]\n  }\n  // To display MM/DD/YYYY from yyyy-MM-dd\n  function formatDateDisplay(dateStr){\n    const [y,m,d] = dateStr.split('-');\n    return \\`\\${m}/\\${d}/\\${y}\\`;\n  }\n\n  // ----- Fetch patient info, show MRN + name -----\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Patient info fetch failed: \\${res.status}\\`);\n      const json = await res.json();\n\n      let patientName = '';\n      if(typeof json === 'object' && json !== null){\n        patientName = json.patientName || json.name || '';\n      }\n\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  // ----- Load Devices -----\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let json = await res.json();\n\n      if(!Array.isArray(json)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      currentDevices = json;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // ----- Render device cards -----\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n        startCamera();\n      };\n\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  // ----- Camera photo capture functions -----\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n  });\n  captureBtn.addEventListener('click', takePhoto);\n\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  // LocalStorage helpers\n  function loadSavedSubmissions() {\n    try {\n      const dataStr = localStorage.getItem(STORAGE_KEY);\n      if(!dataStr) return [];\n      return JSON.parse(dataStr);\n    } catch(e){\n      console.warn('Failed to parse saved submissions in localStorage', e);\n      return [];\n    }\n  }\n  function saveSubmissions(submissions) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n    } catch(e){\n      console.warn('Failed to save submissions to localStorage', e);\n    }\n  }\n  function addSubmissionRecord(record) {\n    const submissions = loadSavedSubmissions();\n    submissions.push(record);\n    saveSubmissions(submissions);\n  }\n  function updateSubmissionStatus(id, newStatus) {\n    const submissions = loadSavedSubmissions();\n    const idx = submissions.findIndex(s => s.id === id);\n    if(idx !== -1){\n      submissions[idx].status = newStatus;\n      saveSubmissions(submissions);\n    }\n    renderSavedSubmissions();\n  }\n\n  // Filter submissions by date & search\n  function filterSubmissions(submissions, dateStr, searchTerm){\n    let filtered = submissions;\n\n    if(dateStr){\n      filtered = filtered.filter(s => {\n        let dt = new Date(s.timestamp);\n        let yyyy = dt.getFullYear().toString();\n        let mm = (dt.getMonth()+1).toString().padStart(2,'0');\n        let dd = dt.getDate().toString().padStart(2,'0');\n        return \\`\\${yyyy}-\\${mm}-\\${dd}\\` === dateStr;\n      });\n    }\n    if(searchTerm){\n      searchTerm = searchTerm.toLowerCase();\n      filtered = filtered.filter(s => {\n        if(s.mrn.toLowerCase().includes(searchTerm)) return true;\n        try {\n          const device = JSON.parse(s.device);\n          if(device.POCEquipment && device.POCEquipment.toLowerCase().includes(searchTerm)) return true;\n        } catch{}\n        return false;\n      });\n    }\n    return filtered;\n  }\n\n  // Render submissions\n  function renderSavedSubmissions() {\n    clearChildren(savedSubmissionsBody);\n    let submissions = loadSavedSubmissions();\n\n    // Sort descending by timestamp\n    submissions.sort((a,b) => b.timestamp - a.timestamp);\n\n    if(submissions.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 6;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No saved submissions yet.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n\n    // Filter from controls\n    const dateVal = dateFilterInput.value;\n    const searchVal = searchInput.value.trim();\n\n    const filteredSubs = filterSubmissions(submissions, dateVal, searchVal);\n\n    if(filteredSubs.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 6;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No submissions match your filter.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n\n    for(const sub of filteredSubs){\n      const tr = document.createElement('tr');\n\n      const picTd = document.createElement('td');\n      const img = document.createElement('img');\n      img.src = sub.photoDataUrl || '';\n      img.alt = 'Photo thumbnail';\n      img.className = 'thumbnail-img';\n      picTd.appendChild(img);\n      tr.appendChild(picTd);\n\n      const mrnTd = document.createElement('td');\n      mrnTd.textContent = sub.mrn || '';\n      tr.appendChild(mrnTd);\n\n      const deviceTd = document.createElement('td');\n      try {\n        const device = JSON.parse(sub.device);\n        deviceTd.textContent = device.POCEquipment || '';\n      } catch {\n        deviceTd.textContent = '';\n      }\n      tr.appendChild(deviceTd);\n\n      const dateTd = document.createElement('td');\n      dateTd.textContent = formatDateTime(sub.timestamp);\n      tr.appendChild(dateTd);\n\n      const statusTd = document.createElement('td');\n      statusTd.textContent = sub.status;\n      statusTd.classList.add(\n        sub.status === 'Pending' ? 'status-pending' :\n        sub.status === 'Success' ? 'status-success' :\n        'status-failed'\n      );\n      tr.appendChild(statusTd);\n\n      const actionTd = document.createElement('td');\n      if(sub.status === 'Failed'){\n        const retryBtn = document.createElement('button');\n        retryBtn.textContent = 'Retry';\n        retryBtn.className = 'retry-btn';\n        retryBtn.addEventListener('click', () => retrySubmission(sub));\n        actionTd.appendChild(retryBtn);\n      } else {\n        actionTd.textContent = '-';\n      }\n      tr.appendChild(actionTd);\n\n      savedSubmissionsBody.appendChild(tr);\n    }\n  }\n\n  // On page load fill date picker with range & disable dates without data\n  function updateDatePickerRange() {\n    const submissions = loadSavedSubmissions();\n    if(submissions.length === 0){\n      dateFilterInput.disabled = true;\n      dateFilterInput.value = '';\n      return;\n    }\n    let minDate = null, maxDate = null;\n\n    for(const sub of submissions){\n      if(!minDate || sub.timestamp < minDate) minDate = sub.timestamp;\n      if(!maxDate || sub.timestamp > maxDate) maxDate = sub.timestamp;\n    }\n\n    const minDateStr = formatDate(minDate);\n    const maxDateStr = formatDate(maxDate);\n\n    dateFilterInput.min = minDateStr;\n    dateFilterInput.max = maxDateStr;\n\n    // Set default to maxDate if empty or invalid\n    if(!dateFilterInput.value || dateFilterInput.value < minDateStr || dateFilterInput.value > maxDateStr){\n      dateFilterInput.value = maxDateStr;\n    }\n\n    dateFilterInput.disabled = false;\n  }\n\n  // Retry failed submission upload\n  async function retrySubmission(sub) {\n    updateSubmissionStatus(sub.id, 'Pending');\n    try {\n      const blob = await (await fetch(sub.photoDataUrl)).blob();\n      const formData = new FormData();\n      formData.append('mrn', sub.mrn);\n      formData.append('device', sub.device);\n      formData.append('photo', blob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      updateSubmissionStatus(sub.id, 'Success');\n      alert('Submission upload succeeded!');\n    } catch(e) {\n      updateSubmissionStatus(sub.id, 'Failed');\n      alert('Submission upload failed: ' + e.message);\n    }\n  }\n\n  // Upload photo and save record\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const base64DataUrl = await blobToDataURL(photoBlob);\n\n      const submissionRecord = {\n        id: Date.now() + '-' + Math.random().toString(36).substr(2,9),\n        mrn: currentMRN,\n        device: JSON.stringify(selectedDevice),\n        photoDataUrl: base64DataUrl,\n        status: 'Pending',\n        timestamp: Date.now()\n      };\n      addSubmissionRecord(submissionRecord);\n      updateDatePickerRange();\n      renderSavedSubmissions();\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      const html = await res.text();\n\n      updateSubmissionStatus(submissionRecord.id, 'Success');\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n      const submissions = loadSavedSubmissions();\n      if(submissions.length > 0){\n        updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n      }\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  // Convert Blob to base64\n  function blobToDataURL(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {resolve(reader.result)};\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // Load Devices and Patient Info button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value (or on input change)\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Modal close event\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // Show/Hide Saved Submissions panel\n  showSubmissionsBtn.addEventListener('click', () => {\n    const visible = savedSubmissionsPanel.style.display === 'flex';\n    if(visible){\n      savedSubmissionsPanel.style.display = 'none';\n      showSubmissionsBtn.textContent = 'Show Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n    } else {\n      savedSubmissionsPanel.style.display = 'flex';\n      showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n      updateDatePickerRange();\n      renderSavedSubmissions();\n    }\n  });\n  savedSubmissionsCloseBtn.addEventListener('click', () => {\n    savedSubmissionsPanel.style.display = 'none';\n    showSubmissionsBtn.textContent = 'Show Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n  });\n\n  // Date filter change event\n  dateFilterInput.addEventListener('change', renderSavedSubmissions);\n\n  // Search input change (debounced)\n  let searchTimeout = null;\n  searchInput.addEventListener('input', () => {\n    clearTimeout(searchTimeout);\n    searchTimeout = setTimeout(() => {\n      renderSavedSubmissions();\n    }, 250);\n  });\n\n  // QR Scanner setup and functions\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.dispatchEvent(new Event('input'));\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically for QR scan decoding (CDN)\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n  // --- On Page Load: try to load patient info + devices if MRN in URL ---\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        180,
        1360
      ],
      "id": "928eb7c4-3f02-431c-9444-402f00853898",
      "name": "Code5"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n      user-select:none;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    #show-submissions-btn {\n      background: linear-gradient(135deg, #ffa500, #cc8400);\n      width: auto;\n      padding: 10px 16px;\n      font-size: 1rem;\n      border-radius: 12px;\n      box-shadow: 0 4px 10px rgba(255,165,0, 0.5);\n      transition: background 0.3s, transform 0.15s;\n      margin-left: auto;\n      user-select:none;\n    }\n    #show-submissions-btn:hover {\n      background: linear-gradient(135deg, #cc8400, #aa6a00);\n      transform: translateY(-2px);\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n    }\n    video, #qr-video {\n      width: 100%;\n      border-radius: 16px;\n      background: black;\n    }\n    #capture-btns {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #capture-btns button {\n      flex-grow: 1;\n      margin: 0 6px;\n    }\n    #captured-photo {\n      width: 100%;\n      margin-top: 12px;\n      border-radius: 16px;\n      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n    }\n    .hidden {\n      display: none;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 24px auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for details */\n    #modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 110000; /* Increased z-index to bring in front of submissions panel */\n    }\n    #modal-detail-content {\n      max-height: 80vh;\n      overflow-y: auto;\n      font-size: 1rem;\n      color: #1a1a1a;\n      line-height: 1.4;\n      background: white;\n      border-radius: 14px;\n      padding: 16px 24px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      width: 90vw;\n      max-width: 480px;\n      box-sizing: border-box;\n      position: relative;\n    }\n    #modal-detail-content dt {\n      font-weight: 700;\n      margin-top: 1em;\n    }\n    #modal-detail-content dd {\n      margin-left: 1em;\n      margin-bottom: 0.5em;\n      word-break: break-word;\n    }\n    #modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 110001; /* higher than overlay to stay clickable */\n      transition: background 0.3s;\n    }\n    #modal-close-btn:hover {\n      background: #d72950;\n    }\n    /* QR Scanner Overlay */\n    #qr-scanner-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.9);\n      display: none;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      z-index: 10000;\n    }\n    #qr-video {\n      border-radius: 14px;\n      width: 90vw;\n      max-width: 400px;\n      height: auto;\n    }\n    #qr-instruction {\n      color: white;\n      margin-top: 12px;\n      font-size: 1.1rem;\n    }\n    #qr-cancel-btn {\n      margin-top: 20px;\n      padding: 12px 24px;\n      border-radius: 12px;\n      border: none;\n      background: #ff385c;\n      color: white;\n      font-size: 1.1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n    }\n    #qr-cancel-btn:hover {\n      background: #d72950;\n    }\n    /* Saved Submissions Panel Full Screen */\n    #saved-submissions-panel {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: #fff8e1;\n      border: 2px solid #fcbf49;\n      border-radius: 0;\n      box-shadow: none;\n      padding: 16px;\n      box-sizing: border-box;\n      display: none;\n      flex-direction: column;\n      user-select:none;\n      z-index: 100000;\n    }\n    #saved-submissions-panel h2 {\n      margin-bottom: 8px;\n      font-weight: 700;\n      color: #cf8f00;\n      font-size: 1.8rem;\n      text-align: center;\n    }\n    #saved-submissions-close {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 28px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n      user-select:none;\n      z-index: 100001;\n    }\n    #saved-submissions-close:hover {\n      background: #d72950;\n    }\n    #pagination-controls {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin: 12px 0;\n      gap: 8px;\n      flex-wrap: wrap;\n    }\n    #pagination-controls label {\n      font-weight: 700;\n      font-size: 1.1rem;\n      color: #996700;\n    }\n    #pagination-controls input[type=date], #pagination-controls input[type=search] {\n      padding: 8px 10px;\n      font-size: 1.1rem;\n      border-radius: 8px;\n      border: 1.5px solid #fcbf49;\n      width: 180px;\n      max-width: 45vw;\n      box-sizing: border-box;\n    }\n    #saved-submissions-table {\n      width: 100%;\n      border-collapse: collapse;\n      flex-grow: 1;\n      display: block;\n      overflow-y: auto;\n      max-height: calc(100vh - 160px);\n      table-layout: fixed;\n    }\n    #saved-submissions-table thead, #saved-submissions-table tbody {\n      display: table;\n      width: 100%;\n      table-layout: fixed;\n      /* Add fixed layout to keep columns aligned */\n    }\n    #saved-submissions-table tbody {\n      display: block;\n      overflow-y: auto;\n      max-height: calc(100vh - 200px);\n    }\n    #saved-submissions-table th, #saved-submissions-table td {\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      text-align: center;\n      font-size: 1rem;\n      vertical-align: middle;\n      word-wrap: break-word;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    #saved-submissions-table th {\n      background-color: #fde6a3;\n      position: sticky;\n      top: 0;\n      z-index: 1;\n    }\n    /* Make table rows clickable */\n    #saved-submissions-table tbody tr {\n      cursor: pointer;\n      transition: background-color 0.2s;\n      display: table-row;\n      width: 100%;\n      table-layout: fixed;\n    }\n    #saved-submissions-table tbody tr:hover {\n      background-color: #fffae6;\n    }\n    .status-pending {\n      color: #d18e00;\n      font-weight: 700;\n    }\n    .status-success {\n      color: #2b7a0b;\n      font-weight: 700;\n    }\n    .status-failed {\n      color: #b00020;\n      font-weight: 700;\n    }\n    .retry-btn {\n      background: #b00020;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      padding: 6px 12px;\n      font-size: 1rem;\n      cursor: pointer;\n      transition: background 0.3s;\n      user-select:none;\n    }\n    .retry-btn:hover {\n      background: #7a000f;\n    }\n    .thumbnail-img {\n      max-width: 80px;\n      max-height: 60px;\n      border-radius: 8px;\n      object-fit: contain;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <div style=\"display:flex; align-items:center; gap:8px;\">\n        <button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n      </div>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n        <div id=\"capture-btns\">\n          <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n          <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n        </div>\n\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n          <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n          <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n        </div>\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n\n      <!-- Saved Submissions Panel -->\n      <section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n        <h2>Saved Submissions</h2>\n        <button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n        <div id=\"pagination-controls\">\n          <label for=\"date-filter-input\">Select Date:</label>\n          <input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n          <label for=\"search-input\">Search:</label>\n          <input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n        </div>\n        <table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n          <thead>\n            <tr>\n              <th style=\"width:30%;\">MRN</th>\n              <th style=\"width:35%;\">POC</th>\n              <th style=\"width:20%;\">Date</th>\n              <th style=\"width:15%;\">Status</th>\n            </tr>\n          </thead>\n          <tbody id=\"saved-submissions-body\" tabindex=\"0\">\n            <!-- Entries dynamically inserted -->\n          </tbody>\n        </table>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for showing all info from clicked row -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n    <button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n    <div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n      <!-- Populated dynamically -->\n    </div>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalDetailContent = document.getElementById('modal-detail-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // Saved submissions elements\n  const showSubmissionsBtn = document.getElementById('show-submissions-btn');\n  const savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\n  const savedSubmissionsBody = document.getElementById('saved-submissions-body');\n  const dateFilterInput = document.getElementById('date-filter-input');\n  const searchInput = document.getElementById('search-input');\n  const savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null;\n  let qrStream = null;\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n\n  // Storage key\n  const STORAGE_KEY = 'patientDeviceSubmissions';\n\n  // --- Helper Functions ---\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // Date format helpers\n  function formatDateTime(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n  }\n  function formatDate(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${dt.getFullYear()}-\\${pad(dt.getMonth()+1)}-\\${pad(dt.getDate())}\\`; // yyyy-MM-dd for input[type=date]\n  }\n\n  // ----- Fetch patient info, show MRN + name -----\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Patient info fetch failed: \\${res.status}\\`);\n      const json = await res.json();\n\n      let patientName = '';\n      if(typeof json === 'object' && json !== null){\n        patientName = json.patientName || json.name || '';\n      }\n\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  // ----- Load Devices -----\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let json = await res.json();\n\n      if(!Array.isArray(json)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      currentDevices = json;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // ----- Render device cards -----\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n        startCamera();\n      };\n\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  // ----- Camera photo capture functions -----\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n  });\n  captureBtn.addEventListener('click', takePhoto);\n\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  // LocalStorage helpers\n  function loadSavedSubmissions() {\n    try {\n      const dataStr = localStorage.getItem(STORAGE_KEY);\n      if(!dataStr) return [];\n      return JSON.parse(dataStr);\n    } catch(e){\n      console.warn('Failed to parse saved submissions in localStorage', e);\n      return [];\n    }\n  }\n  function saveSubmissions(submissions) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n    } catch(e){\n      console.warn('Failed to save submissions to localStorage', e);\n    }\n  }\n  function addSubmissionRecord(record) {\n    const submissions = loadSavedSubmissions();\n    submissions.push(record);\n    saveSubmissions(submissions);\n  }\n  function updateSubmissionStatus(id, newStatus) {\n    const submissions = loadSavedSubmissions();\n    const idx = submissions.findIndex(s => s.id === id);\n    if(idx !== -1){\n      submissions[idx].status = newStatus;\n      saveSubmissions(submissions);\n    }\n    renderSavedSubmissions();\n  }\n\n  // Filter submissions by date & search\n  function filterSubmissions(submissions, dateStr, searchTerm){\n    let filtered = submissions;\n\n    if(dateStr){\n      filtered = filtered.filter(s => {\n        let dt = new Date(s.timestamp);\n        let yyyy = dt.getFullYear().toString();\n        let mm = (dt.getMonth()+1).toString().padStart(2,'0');\n        let dd = dt.getDate().toString().padStart(2,'0');\n        return \\`\\${yyyy}-\\${mm}-\\${dd}\\` === dateStr;\n      });\n    }\n    if(searchTerm){\n      searchTerm = searchTerm.toLowerCase();\n      filtered = filtered.filter(s => {\n        if(s.mrn.toLowerCase().includes(searchTerm)) return true;\n        try {\n          const device = JSON.parse(s.device);\n          if(device.POCEquipment && device.POCEquipment.toLowerCase().includes(searchTerm)) return true;\n        } catch{}\n        return false;\n      });\n    }\n    return filtered;\n  }\n\n  // Render submissions in table (MRN, POC, Date, Status)\n  function renderSavedSubmissions() {\n    clearChildren(savedSubmissionsBody);\n    let submissions = loadSavedSubmissions();\n\n    // Sort descending by timestamp\n    submissions.sort((a,b) => b.timestamp - a.timestamp);\n\n    if(submissions.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No saved submissions yet.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n\n    // Filter from controls\n    const dateVal = dateFilterInput.value;\n    const searchVal = searchInput.value.trim();\n\n    const filteredSubs = filterSubmissions(submissions, dateVal, searchVal);\n\n    if(filteredSubs.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No submissions match your filter.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n\n    for(const sub of filteredSubs){\n      const tr = document.createElement('tr');\n\n      // MRN\n      const mrnTd = document.createElement('td');\n      mrnTd.textContent = sub.mrn || '';\n      tr.appendChild(mrnTd);\n\n      // POC (from device JSON) – just name only per your request\n      const pocTd = document.createElement('td');\n      try {\n        const device = JSON.parse(sub.device);\n        pocTd.textContent = device.POCEquipment || '';\n      } catch {\n        pocTd.textContent = '';\n      }\n      tr.appendChild(pocTd);\n\n      // Date (no time)\n      const dateTd = document.createElement('td');\n      const dt = new Date(sub.timestamp);\n      const pad = (n) => n.toString().padStart(2,'0');\n      dateTd.textContent = \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()}\\`;\n      tr.appendChild(dateTd);\n\n      // Status\n      const statusTd = document.createElement('td');\n      statusTd.textContent = sub.status;\n      statusTd.classList.add(\n        sub.status === 'Pending' ? 'status-pending' :\n        sub.status === 'Success' ? 'status-success' :\n        'status-failed'\n      );\n      tr.appendChild(statusTd);\n\n      // Make row clickable to open modal with all info\n      tr.tabIndex = 0;\n      tr.style.cursor = 'pointer';\n\n      // Click handler for modal popup\n      tr.addEventListener('click', () => showSubmissionModal(sub));\n      tr.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key === ' '){\n          e.preventDefault();\n          showSubmissionModal(sub);\n        }\n      });\n\n      savedSubmissionsBody.appendChild(tr);\n    }\n  }\n\n  // Show modal with info from a submission (MRN, Device Name, Photo, Status, Full Date/Time)\n  function showSubmissionModal(sub) {\n    clearChildren(modalDetailContent);\n\n    const container = document.createElement('dl');\n\n    // MRN\n    const dtMrn = document.createElement('dt');\n    dtMrn.textContent = 'MRN';\n    const ddMrn = document.createElement('dd');\n    ddMrn.textContent = sub.mrn || '';\n    container.appendChild(dtMrn);\n    container.appendChild(ddMrn);\n\n    // Device Name only\n    const dtDevice = document.createElement('dt');\n    dtDevice.textContent = 'Device';\n    const ddDevice = document.createElement('dd');\n    try {\n      const deviceObj = JSON.parse(sub.device);\n      ddDevice.textContent = deviceObj.POCEquipment || 'N/A';\n    } catch {\n      ddDevice.textContent = 'N/A';\n    }\n    container.appendChild(dtDevice);\n    container.appendChild(ddDevice);\n\n    // Photo (thumbnail, large on modal)\n    if(sub.photoDataUrl){\n      const dtPhoto = document.createElement('dt');\n      dtPhoto.textContent = 'Photo';\n      const ddPhoto = document.createElement('dd');\n      const img = document.createElement('img');\n      img.src = sub.photoDataUrl;\n      img.alt = 'Submitted device photo';\n      img.style.maxWidth = '100%';\n      img.style.height = 'auto';\n      img.style.borderRadius = '12px';\n      img.style.boxShadow = '0 0 12px rgba(0,0,0,0.3)';\n      ddPhoto.appendChild(img);\n      container.appendChild(dtPhoto);\n      container.appendChild(ddPhoto);\n    }\n\n    // Status\n    const dtStatus = document.createElement('dt');\n    dtStatus.textContent = 'Status';\n    const ddStatus = document.createElement('dd');\n    ddStatus.textContent = sub.status;\n    ddStatus.classList.add(\n      sub.status === 'Pending' ? 'status-pending' :\n      sub.status === 'Success' ? 'status-success' :\n      'status-failed'\n    );\n    container.appendChild(dtStatus);\n    container.appendChild(ddStatus);\n\n    // Timestamp Full Date/Time\n    const dtTimestamp = document.createElement('dt');\n    dtTimestamp.textContent = 'Date/Time Captured';\n    const ddTimestamp = document.createElement('dd');\n    ddTimestamp.textContent = formatDateTime(sub.timestamp);\n    container.appendChild(dtTimestamp);\n    container.appendChild(ddTimestamp);\n\n    modalDetailContent.appendChild(container);\n\n    modalOverlay.style.display = 'flex';\n    modalOverlay.focus();\n  }\n\n  // Close modal\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    clearChildren(modalDetailContent);\n  });\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // Retry failed submission upload\n  async function retrySubmission(sub) {\n    updateSubmissionStatus(sub.id, 'Pending');\n    try {\n      const blob = await (await fetch(sub.photoDataUrl)).blob();\n      const formData = new FormData();\n      formData.append('mrn', sub.mrn);\n      formData.append('device', sub.device);\n      formData.append('photo', blob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      updateSubmissionStatus(sub.id, 'Success');\n      alert('Submission upload succeeded!');\n    } catch(e) {\n      updateSubmissionStatus(sub.id, 'Failed');\n      alert('Submission upload failed: ' + e.message);\n    }\n  }\n\n  // Upload photo and save record\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const base64DataUrl = await blobToDataURL(photoBlob);\n\n      const submissionRecord = {\n        id: Date.now() + '-' + Math.random().toString(36).substr(2,9),\n        mrn: currentMRN,\n        device: JSON.stringify(selectedDevice),\n        photoDataUrl: base64DataUrl,\n        status: 'Pending',\n        timestamp: Date.now()\n      };\n      addSubmissionRecord(submissionRecord);\n      updateDatePickerRange();\n      renderSavedSubmissions();\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n\n      updateSubmissionStatus(submissionRecord.id, 'Success');\n\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n      const submissions = loadSavedSubmissions();\n      if(submissions.length > 0){\n        updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n      }\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  // Convert Blob to base64\n  function blobToDataURL(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {resolve(reader.result)};\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // Load Devices and Patient Info button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value (or on input change)\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Show/Hide Saved Submissions panel\n  showSubmissionsBtn.addEventListener('click', () => {\n    const visible = savedSubmissionsPanel.style.display === 'flex';\n    if(visible){\n      savedSubmissionsPanel.style.display = 'none';\n      showSubmissionsBtn.textContent = 'Show Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n    } else {\n      savedSubmissionsPanel.style.display = 'flex';\n      showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n      updateDatePickerRange();\n      renderSavedSubmissions();\n    }\n  });\n  savedSubmissionsCloseBtn.addEventListener('click', () => {\n    savedSubmissionsPanel.style.display = 'none';\n    showSubmissionsBtn.textContent = 'Show Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n  });\n\n  // Date filter change event\n  dateFilterInput.addEventListener('change', renderSavedSubmissions);\n\n  // Search input change (debounced)\n  let searchTimeout = null;\n  searchInput.addEventListener('input', () => {\n    clearTimeout(searchTimeout);\n    searchTimeout = setTimeout(() => {\n      renderSavedSubmissions();\n    }, 250);\n  });\n\n  // QR Scanner setup and functions\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.dispatchEvent(new Event('input'));\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically for QR scan decoding (CDN)\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n  // --- On Page Load: try to load patient info + devices if MRN in URL ---\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        40,
        1360
      ],
      "id": "126fedae-147c-444f-b019-25ab0f486fc4",
      "name": "Code6"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n      user-select:none;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    #show-submissions-btn {\n      background: linear-gradient(135deg, #ffa500, #cc8400);\n      width: auto;\n      padding: 10px 16px;\n      font-size: 1rem;\n      border-radius: 12px;\n      box-shadow: 0 4px 10px rgba(255,165,0, 0.5);\n      transition: background 0.3s, transform 0.15s;\n      margin-left: auto;\n      user-select:none;\n    }\n    #show-submissions-btn:hover {\n      background: linear-gradient(135deg, #cc8400, #aa6a00);\n      transform: translateY(-2px);\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n    }\n    video, #qr-video {\n      width: 100%;\n      border-radius: 16px;\n      background: black;\n    }\n    #capture-btns {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #capture-btns button {\n      flex-grow: 1;\n      margin: 0 6px;\n    }\n    #captured-photo {\n      width: 100%;\n      margin-top: 12px;\n      border-radius: 16px;\n      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n    }\n    .hidden {\n      display: none;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 0 auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for details */\n    #modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 110000;\n    }\n    #modal-detail-content {\n      max-height: 80vh;\n      overflow-y: auto;\n      font-size: 1rem;\n      color: #1a1a1a;\n      line-height: 1.4;\n      background: white;\n      border-radius: 14px;\n      padding: 16px 24px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      width: 90vw;\n      max-width: 480px;\n      box-sizing: border-box;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n    }\n    #modal-detail-content dt {\n      font-weight: 700;\n      margin-top: 1em;\n    }\n    #modal-detail-content dd {\n      margin-left: 1em;\n      margin-bottom: 0.5em;\n      word-break: break-word;\n    }\n    #modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 110001;\n      transition: background 0.3s;\n    }\n    #modal-close-btn:hover {\n      background: #d72950;\n    }\n    #modal-retry-btn {\n      align-self: flex-start;\n      background: #b00020;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      padding: 8px 16px;\n      font-size: 1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 6px rgba(176,0,32,0.8);\n      transition: background 0.3s;\n      user-select:none;\n      margin-top: 8px;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n    #modal-retry-btn:hover:not(:disabled) {\n      background: #7a000f;\n    }\n    #modal-retry-btn:disabled {\n      background: #999999cc;\n      cursor: not-allowed;\n      box-shadow: none;\n    }\n    /* QR Scanner Overlay */\n    #qr-scanner-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.9);\n      display: none;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      z-index: 10000;\n    }\n    #qr-video {\n      border-radius: 14px;\n      width: 90vw;\n      max-width: 400px;\n      height: auto;\n    }\n    #qr-instruction {\n      color: white;\n      margin-top: 12px;\n      font-size: 1.1rem;\n    }\n    #qr-cancel-btn {\n      margin-top: 20px;\n      padding: 12px 24px;\n      border-radius: 12px;\n      border: none;\n      background: #ff385c;\n      color: white;\n      font-size: 1.1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n    }\n    #qr-cancel-btn:hover {\n      background: #d72950;\n    }\n    /* Saved Submissions Panel */\n    #saved-submissions-panel {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: #fff8e1;\n      border: 2px solid #fcbf49;\n      padding: 16px;\n      box-sizing: border-box;\n      display: none;\n      flex-direction: column;\n      user-select:none;\n      z-index: 100000;\n    }\n    #saved-submissions-panel h2 {\n      margin-bottom: 8px;\n      font-weight: 700;\n      color: #cf8f00;\n      font-size: 1.8rem;\n      text-align: center;\n    }\n    #saved-submissions-close {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 28px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n      user-select:none;\n      z-index: 100001;\n    }\n    #saved-submissions-close:hover {\n      background: #d72950;\n    }\n    #pagination-controls {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin: 12px 0;\n      gap: 8px;\n      flex-wrap: wrap;\n    }\n    #pagination-controls label {\n      font-weight: 700;\n      font-size: 1.1rem;\n      color: #996700;\n    }\n    #pagination-controls input[type=date], #pagination-controls input[type=search] {\n      padding: 8px 10px;\n      font-size: 1.1rem;\n      border-radius: 8px;\n      border: 1.5px solid #fcbf49;\n      width: 180px;\n      max-width: 45vw;\n      box-sizing: border-box;\n    }\n    #saved-submissions-table-wrapper {\n      /* Wrapper to enable overflow and fix header */\n      width: 100%;\n      overflow-x: auto;\n    }\n    #saved-submissions-table {\n      border-collapse: collapse;\n      width: 100%;\n      min-width: 400px;\n    }\n    #saved-submissions-table thead th {\n      background-color: #fde6a3;\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      font-weight: 700;\n      text-align: center;\n      white-space: nowrap;\n      position: sticky;\n      top: 0;\n      z-index: 2;\n      min-width: 90px;\n    }\n    #saved-submissions-table tbody tr {\n      cursor: pointer;\n      transition: background-color 0.2s;\n    }\n    #saved-submissions-table tbody tr:hover {\n      background-color: #fffae6;\n    }\n    #saved-submissions-table tbody td {\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      text-align: center;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      min-width: 90px;\n    }\n\n    .status-pending {\n      color: #d18e00;\n      font-weight: 700;\n    }\n    .status-success {\n      color: #2b7a0b;\n      font-weight: 700;\n    }\n    .status-failed {\n      color: #b00020;\n      font-weight: 700;\n    }\n    .thumbnail-img {\n      max-width: 80px;\n      max-height: 60px;\n      border-radius: 8px;\n      object-fit: contain;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <div style=\"display:flex; align-items:center; gap:8px;\">\n        <button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n      </div>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n        <div id=\"capture-btns\">\n          <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n          <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n        </div>\n\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n          <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n          <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n        </div>\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n\n      <!-- Saved Submissions Panel -->\n      <section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n        <h2>Saved Submissions</h2>\n        <button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n        <div id=\"pagination-controls\">\n          <label for=\"date-filter-input\">Select Date:</label>\n          <input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n          <label for=\"search-input\">Search:</label>\n          <input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n        </div>\n        <div id=\"saved-submissions-table-wrapper\">\n          <table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n            <thead>\n              <tr>\n                <th>MRN</th>\n                <th>POC</th>\n                <th>Date</th>\n                <th>Status</th>\n              </tr>\n            </thead>\n            <tbody id=\"saved-submissions-body\" tabindex=\"0\">\n              <!-- Entries dynamically inserted -->\n            </tbody>\n          </table>\n        </div>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for showing all info from clicked row -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n    <button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n    <div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n      <!-- Populated dynamically -->\n    </div>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalDetailContent = document.getElementById('modal-detail-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // Saved submissions elements\n  const showSubmissionsBtn = document.getElementById('show-submissions-btn');\n  const savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\n  const savedSubmissionsBody = document.getElementById('saved-submissions-body');\n  const dateFilterInput = document.getElementById('date-filter-input');\n  const searchInput = document.getElementById('search-input');\n  const savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null;\n  let qrStream = null;\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n  let submitting = false; // Track submission loading state\n  let currentModalSubmission = null; // Tracking submission in modal for retry\n\n  // Storage key\n  const STORAGE_KEY = 'patientDeviceSubmissions';\n\n  // --- Helper Functions ---\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.innerHTML = '<div class=\"loader\" aria-label=\"Loading\"></div>';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // Date format helpers\n  function formatDateTime(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n  }\n  function formatDate(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${dt.getFullYear()}-\\${pad(dt.getMonth()+1)}-\\${pad(dt.getDate())}\\`;\n  }\n\n  // Fetch patient info\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Patient info fetch failed: \\${res.status}\\`);\n      const json = await res.json();\n      let patientName = '';\n      if(typeof json === 'object' && json !== null){\n        patientName = json.patientName || json.name || '';\n      }\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  // Load devices\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let json = await res.json();\n      if(!Array.isArray(json)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      currentDevices = json;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // Render device cards\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    devices.forEach(device => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n        startCamera();\n      };\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', e => {\n        if(e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  // Camera functions\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  // LocalStorage helpers\n  function loadSavedSubmissions() {\n    try {\n      const dataStr = localStorage.getItem(STORAGE_KEY);\n      if(!dataStr) return [];\n      return JSON.parse(dataStr);\n    } catch(e){\n      console.warn('Failed to parse saved submissions in localStorage', e);\n      return [];\n    }\n  }\n  function saveSubmissions(submissions) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n    } catch(e){\n      console.warn('Failed to save submissions to localStorage', e);\n    }\n  }\n  function addSubmissionRecord(record) {\n    const submissions = loadSavedSubmissions();\n    submissions.push(record);\n    saveSubmissions(submissions);\n  }\n  function updateSubmissionStatus(id, newStatus) {\n    const submissions = loadSavedSubmissions();\n    const idx = submissions.findIndex(s => s.id === id);\n    if(idx !== -1){\n      submissions[idx].status = newStatus;\n      saveSubmissions(submissions);\n    }\n    renderSavedSubmissions();\n  }\n\n  // Filter submissions by date & search\n  function filterSubmissions(submissions, dateStr, searchTerm){\n    let filtered = submissions;\n    if(dateStr){\n      filtered = filtered.filter(s => {\n        let dt = new Date(s.timestamp);\n        let yyyy = dt.getFullYear().toString();\n        let mm = (dt.getMonth()+1).toString().padStart(2,'0');\n        let dd = dt.getDate().toString().padStart(2,'0');\n        return \\`\\${yyyy}-\\${mm}-\\${dd}\\` === dateStr;\n      });\n    }\n    if(searchTerm){\n      searchTerm = searchTerm.toLowerCase();\n      filtered = filtered.filter(s => {\n        if(s.mrn.toLowerCase().includes(searchTerm)) return true;\n        try {\n          const device = JSON.parse(s.device);\n          if(device.POCEquipment && device.POCEquipment.toLowerCase().includes(searchTerm)) return true;\n        } catch{}\n        return false;\n      });\n    }\n    return filtered;\n  }\n\n  // Render submissions in table\n  function renderSavedSubmissions() {\n    clearChildren(savedSubmissionsBody);\n    let submissions = loadSavedSubmissions();\n    submissions.sort((a,b) => b.timestamp - a.timestamp);\n\n    if(submissions.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No saved submissions yet.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n    const dateVal = dateFilterInput.value;\n    const searchVal = searchInput.value.trim();\n    const filteredSubs = filterSubmissions(submissions, dateVal, searchVal);\n    if(filteredSubs.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No submissions match your filter.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n    for(const sub of filteredSubs){\n      const tr = document.createElement('tr');\n\n      const mrnTd = document.createElement('td');\n      mrnTd.textContent = sub.mrn || '';\n      tr.appendChild(mrnTd);\n\n      const pocTd = document.createElement('td');\n      try {\n        const device = JSON.parse(sub.device);\n        pocTd.textContent = device.POCEquipment || '';\n      } catch {\n        pocTd.textContent = '';\n      }\n      tr.appendChild(pocTd);\n\n      const dateTd = document.createElement('td');\n      const dt = new Date(sub.timestamp);\n      const pad = (n) => n.toString().padStart(2,'0');\n      dateTd.textContent = \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()}\\`;\n      tr.appendChild(dateTd);\n\n      const statusTd = document.createElement('td');\n      statusTd.textContent = sub.status;\n      statusTd.classList.add(\n        sub.status === 'Pending' ? 'status-pending' :\n        sub.status === 'Success' ? 'status-success' :\n        'status-failed'\n      );\n      tr.appendChild(statusTd);\n\n      tr.tabIndex = 0;\n      tr.style.cursor = 'pointer';\n\n      tr.addEventListener('click', () => showSubmissionModal(sub));\n      tr.addEventListener('keydown', e => {\n        if(e.key === 'Enter' || e.key === ' '){\n          e.preventDefault();\n          showSubmissionModal(sub);\n        }\n      });\n\n      savedSubmissionsBody.appendChild(tr);\n    }\n  }\n\n  // Show modal with submission details + retry button if failed\n  function showSubmissionModal(sub) {\n    clearChildren(modalDetailContent);\n    currentModalSubmission = sub;\n\n    const container = document.createElement('dl');\n\n    const dtMrn = document.createElement('dt');\n    dtMrn.textContent = 'MRN';\n    const ddMrn = document.createElement('dd');\n    ddMrn.textContent = sub.mrn || '';\n    container.appendChild(dtMrn);\n    container.appendChild(ddMrn);\n\n    const dtDevice = document.createElement('dt');\n    dtDevice.textContent = 'Device';\n    const ddDevice = document.createElement('dd');\n    try {\n      const deviceObj = JSON.parse(sub.device);\n      ddDevice.textContent = deviceObj.POCEquipment || 'N/A';\n    } catch {\n      ddDevice.textContent = 'N/A';\n    }\n    container.appendChild(dtDevice);\n    container.appendChild(ddDevice);\n\n    if(sub.photoDataUrl){\n      const dtPhoto = document.createElement('dt');\n      dtPhoto.textContent = 'Photo';\n      const ddPhoto = document.createElement('dd');\n      const img = document.createElement('img');\n      img.src = sub.photoDataUrl;\n      img.alt = 'Submitted device photo';\n      img.style.maxWidth = '100%';\n      img.style.height = 'auto';\n      img.style.borderRadius = '12px';\n      img.style.boxShadow = '0 0 12px rgba(0,0,0,0.3)';\n      ddPhoto.appendChild(img);\n      container.appendChild(dtPhoto);\n      container.appendChild(ddPhoto);\n    }\n\n    const dtStatus = document.createElement('dt');\n    dtStatus.textContent = 'Status';\n    const ddStatus = document.createElement('dd');\n    ddStatus.textContent = sub.status;\n    ddStatus.classList.add(\n      sub.status === 'Pending' ? 'status-pending' :\n      sub.status === 'Success' ? 'status-success' :\n      'status-failed'\n    );\n    container.appendChild(dtStatus);\n    container.appendChild(ddStatus);\n\n    const dtTimestamp = document.createElement('dt');\n    dtTimestamp.textContent = 'Date/Time Captured';\n    const ddTimestamp = document.createElement('dd');\n    ddTimestamp.textContent = formatDateTime(sub.timestamp);\n    container.appendChild(dtTimestamp);\n    container.appendChild(ddTimestamp);\n\n    modalDetailContent.appendChild(container);\n\n    // Add retry button if failed\n    if(sub.status === 'Failed') {\n      const retryBtn = document.createElement('button');\n      retryBtn.id = 'modal-retry-btn';\n      retryBtn.setAttribute('aria-label', 'Retry failed submission upload');\n      retryBtn.textContent = 'Retry Upload';\n      modalDetailContent.appendChild(retryBtn);\n\n      retryBtn.addEventListener('click', async () => {\n        if(submitting) return;\n        submitting = true;\n        retryBtn.disabled = true;\n        retryBtn.innerHTML = '<div class=\"loader\" aria-label=\"Uploading\"></div> Uploading...';\n\n        try {\n          await retrySubmission(sub);\n          // After retry, refresh modal to update status and possibly hide button\n          modalDetailContent.removeChild(retryBtn);\n          clearChildren(modalDetailContent);\n          showSubmissionModal(loadSavedSubmissions().find(s => s.id === sub.id) || sub);\n          renderSavedSubmissions();\n        } catch (err) {\n          alert('Retry failed: ' + err.message);\n          retryBtn.disabled = false;\n          retryBtn.textContent = 'Retry Upload';\n        }\n        submitting = false;\n      });\n    }\n\n    modalOverlay.style.display = 'flex';\n    modalOverlay.focus();\n  }\n\n  // Close modal\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    clearChildren(modalDetailContent);\n    currentModalSubmission = null;\n    submitting = false;\n  });\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // Retry failed submission upload logic\n  async function retrySubmission(sub) {\n    updateSubmissionStatus(sub.id, 'Pending');\n    try {\n      const blob = await (await fetch(sub.photoDataUrl)).blob();\n      const formData = new FormData();\n      formData.append('mrn', sub.mrn);\n      formData.append('device', sub.device);\n      formData.append('photo', blob, 'device.jpg');\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      updateSubmissionStatus(sub.id, 'Success');\n      alert('Submission upload succeeded!');\n    } catch(e) {\n      updateSubmissionStatus(sub.id, 'Failed');\n      alert('Submission upload failed: ' + e.message);\n      throw e;\n    }\n  }\n\n  // Upload photo and save record (during photo capture)\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, '');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n      const base64DataUrl = await blobToDataURL(photoBlob);\n      const submissionRecord = {\n        id: Date.now() + '-' + Math.random().toString(36).substr(2,9),\n        mrn: currentMRN,\n        device: JSON.stringify(selectedDevice),\n        photoDataUrl: base64DataUrl,\n        status: 'Pending',\n        timestamp: Date.now()\n      };\n      addSubmissionRecord(submissionRecord);\n      updateDatePickerRange();\n      renderSavedSubmissions();\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      updateSubmissionStatus(submissionRecord.id, 'Success');\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n      const submissions = loadSavedSubmissions();\n      if(submissions.length > 0){\n        updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n      }\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  // Convert Blob to base64 string\n  function blobToDataURL(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {resolve(reader.result)};\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // Load Devices and Patient Info button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', e => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Show/Hide Saved Submissions panel\n  showSubmissionsBtn.addEventListener('click', () => {\n    const visible = savedSubmissionsPanel.style.display === 'flex';\n    if(visible){\n      savedSubmissionsPanel.style.display = 'none';\n      showSubmissionsBtn.textContent = 'Show Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n    } else {\n      savedSubmissionsPanel.style.display = 'flex';\n      showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n      updateDatePickerRange();\n      renderSavedSubmissions();\n    }\n  });\n  savedSubmissionsCloseBtn.addEventListener('click', () => {\n    savedSubmissionsPanel.style.display = 'none';\n    showSubmissionsBtn.textContent = 'Show Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n  });\n\n  // Date filter change event\n  dateFilterInput.addEventListener('change', renderSavedSubmissions);\n\n  // Search input change (debounced)\n  let searchTimeout = null;\n  searchInput.addEventListener('input', () => {\n    clearTimeout(searchTimeout);\n    searchTimeout = setTimeout(() => {\n      renderSavedSubmissions();\n    }, 250);\n  });\n\n  // QR Scanner setup and functions\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.dispatchEvent(new Event('input'));\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically for QR scan decoding (CDN)\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n  // Initial load for MRN in URL\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        180,
        1520
      ],
      "id": "888e659d-bd20-431d-b067-7f610cff7358",
      "name": "Code7"
    },
    {
      "parameters": {
        "operation": "select",
        "schema": {
          "__rl": true,
          "mode": "list",
          "value": "public"
        },
        "table": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1220,
        1020
      ],
      "id": "9f237761-79cc-48ac-b883-9ee76fb9601e",
      "name": "Select rows from a table",
      "credentials": {
        "postgres": {
          "id": "Md3ylGCmGeGDxwFZ",
          "name": "POC_FAST_TRACK"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n      user-select:none;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    #show-submissions-btn {\n      background: linear-gradient(135deg, #ffa500, #cc8400);\n      width: auto;\n      padding: 10px 16px;\n      font-size: 1rem;\n      border-radius: 12px;\n      box-shadow: 0 4px 10px rgba(255,165,0, 0.5);\n      transition: background 0.3s, transform 0.15s;\n      margin-left: auto;\n      user-select:none;\n    }\n    #show-submissions-btn:hover {\n      background: linear-gradient(135deg, #cc8400, #aa6a00);\n      transform: translateY(-2px);\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n    }\n    video, #qr-video {\n      width: 100%;\n      border-radius: 16px;\n      background: black;\n    }\n    #capture-btns {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #capture-btns button {\n      flex-grow: 1;\n      margin: 0 6px;\n    }\n    #captured-photo {\n      width: 100%;\n      margin-top: 12px;\n      border-radius: 16px;\n      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n    }\n    .hidden {\n      display: none;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 0 auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for details */\n    #modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 110000;\n    }\n    #modal-detail-content {\n      max-height: 80vh;\n      overflow-y: auto;\n      font-size: 1rem;\n      color: #1a1a1a;\n      line-height: 1.4;\n      background: white;\n      border-radius: 14px;\n      padding: 16px 24px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      width: 90vw;\n      max-width: 480px;\n      box-sizing: border-box;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n    }\n    #modal-detail-content dt {\n      font-weight: 700;\n      margin-top: 1em;\n    }\n    #modal-detail-content dd {\n      margin-left: 1em;\n      margin-bottom: 0.5em;\n      word-break: break-word;\n    }\n    #modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 110001;\n      transition: background 0.3s;\n    }\n    #modal-close-btn:hover {\n      background: #d72950;\n    }\n    #modal-retry-btn {\n      align-self: flex-start;\n      background: #b00020;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      padding: 8px 16px;\n      font-size: 1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 6px rgba(176,0,32,0.8);\n      transition: background 0.3s;\n      user-select:none;\n      margin-top: 8px;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n    #modal-retry-btn:hover:not(:disabled) {\n      background: #7a000f;\n    }\n    #modal-retry-btn:disabled {\n      background: #999999cc;\n      cursor: not-allowed;\n      box-shadow: none;\n    }\n    /* QR Scanner Overlay */\n    #qr-scanner-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.9);\n      display: none;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      z-index: 10000;\n    }\n    #qr-video {\n      border-radius: 14px;\n      width: 90vw;\n      max-width: 400px;\n      height: auto;\n    }\n    #qr-instruction {\n      color: white;\n      margin-top: 12px;\n      font-size: 1.1rem;\n    }\n    #qr-cancel-btn {\n      margin-top: 20px;\n      padding: 12px 24px;\n      border-radius: 12px;\n      border: none;\n      background: #ff385c;\n      color: white;\n      font-size: 1.1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n    }\n    #qr-cancel-btn:hover {\n      background: #d72950;\n    }\n    /* Saved Submissions Panel */\n    #saved-submissions-panel {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: #fff8e1;\n      border: 2px solid #fcbf49;\n      padding: 16px;\n      box-sizing: border-box;\n      display: none;\n      flex-direction: column;\n      user-select:none;\n      z-index: 100000;\n    }\n    #saved-submissions-panel h2 {\n      margin-bottom: 8px;\n      font-weight: 700;\n      color: #cf8f00;\n      font-size: 1.8rem;\n      text-align: center;\n    }\n    #saved-submissions-close {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 28px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n      user-select:none;\n      z-index: 100001;\n    }\n    #saved-submissions-close:hover {\n      background: #d72950;\n    }\n    #pagination-controls {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin: 12px 0;\n      gap: 8px;\n      flex-wrap: wrap;\n    }\n    #pagination-controls label {\n      font-weight: 700;\n      font-size: 1.1rem;\n      color: #996700;\n    }\n    #pagination-controls input[type=date], #pagination-controls input[type=search] {\n      padding: 8px 10px;\n      font-size: 1.1rem;\n      border-radius: 8px;\n      border: 1.5px solid #fcbf49;\n      width: 180px;\n      max-width: 45vw;\n      box-sizing: border-box;\n    }\n    #saved-submissions-table-wrapper {\n      /* Wrapper to enable overflow and fix header */\n      width: 100%;\n      overflow-x: auto;\n    }\n    #saved-submissions-table {\n      border-collapse: collapse;\n      width: 100%;\n      min-width: 400px;\n    }\n    #saved-submissions-table thead th {\n      background-color: #fde6a3;\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      font-weight: 700;\n      text-align: center;\n      white-space: nowrap;\n      position: sticky;\n      top: 0;\n      z-index: 2;\n      min-width: 90px;\n    }\n    #saved-submissions-table tbody tr {\n      cursor: pointer;\n      transition: background-color 0.2s;\n    }\n    #saved-submissions-table tbody tr:hover {\n      background-color: #fffae6;\n    }\n    #saved-submissions-table tbody td {\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      text-align: center;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      min-width: 90px;\n    }\n\n    .status-pending {\n      color: #d18e00;\n      font-weight: 700;\n    }\n    .status-success {\n      color: #2b7a0b;\n      font-weight: 700;\n    }\n    .status-failed {\n      color: #b00020;\n      font-weight: 700;\n    }\n    .thumbnail-img {\n      max-width: 80px;\n      max-height: 60px;\n      border-radius: 8px;\n      object-fit: contain;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <div style=\"display:flex; align-items:center; gap:8px;\">\n        <button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n      </div>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n        <div id=\"capture-btns\">\n          <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n          <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n        </div>\n\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n          <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n          <button id=\"photo-ok-btn\" aria-label=\"Submit this photo\">Submit</button>\n        </div>\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n\n      <!-- Saved Submissions Panel -->\n      <section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n        <h2>Saved Submissions</h2>\n        <button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n        <div id=\"pagination-controls\">\n          <label for=\"date-filter-input\">Select Date:</label>\n          <input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n          <label for=\"search-input\">Search:</label>\n          <input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n        </div>\n        <div id=\"saved-submissions-table-wrapper\">\n          <table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n            <thead>\n              <tr>\n                <th>MRN</th>\n                <th>POC</th>\n                <th>Date</th>\n                <th>Status</th>\n              </tr>\n            </thead>\n            <tbody id=\"saved-submissions-body\" tabindex=\"0\">\n              <!-- Entries dynamically inserted -->\n            </tbody>\n          </table>\n        </div>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for showing all info from clicked row -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n    <button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n    <div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n      <!-- Populated dynamically -->\n    </div>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalDetailContent = document.getElementById('modal-detail-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // Saved submissions elements\n  const showSubmissionsBtn = document.getElementById('show-submissions-btn');\n  const savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\n  const savedSubmissionsBody = document.getElementById('saved-submissions-body');\n  const dateFilterInput = document.getElementById('date-filter-input');\n  const searchInput = document.getElementById('search-input');\n  const savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null;\n  let qrStream = null;\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n  let submitting = false; // Track submission loading state\n  let currentModalSubmission = null; // Tracking submission in modal for retry\n\n  // Storage key\n  const STORAGE_KEY = 'patientDeviceSubmissions';\n\n  // --- Helper Functions ---\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.innerHTML = '<div class=\"loader\" aria-label=\"Loading\"></div>';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // Date format helpers\n  function formatDateTime(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n  }\n  function formatDate(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${dt.getFullYear()}-\\${pad(dt.getMonth()+1)}-\\${pad(dt.getDate())}\\`;\n  }\n\n  // Fetch patient info\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Patient info fetch failed: \\${res.status}\\`);\n      const json = await res.json();\n      let patientName = '';\n      if(typeof json === 'object' && json !== null){\n        patientName = json.patientName || json.name || '';\n      }\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  // Load devices\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let json = await res.json();\n      if(!Array.isArray(json)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      currentDevices = json;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // Render device cards\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    devices.forEach(device => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n        startCamera();\n      };\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', e => {\n        if(e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  // Camera functions\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  // LocalStorage helpers\n  function loadSavedSubmissions() {\n    try {\n      const dataStr = localStorage.getItem(STORAGE_KEY);\n      if(!dataStr) return [];\n      return JSON.parse(dataStr);\n    } catch(e){\n      console.warn('Failed to parse saved submissions in localStorage', e);\n      return [];\n    }\n  }\n  function saveSubmissions(submissions) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n    } catch(e){\n      console.warn('Failed to save submissions to localStorage', e);\n    }\n  }\n  function addSubmissionRecord(record) {\n    const submissions = loadSavedSubmissions();\n    submissions.push(record);\n    saveSubmissions(submissions);\n  }\n  function updateSubmissionStatus(id, newStatus) {\n    const submissions = loadSavedSubmissions();\n    const idx = submissions.findIndex(s => s.id === id);\n    if(idx !== -1){\n      submissions[idx].status = newStatus;\n      saveSubmissions(submissions);\n    }\n    renderSavedSubmissions();\n  }\n\n  // Filter submissions by date & search\n  function filterSubmissions(submissions, dateStr, searchTerm){\n    let filtered = submissions;\n    if(dateStr){\n      filtered = filtered.filter(s => {\n        let dt = new Date(s.timestamp);\n        let yyyy = dt.getFullYear().toString();\n        let mm = (dt.getMonth()+1).toString().padStart(2,'0');\n        let dd = dt.getDate().toString().padStart(2,'0');\n        return \\`\\${yyyy}-\\${mm}-\\${dd}\\` === dateStr;\n      });\n    }\n    if(searchTerm){\n      searchTerm = searchTerm.toLowerCase();\n      filtered = filtered.filter(s => {\n        if(s.mrn.toLowerCase().includes(searchTerm)) return true;\n        try {\n          const device = JSON.parse(s.device);\n          if(device.POCEquipment && device.POCEquipment.toLowerCase().includes(searchTerm)) return true;\n        } catch{}\n        return false;\n      });\n    }\n    return filtered;\n  }\n\n  // Render submissions in table\n  function renderSavedSubmissions() {\n    clearChildren(savedSubmissionsBody);\n    let submissions = loadSavedSubmissions();\n    submissions.sort((a,b) => b.timestamp - a.timestamp);\n\n    if(submissions.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No saved submissions yet.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n    const dateVal = dateFilterInput.value;\n    const searchVal = searchInput.value.trim();\n    const filteredSubs = filterSubmissions(submissions, dateVal, searchVal);\n    if(filteredSubs.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No submissions match your filter.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n    for(const sub of filteredSubs){\n      const tr = document.createElement('tr');\n\n      const mrnTd = document.createElement('td');\n      mrnTd.textContent = sub.mrn || '';\n      tr.appendChild(mrnTd);\n\n      const pocTd = document.createElement('td');\n      try {\n        const device = JSON.parse(sub.device);\n        pocTd.textContent = device.POCEquipment || '';\n      } catch {\n        pocTd.textContent = '';\n      }\n      tr.appendChild(pocTd);\n\n      const dateTd = document.createElement('td');\n      const dt = new Date(sub.timestamp);\n      const pad = (n) => n.toString().padStart(2,'0');\n      dateTd.textContent = \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()}\\`;\n      tr.appendChild(dateTd);\n\n      const statusTd = document.createElement('td');\n      statusTd.textContent = sub.status;\n      statusTd.classList.add(\n        sub.status === 'Pending' ? 'status-pending' :\n        sub.status === 'Success' ? 'status-success' :\n        'status-failed'\n      );\n      tr.appendChild(statusTd);\n\n      tr.tabIndex = 0;\n      tr.style.cursor = 'pointer';\n\n      tr.addEventListener('click', () => showSubmissionModal(sub));\n      tr.addEventListener('keydown', e => {\n        if(e.key === 'Enter' || e.key === ' '){\n          e.preventDefault();\n          showSubmissionModal(sub);\n        }\n      });\n\n      savedSubmissionsBody.appendChild(tr);\n    }\n  }\n\n  // Show modal with submission details + retry button if failed\n  function showSubmissionModal(sub) {\n    clearChildren(modalDetailContent);\n    currentModalSubmission = sub;\n\n    const container = document.createElement('dl');\n\n    const dtMrn = document.createElement('dt');\n    dtMrn.textContent = 'MRN';\n    const ddMrn = document.createElement('dd');\n    ddMrn.textContent = sub.mrn || '';\n    container.appendChild(dtMrn);\n    container.appendChild(ddMrn);\n\n    const dtDevice = document.createElement('dt');\n    dtDevice.textContent = 'Device';\n    const ddDevice = document.createElement('dd');\n    try {\n      const deviceObj = JSON.parse(sub.device);\n      ddDevice.textContent = deviceObj.POCEquipment || 'N/A';\n    } catch {\n      ddDevice.textContent = 'N/A';\n    }\n    container.appendChild(dtDevice);\n    container.appendChild(ddDevice);\n\n    if(sub.photoDataUrl){\n      const dtPhoto = document.createElement('dt');\n      dtPhoto.textContent = 'Photo';\n      const ddPhoto = document.createElement('dd');\n      const img = document.createElement('img');\n      img.src = sub.photoDataUrl;\n      img.alt = 'Submitted device photo';\n      img.style.maxWidth = '100%';\n      img.style.height = 'auto';\n      img.style.borderRadius = '12px';\n      img.style.boxShadow = '0 0 12px rgba(0,0,0,0.3)';\n      ddPhoto.appendChild(img);\n      container.appendChild(dtPhoto);\n      container.appendChild(ddPhoto);\n    }\n\n    const dtStatus = document.createElement('dt');\n    dtStatus.textContent = 'Status';\n    const ddStatus = document.createElement('dd');\n    ddStatus.textContent = sub.status;\n    ddStatus.classList.add(\n      sub.status === 'Pending' ? 'status-pending' :\n      sub.status === 'Success' ? 'status-success' :\n      'status-failed'\n    );\n    container.appendChild(dtStatus);\n    container.appendChild(ddStatus);\n\n    const dtTimestamp = document.createElement('dt');\n    dtTimestamp.textContent = 'Date/Time Captured';\n    const ddTimestamp = document.createElement('dd');\n    ddTimestamp.textContent = formatDateTime(sub.timestamp);\n    container.appendChild(dtTimestamp);\n    container.appendChild(ddTimestamp);\n\n    modalDetailContent.appendChild(container);\n\n    // Add retry button if failed\n    if(sub.status === 'Failed') {\n      const retryBtn = document.createElement('button');\n      retryBtn.id = 'modal-retry-btn';\n      retryBtn.setAttribute('aria-label', 'Retry failed submission upload');\n      retryBtn.textContent = 'Retry Upload';\n      modalDetailContent.appendChild(retryBtn);\n\n      retryBtn.addEventListener('click', async () => {\n        if(submitting) return;\n        submitting = true;\n        retryBtn.disabled = true;\n        retryBtn.innerHTML = '<div class=\"loader\" aria-label=\"Uploading\"></div> Uploading...';\n\n        try {\n          await retrySubmission(sub);\n          // After retry, refresh modal to update status and possibly hide button\n          modalDetailContent.removeChild(retryBtn);\n          clearChildren(modalDetailContent);\n          showSubmissionModal(loadSavedSubmissions().find(s => s.id === sub.id) || sub);\n          renderSavedSubmissions();\n        } catch (err) {\n          alert('Retry failed: ' + err.message);\n          retryBtn.disabled = false;\n          retryBtn.textContent = 'Retry Upload';\n        }\n        submitting = false;\n      });\n    }\n\n    modalOverlay.style.display = 'flex';\n    modalOverlay.focus();\n  }\n\n  // Close modal\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    clearChildren(modalDetailContent);\n    currentModalSubmission = null;\n    submitting = false;\n  });\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // Retry failed submission upload logic\n  async function retrySubmission(sub) {\n    updateSubmissionStatus(sub.id, 'Pending');\n    try {\n      const blob = await (await fetch(sub.photoDataUrl)).blob();\n      const formData = new FormData();\n      formData.append('mrn', sub.mrn);\n      formData.append('device', sub.device);\n      formData.append('photo', blob, 'device.jpg');\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      updateSubmissionStatus(sub.id, 'Success');\n      alert('Submission upload succeeded!');\n    } catch(e) {\n      updateSubmissionStatus(sub.id, 'Failed');\n      alert('Submission upload failed: ' + e.message);\n      throw e;\n    }\n  }\n\n  // Upload photo and save record (during photo capture)\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, '');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n      const base64DataUrl = await blobToDataURL(photoBlob);\n      const submissionRecord = {\n        id: Date.now() + '-' + Math.random().toString(36).substr(2,9),\n        mrn: currentMRN,\n        device: JSON.stringify(selectedDevice),\n        photoDataUrl: base64DataUrl,\n        status: 'Pending',\n        timestamp: Date.now()\n      };\n      addSubmissionRecord(submissionRecord);\n      updateDatePickerRange();\n      renderSavedSubmissions();\n\n      // Wait for upload request to complete and update status accordingly\n      \n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n\n      updateSubmissionStatus(submissionRecord.id, 'Success');\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n      // Find submission record with last added ID and mark as Failed\n      const submissions = loadSavedSubmissions();\n      if(submissions.length > 0){\n        // Since we just added this record, it will be last\n        updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n      }\n    }\n    setLoading(photoOkBtn, false, 'Submit');\n  }\n\n  // Convert Blob to base64 string\n  function blobToDataURL(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {resolve(reader.result)};\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // Load Devices and Patient Info button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', e => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Show/Hide Saved Submissions panel\n  showSubmissionsBtn.addEventListener('click', () => {\n    const visible = savedSubmissionsPanel.style.display === 'flex';\n    if(visible){\n      savedSubmissionsPanel.style.display = 'none';\n      showSubmissionsBtn.textContent = 'Show Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n    } else {\n      savedSubmissionsPanel.style.display = 'flex';\n      showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n      updateDatePickerRange();\n      renderSavedSubmissions();\n    }\n  });\n  savedSubmissionsCloseBtn.addEventListener('click', () => {\n    savedSubmissionsPanel.style.display = 'none';\n    showSubmissionsBtn.textContent = 'Show Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n  });\n\n  // Date filter change event\n  dateFilterInput.addEventListener('change', renderSavedSubmissions);\n\n  // Search input change (debounced)\n  let searchTimeout = null;\n  searchInput.addEventListener('input', () => {\n    clearTimeout(searchTimeout);\n    searchTimeout = setTimeout(() => {\n      renderSavedSubmissions();\n    }, 250);\n  });\n\n  // QR Scanner setup and functions\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.dispatchEvent(new Event('input'));\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically for QR scan decoding (CDN)\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n  // Initial load for MRN in URL\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n  // Update date picker min/max based on saved submissions\n  function updateDatePickerRange() {\n    const submissions = loadSavedSubmissions();\n    if(submissions.length === 0){\n      dateFilterInput.min = '';\n      dateFilterInput.max = '';\n      dateFilterInput.value = '';\n      return;\n    }\n    const timestamps = submissions.map(s => s.timestamp);\n    const minDt = new Date(Math.min(...timestamps));\n    const maxDt = new Date(Math.max(...timestamps));\n    const pad = n => n.toString().padStart(2, '0');\n    dateFilterInput.min = \\`\\${minDt.getFullYear()}-\\${pad(minDt.getMonth()+1)}-\\${pad(minDt.getDate())}\\`;\n    dateFilterInput.max = \\`\\${maxDt.getFullYear()}-\\${pad(maxDt.getMonth()+1)}-\\${pad(maxDt.getDate())}\\`;\n    if(!dateFilterInput.value) {\n      dateFilterInput.value = dateFilterInput.max;\n    }\n  }\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        180,
        1680
      ],
      "id": "308f9647-3dac-4372-85bf-fc12d9c64179",
      "name": "Code8"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n      user-select:none;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    #show-submissions-btn {\n      background: linear-gradient(135deg, #ffa500, #cc8400);\n      width: auto;\n      padding: 10px 16px;\n      font-size: 1rem;\n      border-radius: 12px;\n      box-shadow: 0 4px 10px rgba(255,165,0, 0.5);\n      transition: background 0.3s, transform 0.15s;\n      margin-left: auto;\n      user-select:none;\n    }\n    #show-submissions-btn:hover {\n      background: linear-gradient(135deg, #cc8400, #aa6a00);\n      transform: translateY(-2px);\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n    }\n    video, #qr-video {\n      width: 100%;\n      border-radius: 16px;\n      background: black;\n    }\n    #capture-btns {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #capture-btns button {\n      flex-grow: 1;\n      margin: 0 6px;\n    }\n    #captured-photo {\n      width: 100%;\n      margin-top: 12px;\n      border-radius: 16px;\n      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n    }\n    .hidden {\n      display: none;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 0 auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for details */\n    #modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 110000;\n    }\n    #modal-detail-content {\n      max-height: 80vh;\n      overflow-y: auto;\n      font-size: 1rem;\n      color: #1a1a1a;\n      line-height: 1.4;\n      background: white;\n      border-radius: 14px;\n      padding: 16px 24px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      width: 90vw;\n      max-width: 480px;\n      box-sizing: border-box;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n    }\n    #modal-detail-content dt {\n      font-weight: 700;\n      margin-top: 1em;\n    }\n    #modal-detail-content dd {\n      margin-left: 1em;\n      margin-bottom: 0.5em;\n      word-break: break-word;\n    }\n    #modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 110001;\n      transition: background 0.3s;\n    }\n    #modal-close-btn:hover {\n      background: #d72950;\n    }\n    #modal-retry-btn {\n      align-self: flex-start;\n      background: #b00020;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      padding: 8px 16px;\n      font-size: 1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 6px rgba(176,0,32,0.8);\n      transition: background 0.3s;\n      user-select:none;\n      margin-top: 8px;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n    #modal-retry-btn:hover:not(:disabled) {\n      background: #7a000f;\n    }\n    #modal-retry-btn:disabled {\n      background: #999999cc;\n      cursor: not-allowed;\n      box-shadow: none;\n    }\n    /* QR Scanner Overlay */\n    #qr-scanner-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.9);\n      display: none;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n      z-index: 10000;\n    }\n    #qr-video {\n      border-radius: 14px;\n      width: 90vw;\n      max-width: 400px;\n      height: auto;\n    }\n    #qr-instruction {\n      color: white;\n      margin-top: 12px;\n      font-size: 1.1rem;\n    }\n    #qr-cancel-btn {\n      margin-top: 20px;\n      padding: 12px 24px;\n      border-radius: 12px;\n      border: none;\n      background: #ff385c;\n      color: white;\n      font-size: 1.1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n    }\n    #qr-cancel-btn:hover {\n      background: #d72950;\n    }\n    /* Saved Submissions Panel */\n    #saved-submissions-panel {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: #fff8e1;\n      border: 2px solid #fcbf49;\n      padding: 16px;\n      box-sizing: border-box;\n      display: none;\n      flex-direction: column;\n      user-select:none;\n      z-index: 100000;\n    }\n    #saved-submissions-panel h2 {\n      margin-bottom: 8px;\n      font-weight: 700;\n      color: #cf8f00;\n      font-size: 1.8rem;\n      text-align: center;\n    }\n    #saved-submissions-close {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 28px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n      user-select:none;\n      z-index: 100001;\n    }\n    #saved-submissions-close:hover {\n      background: #d72950;\n    }\n    #pagination-controls {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin: 12px 0;\n      gap: 8px;\n      flex-wrap: wrap;\n    }\n    #pagination-controls label {\n      font-weight: 700;\n      font-size: 1.1rem;\n      color: #996700;\n    }\n    #pagination-controls input[type=date], #pagination-controls input[type=search] {\n      padding: 8px 10px;\n      font-size: 1.1rem;\n      border-radius: 8px;\n      border: 1.5px solid #fcbf49;\n      width: 180px;\n      max-width: 45vw;\n      box-sizing: border-box;\n    }\n    #saved-submissions-table-wrapper {\n      /* Wrapper to enable overflow and fix header */\n      width: 100%;\n      overflow-x: auto;\n    }\n    #saved-submissions-table {\n      border-collapse: collapse;\n      width: 100%;\n      min-width: 400px;\n    }\n    #saved-submissions-table thead th {\n      background-color: #fde6a3;\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      font-weight: 700;\n      text-align: center;\n      white-space: nowrap;\n      position: sticky;\n      top: 0;\n      z-index: 2;\n      min-width: 90px;\n    }\n    #saved-submissions-table tbody tr {\n      cursor: pointer;\n      transition: background-color 0.2s;\n    }\n    #saved-submissions-table tbody tr:hover {\n      background-color: #fffae6;\n    }\n    #saved-submissions-table tbody td {\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      text-align: center;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      min-width: 90px;\n    }\n\n    .status-pending {\n      color: #d18e00;\n      font-weight: 700;\n    }\n    .status-success {\n      color: #2b7a0b;\n      font-weight: 700;\n    }\n    .status-failed {\n      color: #b00020;\n      font-weight: 700;\n    }\n    .thumbnail-img {\n      max-width: 80px;\n      max-height: 60px;\n      border-radius: 8px;\n      object-fit: contain;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <div style=\"display:flex; align-items:center; gap:8px;\">\n        <button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n      </div>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n        <div id=\"capture-btns\">\n          <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n          <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n        </div>\n\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n          <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n          <button id=\"photo-ok-btn\" aria-label=\"Submit this photo\">Submit</button>\n        </div>\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n\n      <!-- Saved Submissions Panel -->\n      <section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n        <h2>Saved Submissions</h2>\n        <button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n        <div id=\"pagination-controls\">\n          <label for=\"date-filter-input\">Select Date:</label>\n          <input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n          <label for=\"search-input\">Search:</label>\n          <input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n        </div>\n        <div id=\"saved-submissions-table-wrapper\">\n          <table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n            <thead>\n              <tr>\n                <th>MRN</th>\n                <th>POC</th>\n                <th>Date</th>\n                <th>Status</th>\n              </tr>\n            </thead>\n            <tbody id=\"saved-submissions-body\" tabindex=\"0\">\n              <!-- Entries dynamically inserted -->\n            </tbody>\n          </table>\n        </div>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for showing all info from clicked row -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n    <button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n    <div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n      <!-- Populated dynamically -->\n    </div>\n  </div>\n\n  <!-- QR Scanner Overlay -->\n  <div id=\"qr-scanner-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"QR Code Scanner\">\n    <video id=\"qr-video\" autoplay muted playsinline></video>\n    <div id=\"qr-instruction\">Point camera at the QR code</div>\n    <button id=\"qr-cancel-btn\">Cancel Scan</button>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalDetailContent = document.getElementById('modal-detail-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // Saved submissions elements\n  const showSubmissionsBtn = document.getElementById('show-submissions-btn');\n  const savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\n  const savedSubmissionsBody = document.getElementById('saved-submissions-body');\n  const dateFilterInput = document.getElementById('date-filter-input');\n  const searchInput = document.getElementById('search-input');\n  const savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null;\n  let qrStream = null;\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n  let submitting = false; // Track submission loading state\n  let currentModalSubmission = null; // Tracking submission in modal for retry\n\n  // Storage key\n  const STORAGE_KEY = 'patientDeviceSubmissions';\n\n  // --- Helper Functions ---\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.innerHTML = '<div class=\"loader\" aria-label=\"Loading\"></div>';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // Date format helpers\n  function formatDateTime(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n  }\n  function formatDate(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${dt.getFullYear()}-\\${pad(dt.getMonth()+1)}-\\${pad(dt.getDate())}\\`;\n  }\n\n  // Fetch patient info\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Patient info fetch failed: \\${res.status}\\`);\n      const json = await res.json();\n      let patientName = '';\n      if(typeof json === 'object' && json !== null){\n        patientName = json.patientName || json.name || '';\n      }\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  // Load devices\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let json = await res.json();\n      if(!Array.isArray(json)) {\n        throw new Error('Invalid response format: expected array');\n      }\n      currentDevices = json;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  // Render device cards\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    devices.forEach(device => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n\n        // Reset photo UI state on camera open to show video feed with Cancel and Take Picture only\n        photoBlob = null;\n        capturedPhoto.src = '';\n        capturedPhoto.classList.add('hidden');\n        photoControls.classList.add('hidden');\n        captureBtn.classList.remove('hidden');\n        video.classList.remove('hidden');\n        uploadStatus.textContent = '';\n\n        startCamera();\n      };\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', e => {\n        if(e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  // Camera functions\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n  });\n\n  // Take photo click handler\n  captureBtn.addEventListener('click', takePhoto);\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      // Show Try Again and Submit buttons, hide Take Picture and video\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n      uploadStatus.textContent = '';\n    }, 'image/jpeg', 0.95);\n  }\n\n  // Try again resets UI to original camera feed state\n  photoTryAgainBtn.addEventListener('click', () => {\n    photoBlob = null;\n    capturedPhoto.src = '';\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  // LocalStorage helpers (unchanged)\n  function loadSavedSubmissions() {\n    try {\n      const dataStr = localStorage.getItem(STORAGE_KEY);\n      if(!dataStr) return [];\n      return JSON.parse(dataStr);\n    } catch(e){\n      console.warn('Failed to parse saved submissions in localStorage', e);\n      return [];\n    }\n  }\n  function saveSubmissions(submissions) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n    } catch(e){\n      console.warn('Failed to save submissions to localStorage', e);\n    }\n  }\n  function addSubmissionRecord(record) {\n    const submissions = loadSavedSubmissions();\n    submissions.push(record);\n    saveSubmissions(submissions);\n  }\n  function updateSubmissionStatus(id, newStatus) {\n    const submissions = loadSavedSubmissions();\n    const idx = submissions.findIndex(s => s.id === id);\n    if(idx !== -1){\n      submissions[idx].status = newStatus;\n      saveSubmissions(submissions);\n    }\n    renderSavedSubmissions();\n  }\n\n  // Filter submissions by date & search (unchanged)\n  function filterSubmissions(submissions, dateStr, searchTerm){\n    let filtered = submissions;\n    if(dateStr){\n      filtered = filtered.filter(s => {\n        let dt = new Date(s.timestamp);\n        let yyyy = dt.getFullYear().toString();\n        let mm = (dt.getMonth()+1).toString().padStart(2,'0');\n        let dd = dt.getDate().toString().padStart(2,'0');\n        return \\`\\${yyyy}-\\${mm}-\\${dd}\\` === dateStr;\n      });\n    }\n    if(searchTerm){\n      searchTerm = searchTerm.toLowerCase();\n      filtered = filtered.filter(s => {\n        if(s.mrn.toLowerCase().includes(searchTerm)) return true;\n        try {\n          const device = JSON.parse(s.device);\n          if(device.POCEquipment && device.POCEquipment.toLowerCase().includes(searchTerm)) return true;\n        } catch{}\n        return false;\n      });\n    }\n    return filtered;\n  }\n\n  // Render submissions in table (unchanged)\n  function renderSavedSubmissions() {\n    clearChildren(savedSubmissionsBody);\n    let submissions = loadSavedSubmissions();\n    submissions.sort((a,b) => b.timestamp - a.timestamp);\n\n    if(submissions.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No saved submissions yet.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n    const dateVal = dateFilterInput.value;\n    const searchVal = searchInput.value.trim();\n    const filteredSubs = filterSubmissions(submissions, dateVal, searchVal);\n    if(filteredSubs.length === 0){\n      const tr = document.createElement('tr');\n      const td = document.createElement('td');\n      td.colSpan = 4;\n      td.style.fontStyle = 'italic';\n      td.textContent = 'No submissions match your filter.';\n      tr.appendChild(td);\n      savedSubmissionsBody.appendChild(tr);\n      return;\n    }\n    for(const sub of filteredSubs){\n      const tr = document.createElement('tr');\n\n      const mrnTd = document.createElement('td');\n      mrnTd.textContent = sub.mrn || '';\n      tr.appendChild(mrnTd);\n\n      const pocTd = document.createElement('td');\n      try {\n        const device = JSON.parse(sub.device);\n        pocTd.textContent = device.POCEquipment || '';\n      } catch {\n        pocTd.textContent = '';\n      }\n      tr.appendChild(pocTd);\n\n      const dateTd = document.createElement('td');\n      const dt = new Date(sub.timestamp);\n      const pad = (n) => n.toString().padStart(2,'0');\n      dateTd.textContent = \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()}\\`;\n      tr.appendChild(dateTd);\n\n      const statusTd = document.createElement('td');\n      statusTd.textContent = sub.status;\n      statusTd.classList.add(\n        sub.status === 'Pending' ? 'status-pending' :\n        sub.status === 'Success' ? 'status-success' :\n        'status-failed'\n      );\n      tr.appendChild(statusTd);\n\n      tr.tabIndex = 0;\n      tr.style.cursor = 'pointer';\n\n      tr.addEventListener('click', () => showSubmissionModal(sub));\n      tr.addEventListener('keydown', e => {\n        if(e.key === 'Enter' || e.key === ' '){\n          e.preventDefault();\n          showSubmissionModal(sub);\n        }\n      });\n\n      savedSubmissionsBody.appendChild(tr);\n    }\n  }\n\n  // Show modal with submission details + retry button if failed\n  function showSubmissionModal(sub) {\n    clearChildren(modalDetailContent);\n    currentModalSubmission = sub;\n\n    const container = document.createElement('dl');\n\n    const dtMrn = document.createElement('dt');\n    dtMrn.textContent = 'MRN';\n    const ddMrn = document.createElement('dd');\n    ddMrn.textContent = sub.mrn || '';\n    container.appendChild(dtMrn);\n    container.appendChild(ddMrn);\n\n    const dtDevice = document.createElement('dt');\n    dtDevice.textContent = 'Device';\n    const ddDevice = document.createElement('dd');\n    try {\n      const deviceObj = JSON.parse(sub.device);\n      ddDevice.textContent = deviceObj.POCEquipment || 'N/A';\n    } catch {\n      ddDevice.textContent = 'N/A';\n    }\n    container.appendChild(dtDevice);\n    container.appendChild(ddDevice);\n\n    if(sub.photoDataUrl){\n      const dtPhoto = document.createElement('dt');\n      dtPhoto.textContent = 'Photo';\n      const ddPhoto = document.createElement('dd');\n      const img = document.createElement('img');\n      img.src = sub.photoDataUrl;\n      img.alt = 'Submitted device photo';\n      img.style.maxWidth = '100%';\n      img.style.height = 'auto';\n      img.style.borderRadius = '12px';\n      img.style.boxShadow = '0 0 12px rgba(0,0,0,0.3)';\n      ddPhoto.appendChild(img);\n      container.appendChild(dtPhoto);\n      container.appendChild(ddPhoto);\n    }\n\n    const dtStatus = document.createElement('dt');\n    dtStatus.textContent = 'Status';\n    const ddStatus = document.createElement('dd');\n    ddStatus.textContent = sub.status;\n    ddStatus.classList.add(\n      sub.status === 'Pending' ? 'status-pending' :\n      sub.status === 'Success' ? 'status-success' :\n      'status-failed'\n    );\n    container.appendChild(dtStatus);\n    container.appendChild(ddStatus);\n\n    const dtTimestamp = document.createElement('dt');\n    dtTimestamp.textContent = 'Date/Time Captured';\n    const ddTimestamp = document.createElement('dd');\n    ddTimestamp.textContent = formatDateTime(sub.timestamp);\n    container.appendChild(dtTimestamp);\n    container.appendChild(ddTimestamp);\n\n    modalDetailContent.appendChild(container);\n\n    // Add retry button if failed\n    if(sub.status === 'Failed') {\n      const retryBtn = document.createElement('button');\n      retryBtn.id = 'modal-retry-btn';\n      retryBtn.setAttribute('aria-label', 'Retry failed submission upload');\n      retryBtn.textContent = 'Retry Upload';\n      modalDetailContent.appendChild(retryBtn);\n\n      retryBtn.addEventListener('click', async () => {\n        if(submitting) return;\n        submitting = true;\n        retryBtn.disabled = true;\n        retryBtn.innerHTML = '<div class=\"loader\" aria-label=\"Uploading\"></div> Uploading...';\n\n        try {\n          await retrySubmission(sub);\n          modalDetailContent.removeChild(retryBtn);\n          clearChildren(modalDetailContent);\n          showSubmissionModal(loadSavedSubmissions().find(s => s.id === sub.id) || sub);\n          renderSavedSubmissions();\n        } catch (err) {\n          alert('Retry failed: ' + err.message);\n          retryBtn.disabled = false;\n          retryBtn.textContent = 'Retry Upload';\n        }\n        submitting = false;\n      });\n    }\n\n    modalOverlay.style.display = 'flex';\n    modalOverlay.focus();\n  }\n\n  // Close modal\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    clearChildren(modalDetailContent);\n    currentModalSubmission = null;\n    submitting = false;\n  });\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n\n  // Retry failed submission upload logic (unchanged)\n  async function retrySubmission(sub) {\n    updateSubmissionStatus(sub.id, 'Pending');\n    try {\n      const blob = await (await fetch(sub.photoDataUrl)).blob();\n      const formData = new FormData();\n      formData.append('mrn', sub.mrn);\n      formData.append('device', sub.device);\n      formData.append('photo', blob, 'device.jpg');\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n      updateSubmissionStatus(sub.id, 'Success');\n      alert('Submission upload succeeded!');\n    } catch(e) {\n      updateSubmissionStatus(sub.id, 'Failed');\n      alert('Submission upload failed: ' + e.message);\n      throw e;\n    }\n  }\n\n  // Upload photo and save record (during photo capture)\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, '');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n      const base64DataUrl = await blobToDataURL(photoBlob);\n      const submissionRecord = {\n        id: Date.now() + '-' + Math.random().toString(36).substr(2,9),\n        mrn: currentMRN,\n        device: JSON.stringify(selectedDevice),\n        photoDataUrl: base64DataUrl,\n        status: 'Pending',\n        timestamp: Date.now()\n      };\n      addSubmissionRecord(submissionRecord);\n      updateDatePickerRange();\n      renderSavedSubmissions();\n\n      // Wait for upload request to complete and update status accordingly\n      \n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n\n      updateSubmissionStatus(submissionRecord.id, 'Success');\n\n      // Clear photo UI so next device card click shows video instead of last picture\n      photoBlob = null;\n      capturedPhoto.src = '';\n      capturedPhoto.classList.add('hidden');\n      photoControls.classList.add('hidden');\n      captureBtn.classList.remove('hidden');\n      video.classList.remove('hidden');\n      uploadStatus.textContent = '';\n\n      stopCamera();\n      cameraSection.classList.add('hidden');\n\n      // Close modal if open and reload devices\n      if(modalOverlay.style.display === 'flex') {\n        modalCloseBtn.click();\n      }\n      // Automatically reload devices after submission\n      if(currentMRN){\n        await loadDevices(currentMRN);\n      }\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n      // Find submission record with last added ID and mark as Failed\n      const submissions = loadSavedSubmissions();\n      if(submissions.length > 0){\n        // Since we just added this record, it will be last\n        updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n      }\n    }\n    setLoading(photoOkBtn, false, 'Submit');\n  }\n\n  // Convert Blob to base64 string\n  function blobToDataURL(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => {resolve(reader.result)};\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // Load Devices and Patient Info button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', e => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Show/Hide Saved Submissions panel\n  showSubmissionsBtn.addEventListener('click', () => {\n    const visible = savedSubmissionsPanel.style.display === 'flex';\n    if(visible){\n      savedSubmissionsPanel.style.display = 'none';\n      showSubmissionsBtn.textContent = 'Show Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n    } else {\n      savedSubmissionsPanel.style.display = 'flex';\n      showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n      updateDatePickerRange();\n      renderSavedSubmissions();\n    }\n  });\n  savedSubmissionsCloseBtn.addEventListener('click', () => {\n    savedSubmissionsPanel.style.display = 'none';\n    showSubmissionsBtn.textContent = 'Show Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n  });\n\n  // Date filter change event\n  dateFilterInput.addEventListener('change', renderSavedSubmissions);\n\n  // Search input change (debounced)\n  let searchTimeout = null;\n  searchInput.addEventListener('input', () => {\n    clearTimeout(searchTimeout);\n    searchTimeout = setTimeout(() => {\n      renderSavedSubmissions();\n    }, 250);\n  });\n\n  // QR Scanner setup and functions\n  startQrBtn.addEventListener('click', startQrScanner);\n  qrCancelBtn.addEventListener('click', stopQrScanner);\n\n  async function startQrScanner() {\n    if(qrScanActive) return;\n    qrScanActive = true;\n    qrScannerOverlay.style.display = 'flex';\n    try {\n      qrStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n      qrVideo.srcObject = qrStream;\n      await qrVideo.play();\n      startDecodeLoop();\n    } catch(e) {\n      alert('Could not start camera for QR scanning: ' + e.message);\n      stopQrScanner();\n    }\n  }\n  async function stopQrScanner() {\n    qrScanActive = false;\n    clearInterval(qrDecodeInterval);\n    qrDecodeInterval = null;\n    qrScannerOverlay.style.display = 'none';\n    if(qrStream){\n      qrStream.getTracks().forEach(t => t.stop());\n      qrStream = null;\n    }\n  }\n  function startDecodeLoop(){\n    const canvasElement = document.createElement('canvas');\n    const canvasContext = canvasElement.getContext('2d');\n    qrDecodeInterval = setInterval(() => {\n      if(!qrScanActive) return;\n      if(qrVideo.readyState !== qrVideo.HAVE_ENOUGH_DATA) return;\n      canvasElement.width = qrVideo.videoWidth;\n      canvasElement.height = qrVideo.videoHeight;\n      canvasContext.drawImage(qrVideo, 0, 0, canvasElement.width, canvasElement.height);\n      const imageData = canvasContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n      if(window.jsQR) {\n        const code = window.jsQR(imageData.data, imageData.width, imageData.height, {\n          inversionAttempts: \"dontInvert\",\n        });\n        if(code && code.data){\n          onQrCodeScanned(code.data);\n        }\n      }\n    }, 300);\n  }\n  function onQrCodeScanned(data){\n    if(!qrScanActive) return;\n    stopQrScanner();\n    mrnInput.value = data;\n    mrnInput.dispatchEvent(new Event('input'));\n    mrnInput.focus();\n    loadDevicesBtn.click();\n  }\n\n  // Load jsQR lib dynamically for QR scan decoding (CDN)\n  const jsQRscript = document.createElement('script');\n  jsQRscript.src = 'https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js';\n  jsQRscript.onload = () => {\n    console.log('jsQR library loaded for QR scanning');\n  };\n  jsQRscript.onerror = () => {\n    alert('Failed to load QR scanning library (jsQR). QR scanning disabled.');\n    startQrBtn.disabled = true;\n  };\n  document.head.appendChild(jsQRscript);\n\n  // Initial load for MRN in URL\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n  // Update date picker min/max based on saved submissions\n  function updateDatePickerRange() {\n    const submissions = loadSavedSubmissions();\n    if(submissions.length === 0){\n      dateFilterInput.min = '';\n      dateFilterInput.max = '';\n      dateFilterInput.value = '';\n      return;\n    }\n    const timestamps = submissions.map(s => s.timestamp);\n    const minDt = new Date(Math.min(...timestamps));\n    const maxDt = new Date(Math.max(...timestamps));\n    const pad = n => n.toString().padStart(2, '0');\n    dateFilterInput.min = \\`\\${minDt.getFullYear()}-\\${pad(minDt.getMonth()+1)}-\\${pad(minDt.getDate())}\\`;\n    dateFilterInput.max = \\`\\${maxDt.getFullYear()}-\\${pad(maxDt.getMonth()+1)}-\\${pad(maxDt.getDate())}\\`;\n    if(!dateFilterInput.value) {\n      dateFilterInput.value = dateFilterInput.max;\n    }\n  }\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        1660
      ],
      "id": "7edb712b-5eec-4b61-9e92-7f29fa164a3e",
      "name": "Code9"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n<html lang=\"en\" >\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n  <title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n  <style>\n    /* Reset and base */\n    * {\n      box-sizing: border-box;\n      margin: 0; padding: 0;\n    }\n    html, body {\n      height: 100%;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      background: #f7f9fc;\n      color: #1a1a1a;\n    }\n    #app {\n      max-width: 480px;\n      margin: auto;\n      padding: 16px;\n      display: flex;\n      flex-direction: column;\n      min-height: 100vh;\n    }\n    header {\n      margin-bottom: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n    h1 {\n      font-weight: 700;\n      letter-spacing: 0.08em;\n      font-size: 1.5rem;\n      color: #003366;\n      margin-bottom: 12px;\n      text-align: center;\n    }\n    #patient-info {\n      margin-bottom: 24px;\n      padding: 12px 16px;\n      background: #e7f0fa;\n      border-radius: 12px;\n      box-shadow: inset 0 0 10px #aad4ff88;\n    }\n    #patient-info strong {\n      color: #0077ff;\n      font-size: 1.15rem;\n    }\n    label {\n      font-weight: 600;\n      display: block;\n      margin-bottom: 8px;\n      color: #004bb5;\n    }\n    #mrn-controls {\n      display: flex;\n      gap: 8px;\n      margin-bottom: 12px;\n    }\n    input[type=text] {\n      flex-grow: 1;\n      padding: 12px;\n      font-size: 1.1rem;\n      border: 1.5px solid #ccc;\n      border-radius: 12px;\n      transition: border-color 0.3s;\n      vertical-align: middle;\n    }\n    input[type=text]:focus {\n      border-color: #0077ff;\n      outline: none;\n    }\n    button {\n      cursor: pointer;\n      background: linear-gradient(135deg, #0077ff, #005fcc);\n      color: white;\n      border: none;\n      padding: 14px 0;\n      font-size: 1.2rem;\n      border-radius: 12px;\n      box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n      transition: background 0.3s, transform 0.15s;\n      flex: none;\n      width: 120px;\n      user-select:none;\n    }\n    button:hover:not(:disabled) {\n      background: linear-gradient(135deg, #005fcc, #004bb5);\n      transform: translateY(-2px);\n    }\n    button:disabled, button[aria-disabled='true'] {\n      background: #999999cc;\n      cursor: not-allowed;\n      transform: none;\n      box-shadow: none;\n    }\n    #show-submissions-btn {\n      background: linear-gradient(135deg, #ffa500, #cc8400);\n      width: auto;\n      padding: 10px 16px;\n      font-size: 1rem;\n      border-radius: 12px;\n      box-shadow: 0 4px 10px rgba(255,165,0, 0.5);\n      transition: background 0.3s, transform 0.15s;\n      margin-left: auto;\n      user-select:none;\n    }\n    #show-submissions-btn:hover {\n      background: linear-gradient(135deg, #cc8400, #aa6a00);\n      transform: translateY(-2px);\n    }\n    .cards-container {\n      display: grid;\n      grid-template-columns: 1fr 1fr;\n      gap: 14px;\n      margin-top: 8px;\n      margin-bottom: 24px;\n    }\n    @media (max-width:400px) {\n      .cards-container {\n        grid-template-columns: 1fr;\n      }\n    }\n    .card {\n      background: white;\n      border-radius: 14px;\n      box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n      padding: 16px;\n      cursor: pointer;\n      transition: transform 0.3s ease, box-shadow 0.3s ease;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      text-align: center;\n      user-select: none;\n      border: 2px solid transparent;\n    }\n    .card:hover, .card:focus {\n      box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n      border-color: #0077ff;\n      outline: none;\n      transform: scale(1.05);\n    }\n    .card img {\n      width: 100px;\n      height: 100px;\n      object-fit: contain;\n      margin-bottom: 12px;\n      filter: grayscale(30%);\n      transition: filter 0.3s;\n      border-radius: 12px;\n    }\n    .card:hover img, .card:focus img {\n      filter: none;\n    }\n    .device-name {\n      font-weight: 700;\n      font-size: 1.15rem;\n      margin-bottom: 6px;\n      color: #004bb5;\n    }\n    .device-desc {\n      font-size: 0.9rem;\n      color: #555;\n    }\n    #camera-section {\n      margin-top: auto;\n      margin-bottom: 24px;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      gap: 12px;\n    }\n    #video {\n      width: 100%;\n      max-width: 480px;\n      height: 320px;\n      background: black;\n      border-radius: 16px;\n      object-fit: cover;\n      position: relative;\n    }\n    #capture-btn {\n      position: absolute;\n      bottom: 16px;\n      left: 50%;\n      transform: translateX(-50%);\n      width: 64px;\n      height: 64px;\n      border-radius: 50%;\n      border: 4px solid white;\n      background: rgba(0, 119, 255, 0.8);\n      box-shadow: 0 2px 6px rgba(0, 119, 255, 0.9);\n      font-size: 0;\n      cursor: pointer;\n      transition: background 0.3s, box-shadow 0.3s;\n      user-select: none;\n      z-index: 10;\n    }\n    #capture-btn:hover:not(:disabled) {\n      background: rgba(0, 119, 255, 1);\n      box-shadow: 0 4px 10px rgba(0, 119, 255, 1);\n    }\n    #capture-btn:focus {\n      outline: 2px solid #004bb5;\n      outline-offset: 2px;\n    }\n    #cancel-capture-btn {\n      width: 120px;\n      margin-top: 8px;\n    }\n    #canvas {\n      display: none;\n    }\n    #captured-photo {\n      display: none;\n    }\n    .hidden {\n      display: none !important;\n    }\n    /* Loader */\n    .loader {\n      border: 5px solid #f3f3f3;\n      border-top: 5px solid #0077ff;\n      border-radius: 50%;\n      width: 36px;\n      height: 36px;\n      animation: spin 1.1s linear infinite;\n      margin: 0 auto;\n    }\n    @keyframes spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    /* Modal for details */\n    #modal-overlay, #photo-modal-overlay {\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.5);\n      backdrop-filter: blur(4px);\n      display: none;\n      align-items: center;\n      justify-content: center;\n      z-index: 110000;\n    }\n    #modal-detail-content, #photo-modal-content {\n      max-height: 80vh;\n      overflow-y: auto;\n      font-size: 1rem;\n      color: #1a1a1a;\n      line-height: 1.4;\n      background: white;\n      border-radius: 14px;\n      padding: 16px 24px;\n      box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n      width: 90vw;\n      max-width: 480px;\n      box-sizing: border-box;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      gap: 12px;\n    }\n    #modal-close-btn, #photo-modal-close-btn {\n      position: fixed;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 24px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      z-index: 110001;\n      transition: background 0.3s;\n      user-select:none;\n    }\n    #modal-close-btn:hover, #photo-modal-close-btn:hover {\n      background: #d72950;\n    }\n    #modal-retry-btn {\n      align-self: flex-start;\n      background: #b00020;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      padding: 8px 16px;\n      font-size: 1rem;\n      cursor: pointer;\n      box-shadow: 0 2px 6px rgba(176,0,32,0.8);\n      transition: background 0.3s;\n      user-select:none;\n      margin-top: 8px;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    }\n    #modal-retry-btn:hover:not(:disabled) {\n      background: #7a000f;\n    }\n    #modal-retry-btn:disabled {\n      background: #999999cc;\n      cursor: not-allowed;\n      box-shadow: none;\n    }\n    #photo-modal-buttons {\n      display: flex;\n      justify-content: space-around;\n      margin-top: 12px;\n    }\n    #photo-modal-buttons button {\n      flex: 1;\n      max-width: 140px;\n      padding: 10px;\n      font-size: 1.1rem;\n      border-radius: 12px;\n      border: none;\n      cursor: pointer;\n      user-select:none;\n      transition: background 0.3s;\n    }\n    #photo-tryagain-btn {\n      background: #b00020;\n      color: white;\n      margin-right: 12px;\n    }\n    #photo-tryagain-btn:hover:not(:disabled) {\n      background: #7a000f;\n    }\n    #photo-ok-btn {\n      background: #0077ff;\n      color: white;\n    }\n    #photo-ok-btn:hover:not(:disabled) {\n      background: #005fcc;\n    }\n    #upload-status {\n      margin-top: 12px;\n      min-height: 18px;\n      color: #0077ff;\n      font-weight: 600;\n      text-align: center;\n    }\n    /* Saved Submissions Panel */\n    #saved-submissions-panel {\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100vw;\n      height: 100vh;\n      background: #fff8e1;\n      border: 2px solid #fcbf49;\n      padding: 16px;\n      box-sizing: border-box;\n      display: none;\n      flex-direction: column;\n      user-select:none;\n      z-index: 100000;\n    }\n    #saved-submissions-panel h2 {\n      margin-bottom: 8px;\n      font-weight: 700;\n      color: #cf8f00;\n      font-size: 1.8rem;\n      text-align: center;\n    }\n    #saved-submissions-close {\n      position: absolute;\n      top: 12px;\n      right: 12px;\n      background: #ff385c;\n      border: none;\n      border-radius: 100px;\n      width: 40px;\n      height: 40px;\n      color: white;\n      font-size: 28px;\n      line-height: 40px;\n      text-align: center;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n      transition: background 0.3s;\n      user-select:none;\n      z-index: 100001;\n    }\n    #saved-submissions-close:hover {\n      background: #d72950;\n    }\n    #pagination-controls {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin: 12px 0;\n      gap: 8px;\n      flex-wrap: wrap;\n    }\n    #pagination-controls label {\n      font-weight: 700;\n      font-size: 1.1rem;\n      color: #996700;\n    }\n    #pagination-controls input[type=date], #pagination-controls input[type=search] {\n      padding: 8px 10px;\n      font-size: 1.1rem;\n      border-radius: 8px;\n      border: 1.5px solid #fcbf49;\n      width: 180px;\n      max-width: 45vw;\n      box-sizing: border-box;\n    }\n    #saved-submissions-table-wrapper {\n      /* Wrapper to enable overflow and fix header */\n      width: 100%;\n      overflow-x: auto;\n    }\n    #saved-submissions-table {\n      border-collapse: collapse;\n      width: 100%;\n      min-width: 400px;\n    }\n    #saved-submissions-table thead th {\n      background-color: #fde6a3;\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      font-weight: 700;\n      text-align: center;\n      white-space: nowrap;\n      position: sticky;\n      top: 0;\n      z-index: 2;\n      min-width: 90px;\n    }\n    #saved-submissions-table tbody tr {\n      cursor: pointer;\n      transition: background-color 0.2s;\n    }\n    #saved-submissions-table tbody tr:hover {\n      background-color: #fffae6;\n    }\n    #saved-submissions-table tbody td {\n      border: 1px solid #f0c96e;\n      padding: 8px 10px;\n      font-size: 1rem;\n      text-align: center;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      min-width: 90px;\n    }\n\n    .status-pending {\n      color: #d18e00;\n      font-weight: 700;\n    }\n    .status-success {\n      color: #2b7a0b;\n      font-weight: 700;\n    }\n    .status-failed {\n      color: #b00020;\n      font-weight: 700;\n    }\n    .thumbnail-img {\n      max-width: 80px;\n      max-height: 60px;\n      border-radius: 8px;\n      object-fit: contain;\n    }\n  </style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n    <header>\n      <h1>Patient Device Capture</h1>\n      <div style=\"display:flex; align-items:center; gap:8px;\">\n        <button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n      </div>\n      <section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n        <div><strong id=\"patient-name\"></strong></div>\n        <div>MRN: <span id=\"patient-mrn\"></span></div>\n      </section>\n      <section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n        <label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n        <div id=\"mrn-controls\">\n          <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n          <button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n        </div>\n        <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n        <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n      </section>\n    </header>\n\n    <main style=\"flex-grow:1;\">\n      <section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n        <h2>Available Devices</h2>\n        <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n          <!-- Device cards inserted dynamically -->\n        </div>\n      </section>\n\n      <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n        <h2>Capture Device Photo</h2>\n        <div style=\"position: relative; width: 100%; max-width: 480px;\">\n          <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n          <button id=\"capture-btn\" aria-label=\"Take picture\" title=\"Take Picture\"></button>\n        </div>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\" style=\"margin-top:8px;\">Cancel</button>\n        <canvas id=\"canvas\" class=\"hidden\"></canvas>\n        <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n        <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n      </section>\n\n      <!-- Saved Submissions Panel -->\n      <section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n        <h2>Saved Submissions</h2>\n        <button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n        <div id=\"pagination-controls\">\n          <label for=\"date-filter-input\">Select Date:</label>\n          <input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n          <label for=\"search-input\">Search:</label>\n          <input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n        </div>\n        <div id=\"saved-submissions-table-wrapper\">\n          <table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n            <thead>\n              <tr>\n                <th>MRN</th>\n                <th>POC</th>\n                <th>Date</th>\n                <th>Status</th>\n              </tr>\n            </thead>\n            <tbody id=\"saved-submissions-body\" tabindex=\"0\">\n              <!-- Entries dynamically inserted -->\n            </tbody>\n          </table>\n        </div>\n      </section>\n    </main>\n  </div>\n\n  <!-- Modal for showing submission details -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n    <button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n    <div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n      <!-- Populated dynamically -->\n    </div>\n  </div>\n\n  <!-- Modal to show captured photo and Try Again/Submit buttons -->\n  <div id=\"photo-modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Captured Photo Preview\" tabindex=\"-1\">\n    <div id=\"photo-modal-content\" tabindex=\"0\">\n      <button id=\"photo-modal-close-btn\" aria-label=\"Close photo preview\">×</button>\n      <img id=\"photo-modal-img\" alt=\"Captured photo preview\" style=\"max-width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.25);\" />\n      <div id=\"photo-modal-buttons\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Submit this photo\">Submit</button>\n      </div>\n      <div id=\"upload-status\"></div>\n    </div>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n\n  // Elements\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const startQrBtn = document.getElementById('start-qr-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const patientInfoSection = document.getElementById('patient-info');\n  const patientNameElem = document.getElementById('patient-name');\n  const patientMrnElem = document.getElementById('patient-mrn');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n\n  // Photo modal elements\n  const photoModalOverlay = document.getElementById('photo-modal-overlay');\n  const photoModalContent = document.getElementById('photo-modal-content');\n  const photoModalImg = document.getElementById('photo-modal-img');\n  const photoModalCloseBtn = document.getElementById('photo-modal-close-btn');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = photoModalContent.querySelector('#upload-status');\n\n  // Modal elements for submissions\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalDetailContent = document.getElementById('modal-detail-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  // QR scanner elements\n  const qrScannerOverlay = document.getElementById('qr-scanner-overlay');\n  const qrVideo = document.getElementById('qr-video');\n  const qrCancelBtn = document.getElementById('qr-cancel-btn');\n\n  // Saved submissions elements\n  const showSubmissionsBtn = document.getElementById('show-submissions-btn');\n  const savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\n  const savedSubmissionsBody = document.getElementById('saved-submissions-body');\n  const dateFilterInput = document.getElementById('date-filter-input');\n  const searchInput = document.getElementById('search-input');\n  const savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n  // State\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let cameraStream = null;\n  let photoBlob = null;\n  let qrScanActive = false;\n  let qrDecodeInterval = null;\n  let submitting = false;\n  let currentModalSubmission = null;\n\n  const STORAGE_KEY = 'patientDeviceSubmissions';\n\n  // Utility functions\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.innerHTML = '<div class=\"loader\" aria-label=\"Loading\"></div>';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  // Format helpers\n  function formatDateTime(timestamp) {\n    const dt = new Date(timestamp);\n    const pad = (n) => n.toString().padStart(2,'0');\n    return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n  }\n\n  // Fetch patient info\n  async function fetchPatientInfo(mrn) {\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method:'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Failed: \\${res.status}\\`);\n      const json = await res.json();\n      let patientName = '';\n      if(json && typeof json === 'object') {\n        patientName = json.patientName || json.name || '';\n      }\n      if(patientName) {\n        patientNameElem.textContent = patientName;\n        patientMrnElem.textContent = mrn;\n        patientInfoSection.hidden = false;\n      } else {\n        patientInfoSection.hidden = true;\n      }\n    } catch(e) {\n      patientInfoSection.hidden = true;\n      console.warn('Failed to fetch patient info:', e);\n    }\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n      let devices = await res.json();\n      if(!Array.isArray(devices)) throw new Error('Invalid response');\n      currentDevices = devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        devicesSection.hidden = true;\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.hidden = false;\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch(e) {\n      showError('Failed to load devices: ' + e.message);\n      devicesSection.hidden = true;\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    devices.forEach(device => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n      const img = document.createElement('img');\n      img.alt = device.POCEquipment + ' image' || 'Device image';\n      img.src = device.imageurl || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.POCEquipment;\n      card.appendChild(nameEl);\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.Description || '';\n      card.appendChild(descEl);\n      const openCameraForDevice = () => {\n        selectedDevice = device;\n        devicesSection.hidden = true;\n        cameraSection.classList.remove('hidden');\n        cameraSection.focus();\n\n        // Reset state/UI:\n        photoBlob = null;\n        uploadStatus.textContent = '';\n        // Video visible; photo modal hidden initially\n        photoModalOverlay.style.display = 'none';\n\n        startCamera();\n      };\n      card.addEventListener('click', openCameraForDevice);\n      card.addEventListener('keydown', e => {\n        if(e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          openCameraForDevice();\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  async function startCamera() {\n    try {\n      if(cameraStream) stopCamera();\n      cameraStream = await navigator.mediaDevices.getUserMedia({\n        video: { facingMode: 'environment', width: {ideal:1280}, height: {ideal:720} },\n        audio: false\n      });\n      video.srcObject = cameraStream;\n      await video.play();\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n  function stopCamera() {\n    if(cameraStream){\n      cameraStream.getTracks().forEach(t => t.stop());\n      cameraStream = null;\n    }\n  }\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.hidden = false;\n    // Also ensure photo modal is closed if open\n    photoModalOverlay.style.display = 'none';\n  });\n\n  // Capture button overlays video: take photo, then show modal\n  captureBtn.addEventListener('click', takePhoto);\n  function takePhoto() {\n    if(!cameraStream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      photoModalImg.src = url;\n\n      // Show photo modal with Try Again and Submit options\n      photoModalOverlay.style.display = 'flex';\n      photoModalContent.focus();\n    }, 'image/jpeg', 0.95);\n  }\n\n  photoModalCloseBtn.addEventListener('click', () => {\n    photoModalOverlay.style.display = 'none';\n    if(photoModalImg.src) URL.revokeObjectURL(photoModalImg.src); // Cleanup URL\n  });\n\n  photoTryAgainBtn.addEventListener('click', () => {\n    photoModalOverlay.style.display = 'none';\n    if(photoModalImg.src) URL.revokeObjectURL(photoModalImg.src);\n    // Allow retaking photo\n    photoBlob = null;\n    uploadStatus.textContent = '';\n  });\n\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  async function uploadPhoto() {\n    if (!photoBlob || !selectedDevice || !currentMRN) return;\n    setLoading(photoOkBtn, true, '');\n    uploadStatus.textContent = 'Uploading...';\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const base64DataUrl = await blobToDataURL(photoBlob);\n      const submissionRecord = {\n        id: Date.now() + '-' + Math.random().toString(36).substr(2, 9),\n        mrn: currentMRN,\n        device: JSON.stringify(selectedDevice),\n        photoDataUrl: base64DataUrl,\n        status: 'Pending',\n        timestamp: Date.now()\n      };\n      addSubmissionRecord(submissionRecord);\n      updateDatePickerRange();\n      renderSavedSubmissions();\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n\n      updateSubmissionStatus(submissionRecord.id, 'Success');\n\n      // Cleanup modal and photoBlob\n      if(photoModalImg.src) URL.revokeObjectURL(photoModalImg.src);\n      photoBlob = null;\n\n      uploadStatus.textContent = 'Upload successful!';\n      setTimeout(() => {\n        uploadStatus.textContent = '';\n        photoModalOverlay.style.display = 'none';\n        stopCamera();\n        cameraSection.classList.add('hidden');\n        devicesSection.hidden = false;\n\n        // Automatically reload devices after submission\n        loadDevices(currentMRN);\n      }, 1000);\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n      const submissions = loadSavedSubmissions();\n      if(submissions.length > 0){\n        updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n      }\n    }\n    setLoading(photoOkBtn, false, 'Submit');\n  }\n\n  function blobToDataURL(blob) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n    });\n  }\n\n  // LocalStorage helpers (unchanged)\n  function loadSavedSubmissions() {\n    try {\n      const dataStr = localStorage.getItem(STORAGE_KEY);\n      if(!dataStr) return [];\n      return JSON.parse(dataStr);\n    } catch(e){\n      console.warn('Failed to parse saved submissions in localStorage', e);\n      return [];\n    }\n  }\n  function saveSubmissions(submissions) {\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n    } catch(e){\n      console.warn('Failed to save submissions to localStorage', e);\n    }\n  }\n  function addSubmissionRecord(record) {\n    const submissions = loadSavedSubmissions();\n    submissions.push(record);\n    saveSubmissions(submissions);\n  }\n  function updateSubmissionStatus(id, newStatus) {\n    const submissions = loadSavedSubmissions();\n    const idx = submissions.findIndex(s => s.id === id);\n    if(idx !== -1){\n      submissions[idx].status = newStatus;\n      saveSubmissions(submissions);\n    }\n    renderSavedSubmissions();\n  }\n\n  // Other existing functions remain unchanged...\n\n  // Load Devices and Patient Info button handling\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  });\n\n  // Enable Load Devices button only if MRN input has value\n  mrnInput.addEventListener('input', () => {\n    loadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n  });\n\n  mrnInput.addEventListener('keyup', e => {\n    if(e.key === 'Enter' && !loadDevicesBtn.disabled){\n      loadDevicesBtn.click();\n    }\n  });\n\n  // Show/Hide Saved Submissions panel (unchanged)\n  showSubmissionsBtn.addEventListener('click', () => {\n    const visible = savedSubmissionsPanel.style.display === 'flex';\n    if(visible){\n      savedSubmissionsPanel.style.display = 'none';\n      showSubmissionsBtn.textContent = 'Show Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n    } else {\n      savedSubmissionsPanel.style.display = 'flex';\n      showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n      showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n      updateDatePickerRange();\n      renderSavedSubmissions();\n    }\n  });\n\n  savedSubmissionsCloseBtn.addEventListener('click', () => {\n    savedSubmissionsPanel.style.display = 'none';\n    showSubmissionsBtn.textContent = 'Show Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n  });\n\n  // Remaining event listeners ...\n  \n  // Initial load for MRN in URL\n  function getQueryParam(param) {\n    const urlParams = new URLSearchParams(window.location.search);\n    return urlParams.get(param);\n  }\n  async function initialLoad() {\n    const mrnFromUrl = getQueryParam('mrn') || '';\n    if(validateMRN(mrnFromUrl)){\n      mrnInput.value = mrnFromUrl;\n      loadDevicesBtn.disabled = false;\n      currentMRN = mrnFromUrl;\n      await fetchPatientInfo(currentMRN);\n      await loadDevices(currentMRN);\n    }\n  }\n  initialLoad();\n\n  // Update date picker min/max based on saved submissions (unchanged)\n  function updateDatePickerRange() {\n    const submissions = loadSavedSubmissions();\n    if(submissions.length === 0){\n      dateFilterInput.min = '';\n      dateFilterInput.max = '';\n      dateFilterInput.value = '';\n      return;\n    }\n    const timestamps = submissions.map(s => s.timestamp);\n    const minDt = new Date(Math.min(...timestamps));\n    const maxDt = new Date(Math.max(...timestamps));\n    const pad = n => n.toString().padStart(2, '0');\n    dateFilterInput.min = \\`\\${minDt.getFullYear()}-\\${pad(minDt.getMonth()+1)}-\\${pad(minDt.getDate())}\\`;\n    dateFilterInput.max = \\`\\${maxDt.getFullYear()}-\\${pad(maxDt.getMonth()+1)}-\\${pad(maxDt.getDate())}\\`;\n    if(!dateFilterInput.value) {\n      dateFilterInput.value = dateFilterInput.max;\n    }\n  }\n\n  // ... The rest of original code for submissions rendering and QR scanning omitted for brevity,\n  // but you would keep them unchanged from previous updates, only the camera/photo modal parts are changed.\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        1800
      ],
      "id": "2d3858f7-024a-4101-9097-9e684caa3ba8",
      "name": "Code10"
    },
    {
      "parameters": {
        "jsCode": "return [\n{\njson: {\nhtml: `<!DOCTYPE html>\n\n<html lang=\"en\" >\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n<style>\n/* Reset and base */\n* {\nbox-sizing: border-box;\nmargin: 0; padding: 0;\n}\nhtml, body {\nheight: 100%;\nfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\nUbuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\nbackground: #f7f9fc;\ncolor: #1a1a1a;\n}\n#app {\nmax-width: 480px;\nmargin: auto;\npadding: 16px;\ndisplay: flex;\nflex-direction: column;\nmin-height: 100vh;\n}\nheader {\nmargin-bottom: 16px;\ndisplay: flex;\nflex-direction: column;\ngap: 8px;\n}\nh1 {\nfont-weight: 700;\nletter-spacing: 0.08em;\nfont-size: 1.5rem;\ncolor: #003366;\nmargin-bottom: 12px;\ntext-align: center;\n}\n#patient-info {\nmargin-bottom: 24px;\npadding: 12px 16px;\nbackground: #e7f0fa;\nborder-radius: 12px;\nbox-shadow: inset 0 0 10px #aad4ff88;\n}\n#patient-info strong {\ncolor: #0077ff;\nfont-size: 1.15rem;\n}\nlabel {\nfont-weight: 600;\ndisplay: block;\nmargin-bottom: 8px;\ncolor: #004bb5;\n}\n#mrn-controls {\ndisplay: flex;\ngap: 8px;\nmargin-bottom: 12px;\n}\ninput[type=text] {\nflex-grow: 1;\npadding: 12px;\nfont-size: 1.1rem;\nborder: 1.5px solid #ccc;\nborder-radius: 12px;\ntransition: border-color 0.3s;\nvertical-align: middle;\n}\ninput[type=text]:focus {\nborder-color: #0077ff;\noutline: none;\n}\nbutton {\ncursor: pointer;\nbackground: linear-gradient(135deg, #0077ff, #005fcc);\ncolor: white;\nborder: none;\npadding: 14px 0;\nfont-size: 1.2rem;\nborder-radius: 12px;\nbox-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\ntransition: background 0.3s, transform 0.15s;\nflex: none;\nwidth: 120px;\nuser-select:none;\n}\nbutton:hover:not(:disabled) {\nbackground: linear-gradient(135deg, #005fcc, #004bb5);\ntransform: translateY(-2px);\n}\nbutton:disabled, button[aria-disabled='true'] {\nbackground: #999999cc;\ncursor: not-allowed;\ntransform: none;\nbox-shadow: none;\n}\n#show-submissions-btn {\nbackground: linear-gradient(135deg, #ffa500, #cc8400);\nwidth: auto;\npadding: 10px 16px;\nfont-size: 1rem;\nborder-radius: 12px;\nbox-shadow: 0 4px 10px rgba(255,165,0, 0.5);\ntransition: background 0.3s, transform 0.15s;\nmargin-left: auto;\nuser-select:none;\n}\n#show-submissions-btn:hover {\nbackground: linear-gradient(135deg, #cc8400, #aa6a00);\ntransform: translateY(-2px);\n}\n.cards-container {\ndisplay: grid;\ngrid-template-columns: 1fr 1fr;\ngap: 14px;\nmargin-top: 8px;\nmargin-bottom: 24px;\n}\n@media (max-width:400px) {\n.cards-container {\ngrid-template-columns: 1fr;\n}\n}\n.card {\nbackground: white;\nborder-radius: 14px;\nbox-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\npadding: 16px;\ncursor: pointer;\ntransition: transform 0.3s ease, box-shadow 0.3s ease;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\ntext-align: center;\nuser-select: none;\nborder: 2px solid transparent;\n}\n.card:hover, .card:focus {\nbox-shadow: 0 8px 20px rgba(0,120,220, 0.3);\nborder-color: #0077ff;\noutline: none;\ntransform: scale(1.05);\n}\n.card img {\nwidth: 100px;\nheight: 100px;\nobject-fit: contain;\nmargin-bottom: 12px;\nfilter: grayscale(30%);\ntransition: filter 0.3s;\nborder-radius: 12px;\n}\n.card:hover img, .card:focus img {\nfilter: none;\n}\n.device-name {\nfont-weight: 700;\nfont-size: 1.15rem;\nmargin-bottom: 6px;\ncolor: #004bb5;\n}\n.device-desc {\nfont-size: 0.9rem;\ncolor: #555;\n}\n#camera-section {\nmargin-top: auto;\nmargin-bottom: 24px;\nposition: relative;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\ngap: 12px;\n}\n#camera-wrapper {\nposition: relative;\nwidth: 100%;\nmax-width: 320px; /* Reduced width */\nborder-radius: 16px;\noverflow: hidden;\nbox-shadow: 0 4px 12px rgba(0,0,0,0.25);\nbackground: black;\n}\n#video {\nwidth: 100%;\nheight: 240px; /* Reduced height */\nobject-fit: cover;\ndisplay: block;\n}\n#capture-btn {\nposition: absolute;\nbottom: 12px;\nleft: 50%;\ntransform: translateX(-50%);\nwidth: 56px; /* slightly smaller */\nheight: 56px;\nborder-radius: 50%;\nborder: 4px solid white;\nbackground: rgba(0, 119, 255, 0.8);\nbox-shadow: 0 2px 6px rgba(0, 119, 255, 0.9);\nfont-size: 0;\ncursor: pointer;\ntransition: background 0.3s, box-shadow 0.3s;\nuser-select: none;\nz-index: 10;\n}\n#capture-btn:hover:not(:disabled) {\nbackground: rgba(0, 119, 255, 1);\nbox-shadow: 0 4px 10px rgba(0, 119, 255, 1);\n}\n#capture-btn:focus {\noutline: 2px solid #004bb5;\noutline-offset: 2px;\n}\n#cancel-capture-btn {\nmargin-top: 12px;\nalign-self: center;\nwidth: 140px;\n}\n#canvas {\ndisplay: none;\n}\n#captured-photo {\ndisplay: none;\n}\n.hidden {\ndisplay: none !important;\n}\n/* Loader */\n.loader {\nborder: 5px solid #f3f3f3;\nborder-top: 5px solid #0077ff;\nborder-radius: 50%;\nwidth: 36px;\nheight: 36px;\nanimation: spin 1.1s linear infinite;\nmargin: 0 auto;\n}\n@keyframes spin {\n0% { transform: rotate(0deg); }\n100% { transform: rotate(360deg); }\n}\n/* Modal for details */\n#modal-overlay, #photo-modal-overlay {\nposition: fixed;\ninset: 0;\nbackground: rgba(0,0,0,0.5);\nbackdrop-filter: blur(4px);\ndisplay: none;\nalign-items: center;\njustify-content: center;\nz-index: 110000;\n}\n#modal-detail-content, #photo-modal-content {\nmax-height: 80vh;\noverflow-y: auto;\nfont-size: 1rem;\ncolor: #1a1a1a;\nline-height: 1.4;\nbackground: white;\nborder-radius: 14px;\npadding: 16px 24px;\nbox-shadow: 0 8px 28px rgba(0,0,0,0.35);\nwidth: 90vw;\nmax-width: 480px;\nbox-sizing: border-box;\nposition: relative;\ndisplay: flex;\nflex-direction: column;\ngap: 12px;\n}\n#modal-close-btn, #photo-modal-close-btn {\nposition: fixed;\ntop: 12px;\nright: 12px;\nbackground: #ff385c;\nborder: none;\nborder-radius: 100px;\nwidth: 40px;\nheight: 40px;\ncolor: white;\nfont-size: 24px;\nline-height: 40px;\ntext-align: center;\ncursor: pointer;\nbox-shadow: 0 2px 8px rgba(255,56,92,0.6);\nz-index: 110001;\ntransition: background 0.3s;\nuser-select:none;\n}\n#modal-close-btn:hover, #photo-modal-close-btn:hover {\nbackground: #d72950;\n}\n#modal-retry-btn {\nalign-self: flex-start;\nbackground: #b00020;\ncolor: white;\nborder: none;\nborder-radius: 8px;\npadding: 8px 16px;\nfont-size: 1rem;\ncursor: pointer;\nbox-shadow: 0 2px 6px rgba(176,0,32,0.8);\ntransition: background 0.3s;\nuser-select:none;\nmargin-top: 8px;\ndisplay: flex;\nalign-items: center;\ngap: 8px;\n}\n#modal-retry-btn:hover:not(:disabled) {\nbackground: #7a000f;\n}\n#modal-retry-btn:disabled {\nbackground: #999999cc;\ncursor: not-allowed;\nbox-shadow: none;\n}\n#photo-modal-buttons {\ndisplay: flex;\njustify-content: space-around;\nmargin-top: 12px;\n}\n#photo-modal-buttons button {\nflex: 1;\nmax-width: 140px;\npadding: 10px;\nfont-size: 1.1rem;\nborder-radius: 12px;\nborder: none;\ncursor: pointer;\nuser-select:none;\ntransition: background 0.3s;\n}\n#photo-tryagain-btn {\nbackground: #b00020;\ncolor: white;\nmargin-right: 12px;\n}\n#photo-tryagain-btn:hover:not(:disabled) {\nbackground: #7a000f;\n}\n#photo-ok-btn {\nbackground: #0077ff;\ncolor: white;\n}\n#photo-ok-btn:hover:not(:disabled) {\nbackground: #005fcc;\n}\n#upload-status {\nmargin-top: 12px;\nmin-height: 18px;\ncolor: #0077ff;\nfont-weight: 600;\ntext-align: center;\n}\n/* Saved Submissions Panel */\n#saved-submissions-panel {\nposition: fixed;\ntop: 0;\nleft: 0;\nwidth: 100vw;\nheight: 100vh;\nbackground: #fff8e1;\nborder: 2px solid #fcbf49;\npadding: 16px;\nbox-sizing: border-box;\ndisplay: none;\nflex-direction: column;\nuser-select:none;\nz-index: 100000;\n}\n#saved-submissions-panel h2 {\nmargin-bottom: 8px;\nfont-weight: 700;\ncolor: #cf8f00;\nfont-size: 1.8rem;\ntext-align: center;\n}\n#saved-submissions-close {\nposition: absolute;\ntop: 12px;\nright: 12px;\nbackground: #ff385c;\nborder: none;\nborder-radius: 100px;\nwidth: 40px;\nheight: 40px;\ncolor: white;\nfont-size: 28px;\nline-height: 40px;\ntext-align: center;\ncursor: pointer;\nbox-shadow: 0 2px 8px rgba(255,56,92,0.6);\ntransition: background 0.3s;\nuser-select:none;\nz-index: 100001;\n}\n#saved-submissions-close:hover {\nbackground: #d72950;\n}\n#pagination-controls {\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\nmargin: 12px 0;\ngap: 8px;\nflex-wrap: wrap;\n}\n#pagination-controls label {\nfont-weight: 700;\nfont-size: 1.1rem;\ncolor: #996700;\n}\n#pagination-controls input[type=date], #pagination-controls input[type=search] {\npadding: 8px 10px;\nfont-size: 1.1rem;\nborder-radius: 8px;\nborder: 1.5px solid #fcbf49;\nwidth: 180px;\nmax-width: 45vw;\nbox-sizing: border-box;\n}\n#saved-submissions-table-wrapper {\n/* Wrapper to enable overflow and fix header */\nwidth: 100%;\noverflow-x: auto;\n}\n#saved-submissions-table {\nborder-collapse: collapse;\nwidth: 100%;\nmin-width: 400px;\n}\n#saved-submissions-table thead th {\nbackground-color: #fde6a3;\nborder: 1px solid #f0c96e;\npadding: 8px 10px;\nfont-size: 1rem;\nfont-weight: 700;\ntext-align: center;\nwhite-space: nowrap;\nposition: sticky;\ntop: 0;\nz-index: 2;\nmin-width: 90px;\n}\n#saved-submissions-table tbody tr {\ncursor: pointer;\ntransition: background-color 0.2s;\n}\n#saved-submissions-table tbody tr:hover {\nbackground-color: #fffae6;\n}\n#saved-submissions-table tbody td {\nborder: 1px solid #f0c96e;\npadding: 8px 10px;\nfont-size: 1rem;\ntext-align: center;\nwhite-space: nowrap;\noverflow: hidden;\ntext-overflow: ellipsis;\nmin-width: 90px;\n}\n\n.status-pending {\ncolor: #d18e00;\nfont-weight: 700;\n}\n.status-success {\ncolor: #2b7a0b;\nfont-weight: 700;\n}\n.status-failed {\ncolor: #b00020;\nfont-weight: 700;\n}\n.thumbnail-img {\nmax-width: 80px;\nmax-height: 60px;\nborder-radius: 8px;\nobject-fit: contain;\n}\n</style>\n\n</head>\n<body>\n<div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n<header>\n<h1>Patient Device Capture</h1>\n<div style=\"display:flex; align-items:center; gap:8px;\">\n<button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n</div>\n<section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n<div><strong id=\"patient-name\"></strong></div>\n<div>MRN: <span id=\"patient-mrn\"></span></div>\n</section>\n<section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n<label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n<div id=\"mrn-controls\">\n<input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n<button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n</div>\n<button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n<div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n</section>\n</header>\n\n<main style=\"flex-grow:1;\">\n<section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n<h2>Available Devices</h2>\n<div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n<!-- Device cards inserted dynamically -->\n</div>\n</section>\n\n<section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n<h2>Capture Device Photo</h2>\n<div id=\"camera-wrapper\">\n<video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n<button id=\"capture-btn\" aria-label=\"Take picture\" title=\"Take Picture\"></button>\n</div>\n<button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n<canvas id=\"canvas\" class=\"hidden\"></canvas>\n<img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n<div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n</section>\n\n<!-- Saved Submissions Panel -->\n<section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n<h2>Saved Submissions</h2>\n<button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n<div id=\"pagination-controls\">\n<label for=\"date-filter-input\">Select Date:</label>\n<input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n<label for=\"search-input\">Search:</label>\n<input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n</div>\n<div id=\"saved-submissions-table-wrapper\">\n<table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n<thead>\n<tr>\n<th>MRN</th>\n<th>POC</th>\n<th>Date</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody id=\"saved-submissions-body\" tabindex=\"0\">\n<!-- Entries dynamically inserted -->\n</tbody>\n</table>\n</div>\n</section>\n</main> </div>\n\n<!-- Modal for showing submission details -->\n<div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n<button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n<div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n<!-- Populated dynamically -->\n</div>\n</div>\n\n<!-- Modal to show captured photo and Try Again/Submit buttons -->\n<div id=\"photo-modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Captured Photo Preview\" tabindex=\"-1\">\n<div id=\"photo-modal-content\" tabindex=\"0\">\n<button id=\"photo-modal-close-btn\" aria-label=\"Close photo preview\">×</button>\n<img id=\"photo-modal-img\" alt=\"Captured photo preview\" style=\"max-width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.25);\" />\n<div id=\"photo-modal-buttons\">\n<button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n<button id=\"photo-ok-btn\" aria-label=\"Submit this photo\">Submit</button>\n</div>\n<div id=\"upload-status\"></div>\n</div>\n</div>\n\n<script>\n(() => {\n'use strict';\n\n// Elements\nconst mrnInput = document.getElementById('mrn-input');\nconst loadDevicesBtn = document.getElementById('load-devices-btn');\nconst startQrBtn = document.getElementById('start-qr-btn');\nconst mrnError = document.getElementById('mrn-error');\nconst patientInfoSection = document.getElementById('patient-info');\nconst patientNameElem = document.getElementById('patient-name');\nconst patientMrnElem = document.getElementById('patient-mrn');\nconst devicesSection = document.getElementById('devices-section');\nconst devicesContainer = document.getElementById('devices-container');\nconst cameraSection = document.getElementById('camera-section');\nconst cameraWrapper = document.getElementById('camera-wrapper');\nconst video = document.getElementById('video');\nconst canvas = document.getElementById('canvas');\nconst captureBtn = document.getElementById('capture-btn');\nconst cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n\n// Photo modal elements\nconst photoModalOverlay = document.getElementById('photo-modal-overlay');\nconst photoModalContent = document.getElementById('photo-modal-content');\nconst photoModalImg = document.getElementById('photo-modal-img');\nconst photoModalCloseBtn = document.getElementById('photo-modal-close-btn');\nconst photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\nconst photoOkBtn = document.getElementById('photo-ok-btn');\nconst uploadStatus = photoModalContent.querySelector('#upload-status');\n\n// Modal elements for submissions\nconst modalOverlay = document.getElementById('modal-overlay');\nconst modalDetailContent = document.getElementById('modal-detail-content');\nconst modalCloseBtn = document.getElementById('modal-close-btn');\n\n// Saved submissions elements\nconst showSubmissionsBtn = document.getElementById('show-submissions-btn');\nconst savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\nconst savedSubmissionsBody = document.getElementById('saved-submissions-body');\nconst dateFilterInput = document.getElementById('date-filter-input');\nconst searchInput = document.getElementById('search-input');\nconst savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n// State\nlet currentDevices = [];\nlet selectedDevice = null;\nlet currentMRN = '';\nlet cameraStream = null;\nlet photoBlob = null;\nlet submitting = false;\n\nconst STORAGE_KEY = 'patientDeviceSubmissions';\n\n// Utility functions\nfunction clearChildren(el) {\nwhile(el.firstChild) el.removeChild(el.firstChild);\n}\n\nfunction setLoading(btn, isLoading, text) {\nif(isLoading){\nbtn.disabled = true;\nbtn.innerHTML = '<div class=\"loader\" aria-label=\"Loading\"></div>';\n} else {\nbtn.disabled = false;\nbtn.textContent = text;\n}\n}\n\nfunction validateMRN(mrn) {\nreturn mrn.trim().length > 0;\n}\nfunction showError(msg) {\nmrnError.textContent = msg;\n}\nfunction clearError() {\nmrnError.textContent = '';\n}\n\n// Format helpers\nfunction formatDateTime(timestamp) {\nconst dt = new Date(timestamp);\nconst pad = (n) => n.toString().padStart(2,'0');\nreturn \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n}\n\n// Fetch patient info\nasync function fetchPatientInfo(mrn) {\ntry {\nconst res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\nmethod:'POST',\nheaders: {'Content-Type': 'application/json'},\nbody: JSON.stringify({mrn})\n});\nif(!res.ok) throw new Error(\\`Failed: \\${res.status}\\`);\nconst json = await res.json();\nlet patientName = '';\nif(json && typeof json === 'object') {\npatientName = json.patientName || json.name || '';\n}\nif(patientName) {\npatientNameElem.textContent = patientName;\npatientMrnElem.textContent = mrn;\npatientInfoSection.hidden = false;\n} else {\npatientInfoSection.hidden = true;\n}\n} catch(e) {\npatientInfoSection.hidden = true;\nconsole.warn('Failed to fetch patient info:', e);\n}\n}\n\nasync function loadDevices(mrn) {\nsetLoading(loadDevicesBtn, true, '');\nshowError('');\ntry {\nconst res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\nmethod: 'POST',\nheaders: {'Content-Type': 'application/json'},\nbody: JSON.stringify({mrn})\n});\nif(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\nlet devices = await res.json();\nif(!Array.isArray(devices)) throw new Error('Invalid response');\ncurrentDevices = devices;\nif(currentDevices.length === 0) {\nshowError('No devices found for this patient.');\ndevicesSection.hidden = true;\nsetLoading(loadDevicesBtn,false,'Load Devices');\nreturn false;\n}\nrenderDeviceCards(currentDevices);\ndevicesSection.hidden = false;\ndevicesSection.focus();\nsetLoading(loadDevicesBtn,false,'Load Devices');\nreturn true;\n} catch(e) {\nshowError('Failed to load devices: ' + e.message);\ndevicesSection.hidden = true;\nsetLoading(loadDevicesBtn,false,'Load Devices');\nreturn false;\n}\n}\n\nfunction renderDeviceCards(devices) {\nclearChildren(devicesContainer);\nselectedDevice = null;\ndevices.forEach(device => {\nconst card = document.createElement('div');\ncard.classList.add('card');\ncard.role = 'listitem';\ncard.tabIndex = 0;\ncard.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\nconst img = document.createElement('img');\nimg.alt = device.POCEquipment + ' image' || 'Device image';\nimg.src = device.imageurl || '';\nimg.loading = 'lazy';\ncard.appendChild(img);\nconst nameEl = document.createElement('div');\nnameEl.className = 'device-name';\nnameEl.textContent = device.POCEquipment;\ncard.appendChild(nameEl);\nconst descEl = document.createElement('div');\ndescEl.className = 'device-desc';\ndescEl.textContent = device.Description || '';\ncard.appendChild(descEl);\nconst openCameraForDevice = () => {\nselectedDevice = device;\ndevicesSection.hidden = true;\ncameraSection.classList.remove('hidden');\ncameraSection.focus();\n\n// Reset state/UI:\nphotoBlob = null;\nuploadStatus.textContent = '';\n// Hide photo modal initially\nphotoModalOverlay.style.display = 'none';\n\nstartCamera();\n};\ncard.addEventListener('click', openCameraForDevice);\ncard.addEventListener('keydown', e => {\nif(e.key === 'Enter' || e.key === ' ') {\ne.preventDefault();\nopenCameraForDevice();\n}\n});\ndevicesContainer.appendChild(card);\n});\n}\n\nasync function startCamera() {\ntry {\nif(cameraStream) stopCamera();\ncameraStream = await navigator.mediaDevices.getUserMedia({\nvideo: { facingMode: 'environment', width: {ideal:1280}, height: {ideal:720} },\naudio: false\n});\nvideo.srcObject = cameraStream;\nawait video.play();\n} catch(e) {\nalert('Failed to access camera: ' + e.message);\ncancelCaptureBtn.click();\n}\n}\nfunction stopCamera() {\nif(cameraStream){\ncameraStream.getTracks().forEach(t => t.stop());\ncameraStream = null;\n}\n}\n\ncancelCaptureBtn.addEventListener('click', () => {\nstopCamera();\ncameraSection.classList.add('hidden');\ndevicesSection.hidden = false;\nphotoModalOverlay.style.display = 'none';\n});\n\n// Capture button overlays video: take photo, then show modal\ncaptureBtn.addEventListener('click', takePhoto);\nfunction takePhoto() {\nif(!cameraStream) return;\ncanvas.width = video.videoWidth;\ncanvas.height = video.videoHeight;\nconst ctx = canvas.getContext('2d');\nctx.drawImage(video, 0, 0, canvas.width, canvas.height);\ncanvas.toBlob(blob => {\nphotoBlob = blob;\nconst url = URL.createObjectURL(blob);\nphotoModalImg.src = url;\n\n// Show photo modal with Try Again and Submit options\nphotoModalOverlay.style.display = 'flex';\nphotoModalContent.focus();\n}, 'image/jpeg', 0.95);\n}\n\nphotoModalCloseBtn.addEventListener('click', () => {\nphotoModalOverlay.style.display = 'none';\nif(photoModalImg.src) {\nURL.revokeObjectURL(photoModalImg.src);\nphotoModalImg.src = '';\n}\n});\n\nphotoTryAgainBtn.addEventListener('click', () => {\nphotoModalOverlay.style.display = 'none';\nif(photoModalImg.src) {\nURL.revokeObjectURL(photoModalImg.src);\nphotoModalImg.src = '';\n}\n// Allow retaking photo\nphotoBlob = null;\nuploadStatus.textContent = '';\n});\n\nphotoOkBtn.addEventListener('click', uploadPhoto);\n\nasync function uploadPhoto() {\nif (!photoBlob || !selectedDevice || !currentMRN) return;\nsetLoading(photoOkBtn, true, '');\nuploadStatus.textContent = 'Uploading...';\ntry {\nconst formData = new FormData();\nformData.append('mrn', currentMRN);\nformData.append('device', JSON.stringify(selectedDevice));\nformData.append('photo', photoBlob, 'device.jpg');\n\nconst base64DataUrl = await blobToDataURL(photoBlob);\nconst submissionRecord = {\nid: Date.now() + '-' + Math.random().toString(36).substr(2, 9),\nmrn: currentMRN,\ndevice: JSON.stringify(selectedDevice),\nphotoDataUrl: base64DataUrl,\nstatus: 'Pending',\ntimestamp: Date.now()\n};\naddSubmissionRecord(submissionRecord);\nupdateDatePickerRange();\nrenderSavedSubmissions();\n\nconst res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\nmethod: 'POST',\nbody: formData,\n});\nif(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n\nupdateSubmissionStatus(submissionRecord.id, 'Success');\n\n// Cleanup modal and photoBlob\nif(photoModalImg.src) {\nURL.revokeObjectURL(photoModalImg.src);\nphotoModalImg.src = '';\n}\nphotoBlob = null;\n\nuploadStatus.textContent = 'Upload successful!';\nsetTimeout(() => {\nuploadStatus.textContent = '';\nphotoModalOverlay.style.display = 'none';\nstopCamera();\ncameraSection.classList.add('hidden');\ndevicesSection.hidden = false;\n\n// Automatically reload devices after submission\nloadDevices(currentMRN);\n}, 1000);\n} catch(e) {\nuploadStatus.textContent = 'Upload failed: ' + e.message;\nconst submissions = loadSavedSubmissions();\nif(submissions.length > 0){\nupdateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n}\n}\nsetLoading(photoOkBtn, false, 'Submit');\n}\n\nfunction blobToDataURL(blob) {\nreturn new Promise((resolve, reject) => {\nconst reader = new FileReader();\nreader.onloadend = () => resolve(reader.result);\nreader.onerror = reject;\nreader.readAsDataURL(blob);\n});\n}\n\n// LocalStorage helpers\nfunction loadSavedSubmissions() {\ntry {\nconst dataStr = localStorage.getItem(STORAGE_KEY);\nif(!dataStr) return [];\nreturn JSON.parse(dataStr);\n} catch(e){\nconsole.warn('Failed to parse saved submissions in localStorage', e);\nreturn [];\n}\n}\nfunction saveSubmissions(submissions) {\ntry {\nlocalStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n} catch(e){\nconsole.warn('Failed to save submissions to localStorage', e);\n}\n}\nfunction addSubmissionRecord(record) {\nconst submissions = loadSavedSubmissions();\nsubmissions.push(record);\nsaveSubmissions(submissions);\n}\nfunction updateSubmissionStatus(id, newStatus) {\nconst submissions = loadSavedSubmissions();\nconst idx = submissions.findIndex(s => s.id === id);\nif(idx !== -1){\nsubmissions[idx].status = newStatus;\nsaveSubmissions(submissions);\n}\nrenderSavedSubmissions();\n}\n\nfunction renderSavedSubmissions() {\nconst submissions = loadSavedSubmissions();\nlet filtered = submissions;\n\n// Filter by date if set\nif(dateFilterInput.value){\nconst selectedDate = new Date(dateFilterInput.value);\nfiltered = filtered.filter(sub => {\nconst subDate = new Date(sub.timestamp);\nreturn subDate.getFullYear() === selectedDate.getFullYear() &&\nsubDate.getMonth() === selectedDate.getMonth() &&\nsubDate.getDate() === selectedDate.getDate();\n});\n}\n\n// Filter by search input if set\nconst searchTerm = searchInput.value.trim().toLowerCase();\nif(searchTerm) {\nfiltered = filtered.filter(sub => {\nconst deviceObj = JSON.parse(sub.device || '{}');\nreturn sub.mrn.toLowerCase().includes(searchTerm) ||\n(deviceObj.POCEquipment && deviceObj.POCEquipment.toLowerCase().includes(searchTerm));\n});\n}\n\nclearChildren(savedSubmissionsBody);\nif(filtered.length === 0){\nconst tr = document.createElement('tr');\nconst td = document.createElement('td');\ntd.colSpan = 4;\ntd.textContent = 'No submissions found.';\ntd.style.textAlign = 'center';\ntr.appendChild(td);\nsavedSubmissionsBody.appendChild(tr);\nreturn;\n}\nfiltered.forEach(sub => {\nconst tr = document.createElement('tr');\ntr.tabIndex = 0;\ntr.setAttribute('aria-label', \\`Submission for MRN \\${sub.mrn}, Device: \\${(JSON.parse(sub.device).POCEquipment || '')}, Date: \\${formatDateTime(sub.timestamp)}, Status: \\${sub.status}\\`);\nconst tdMrn = document.createElement('td');\ntdMrn.textContent = sub.mrn;\nconst tdDevice = document.createElement('td');\ntry {\nconst deviceObj = JSON.parse(sub.device);\ntdDevice.textContent = deviceObj.POCEquipment || '';\n} catch {\ntdDevice.textContent = '';\n}\nconst tdDate = document.createElement('td');\ntdDate.textContent = formatDateTime(sub.timestamp);\nconst tdStatus = document.createElement('td');\ntdStatus.textContent = sub.status;\ntdStatus.classList.add(sub.status === 'Pending' ? 'status-pending' : sub.status === 'Success' ? 'status-success' : 'status-failed');\ntr.appendChild(tdMrn);\ntr.appendChild(tdDevice);\ntr.appendChild(tdDate);\ntr.appendChild(tdStatus);\nsavedSubmissionsBody.appendChild(tr);\n\ntr.addEventListener('click', () => {\nshowSubmissionDetails(sub);\n});\ntr.addEventListener('keydown', e => {\nif(e.key === 'Enter' || e.key === ' ') {\ne.preventDefault();\nshowSubmissionDetails(sub);\n}\n});\n});\n}\n\nfunction showSubmissionDetails(submission) {\nclearChildren(modalDetailContent);\n\ntry {\nconst deviceObj = JSON.parse(submission.device);\nconst title = document.createElement('h3');\ntitle.textContent = deviceObj.POCEquipment || 'Device';\nmodalDetailContent.appendChild(title);\nif(deviceObj.Description){\nconst desc = document.createElement('p');\ndesc.textContent = deviceObj.Description;\nmodalDetailContent.appendChild(desc);\n}\n} catch {\n// noop\n}\n\nconst mrnP = document.createElement('p');\nmrnP.textContent = 'MRN: ' + submission.mrn;\nmodalDetailContent.appendChild(mrnP);\n\nconst dateP = document.createElement('p');\ndateP.textContent = 'Date: ' + formatDateTime(submission.timestamp);\nmodalDetailContent.appendChild(dateP);\n\nconst statusP = document.createElement('p');\nstatusP.textContent = 'Status: ' + submission.status;\nstatusP.className = submission.status === 'Pending' ? 'status-pending' : submission.status === 'Success' ? 'status-success' : 'status-failed';\nmodalDetailContent.appendChild(statusP);\n\nif(submission.photoDataUrl){\nconst img = document.createElement('img');\nimg.src = submission.photoDataUrl;\nimg.alt = 'Captured photo of device';\nimg.style.maxWidth = '100%';\nimg.style.borderRadius = '14px';\nimg.style.marginTop = '12px';\nmodalDetailContent.appendChild(img);\n}\n\nmodalOverlay.style.display = 'flex';\nmodalDetailContent.focus();\n}\n\nmodalCloseBtn.addEventListener('click', () => {\nmodalOverlay.style.display = 'none';\n});\n\n// Load Devices and Patient Info button handling\nloadDevicesBtn.addEventListener('click', async () => {\nconst mrn = mrnInput.value.trim();\nif(!validateMRN(mrn)) {\nshowError('Please enter a valid MRN.');\nreturn;\n}\nclearError();\ncurrentMRN = mrn;\npatientMrnElem.textContent = currentMRN;\nawait fetchPatientInfo(currentMRN);\nawait loadDevices(currentMRN);\n});\n\n// Enable Load Devices button only if MRN input has value\nmrnInput.addEventListener('input', () => {\nloadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n});\n\nmrnInput.addEventListener('keyup', e => {\nif(e.key === 'Enter' && !loadDevicesBtn.disabled){\nloadDevicesBtn.click();\n}\n});\n\n// Show/Hide Saved Submissions panel\nshowSubmissionsBtn.addEventListener('click', () => {\nconst visible = savedSubmissionsPanel.style.display === 'flex';\nif(visible){\nsavedSubmissionsPanel.style.display = 'none';\nshowSubmissionsBtn.textContent = 'Show Saved Submissions';\nshowSubmissionsBtn.setAttribute('aria-pressed', 'false');\n} else {\nsavedSubmissionsPanel.style.display = 'flex';\nshowSubmissionsBtn.textContent = 'Hide Saved Submissions';\nshowSubmissionsBtn.setAttribute('aria-pressed', 'true');\nupdateDatePickerRange();\nrenderSavedSubmissions();\n}\n});\n\nsavedSubmissionsCloseBtn.addEventListener('click', () => {\nsavedSubmissionsPanel.style.display = 'none';\nshowSubmissionsBtn.textContent = 'Show Saved Submissions';\nshowSubmissionsBtn.setAttribute('aria-pressed', 'false');\n});\n\n// Date filter input updates submission table on change\ndateFilterInput.addEventListener('change', () => {\nrenderSavedSubmissions();\n});\n\n// Search input updates submission table on input\nsearchInput.addEventListener('input', () => {\nrenderSavedSubmissions();\n});\n\n// Initial load for MRN in URL\nfunction getQueryParam(param) {\nconst urlParams = new URLSearchParams(window.location.search);\nreturn urlParams.get(param);\n}\nasync function initialLoad() {\nconst mrnFromUrl = getQueryParam('mrn') || '';\nif(validateMRN(mrnFromUrl)){\nmrnInput.value = mrnFromUrl;\nloadDevicesBtn.disabled = false;\ncurrentMRN = mrnFromUrl;\nawait fetchPatientInfo(currentMRN);\nawait loadDevices(currentMRN);\n}\n}\ninitialLoad();\n\n// Update date picker min/max based on saved submissions and default to today\nfunction updateDatePickerRange() {\nconst submissions = loadSavedSubmissions();\nif(submissions.length === 0){\ndateFilterInput.min = '';\ndateFilterInput.max = '';\ndateFilterInput.value = '';\n// Default to today anyway\nconst today = new Date();\ndateFilterInput.value = today.toISOString().split('T')[0];\nreturn;\n}\nconst timestamps = submissions.map(s => s.timestamp);\nconst minDt = new Date(Math.min(...timestamps));\nconst maxDt = new Date(Math.max(...timestamps));\nconst pad = n => n.toString().padStart(2, '0');\ndateFilterInput.min = \\`\\${minDt.getFullYear()}-\\${pad(minDt.getMonth()+1)}-\\${pad(minDt.getDate())}\\`;\ndateFilterInput.max = \\`\\${maxDt.getFullYear()}-\\${pad(maxDt.getMonth()+1)}-\\${pad(maxDt.getDate())}\\`;\n\n// Default to today's date, but only if not already set or outside range\nconst today = new Date();\nconst todayStr = today.toISOString().split('T')[0];\nif(!dateFilterInput.value || dateFilterInput.value < dateFilterInput.min || dateFilterInput.value > dateFilterInput.max){\ndateFilterInput.value = todayStr;\n}\n}\n\n})();\n</script>\n</body>\n</html>`\n}\n}\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        1940
      ],
      "id": "cf7db065-c8f0-4e99-a1be-fbbaae701adb",
      "name": "Code11"
    },
    {
      "parameters": {
        "jsCode": "return [\n{\njson: {\nhtml: `<!DOCTYPE html>\n\n<html lang=\"en\" >\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n<style>\n/* Reset and base */\n* {\nbox-sizing: border-box;\nmargin: 0; padding: 0;\n}\nhtml, body {\nheight: 100%;\nfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\nUbuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\nbackground: #f7f9fc;\ncolor: #1a1a1a;\n}\n#app {\nmax-width: 480px;\nmargin: auto;\npadding: 16px;\ndisplay: flex;\nflex-direction: column;\nmin-height: 100vh;\n}\nheader {\nmargin-bottom: 16px;\ndisplay: flex;\nflex-direction: column;\ngap: 8px;\n}\nh1 {\nfont-weight: 700;\nletter-spacing: 0.08em;\nfont-size: 1.5rem;\ncolor: #003366;\nmargin-bottom: 12px;\ntext-align: center;\n}\n#patient-info {\nmargin-bottom: 24px;\npadding: 12px 16px;\nbackground: #e7f0fa;\nborder-radius: 12px;\nbox-shadow: inset 0 0 10px #aad4ff88;\n}\n#patient-info strong {\ncolor: #0077ff;\nfont-size: 1.15rem;\n}\nlabel {\nfont-weight: 600;\ndisplay: block;\nmargin-bottom: 8px;\ncolor: #004bb5;\n}\n#mrn-controls {\ndisplay: flex;\ngap: 8px;\nmargin-bottom: 12px;\n}\ninput[type=text] {\nflex-grow: 1;\npadding: 12px;\nfont-size: 1.1rem;\nborder: 1.5px solid #ccc;\nborder-radius: 12px;\ntransition: border-color 0.3s;\nvertical-align: middle;\n}\ninput[type=text]:focus {\nborder-color: #0077ff;\noutline: none;\n}\nbutton {\ncursor: pointer;\nbackground: linear-gradient(135deg, #0077ff, #005fcc);\ncolor: white;\nborder: none;\npadding: 14px 0;\nfont-size: 1.2rem;\nborder-radius: 12px;\nbox-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\ntransition: background 0.3s, transform 0.15s;\nflex: none;\nwidth: 120px;\nuser-select:none;\n}\nbutton:hover:not(:disabled) {\nbackground: linear-gradient(135deg, #005fcc, #004bb5);\ntransform: translateY(-2px);\n}\nbutton:disabled, button[aria-disabled='true'] {\nbackground: #999999cc;\ncursor: not-allowed;\ntransform: none;\nbox-shadow: none;\n}\n#show-submissions-btn {\nbackground: linear-gradient(135deg, #ffa500, #cc8400);\nwidth: auto;\npadding: 10px 16px;\nfont-size: 1rem;\nborder-radius: 12px;\nbox-shadow: 0 4px 10px rgba(255,165,0, 0.5);\ntransition: background 0.3s, transform 0.15s;\nmargin-left: auto;\nuser-select:none;\n}\n#show-submissions-btn:hover {\nbackground: linear-gradient(135deg, #cc8400, #aa6a00);\ntransform: translateY(-2px);\n}\n.cards-container {\ndisplay: grid;\ngrid-template-columns: 1fr 1fr;\ngap: 14px;\nmargin-top: 8px;\nmargin-bottom: 24px;\n}\n@media (max-width:400px) {\n.cards-container {\ngrid-template-columns: 1fr;\n}\n}\n.card {\nbackground: white;\nborder-radius: 14px;\nbox-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\npadding: 16px;\ncursor: pointer;\ntransition: transform 0.3s ease, box-shadow 0.3s ease;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\ntext-align: center;\nuser-select: none;\nborder: 2px solid transparent;\n}\n.card:hover, .card:focus {\nbox-shadow: 0 8px 20px rgba(0,120,220, 0.3);\nborder-color: #0077ff;\noutline: none;\ntransform: scale(1.05);\n}\n.card img {\nwidth: 100px;\nheight: 100px;\nobject-fit: contain;\nmargin-bottom: 12px;\nfilter: grayscale(30%);\ntransition: filter 0.3s;\nborder-radius: 12px;\n}\n.card:hover img, .card:focus img {\nfilter: none;\n}\n.device-name {\nfont-weight: 700;\nfont-size: 1.15rem;\nmargin-bottom: 6px;\ncolor: #004bb5;\n}\n.device-desc {\nfont-size: 0.9rem;\ncolor: #555;\n}\n#camera-section {\nmargin-top: auto;\nmargin-bottom: 24px;\nposition: relative;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\ngap: 12px;\n}\n#camera-wrapper {\nposition: relative;\nwidth: 100%;\nmax-width: 320px; /* Reduced width */\nborder-radius: 16px;\noverflow: hidden;\nbox-shadow: 0 4px 12px rgba(0,0,0,0.25);\nbackground: black;\n}\n#video {\nwidth: 100%;\nheight: 240px; /* Reduced height */\nobject-fit: cover;\ndisplay: block;\n}\n#capture-btn {\nposition: absolute;\nbottom: 12px;\nleft: 50%;\ntransform: translateX(-50%);\nwidth: 56px; /* slightly smaller */\nheight: 56px;\nborder-radius: 50%;\nborder: 4px solid white;\nbackground: rgba(0, 119, 255, 0.8);\nbox-shadow: 0 2px 6px rgba(0, 119, 255, 0.9);\nfont-size: 0;\ncursor: pointer;\ntransition: background 0.3s, box-shadow 0.3s;\nuser-select: none;\nz-index: 10;\n}\n#capture-btn:hover:not(:disabled) {\nbackground: rgba(0, 119, 255, 1);\nbox-shadow: 0 4px 10px rgba(0, 119, 255, 1);\n}\n#capture-btn:focus {\noutline: 2px solid #004bb5;\noutline-offset: 2px;\n}\n#cancel-capture-btn {\nmargin-top: 12px;\nalign-self: center;\nwidth: 140px;\n}\n#canvas {\ndisplay: none;\n}\n#captured-photo {\ndisplay: none;\n}\n.hidden {\ndisplay: none !important;\n}\n/* Loader */\n.loader {\nborder: 5px solid #f3f3f3;\nborder-top: 5px solid #0077ff;\nborder-radius: 50%;\nwidth: 36px;\nheight: 36px;\nanimation: spin 1.1s linear infinite;\nmargin: 0 auto;\n}\n@keyframes spin {\n0% { transform: rotate(0deg); }\n100% { transform: rotate(360deg); }\n}\n/* Modal for details */\n#modal-overlay, #photo-modal-overlay {\nposition: fixed;\ninset: 0;\nbackground: rgba(0,0,0,0.5);\nbackdrop-filter: blur(4px);\ndisplay: none;\nalign-items: center;\njustify-content: center;\nz-index: 110000;\n}\n#modal-detail-content, #photo-modal-content {\nmax-height: 80vh;\noverflow-y: auto;\nfont-size: 1rem;\ncolor: #1a1a1a;\nline-height: 1.4;\nbackground: white;\nborder-radius: 14px;\npadding: 16px 24px;\nbox-shadow: 0 8px 28px rgba(0,0,0,0.35);\nwidth: 90vw;\nmax-width: 480px;\nbox-sizing: border-box;\nposition: relative;\ndisplay: flex;\nflex-direction: column;\ngap: 12px;\n}\n#modal-close-btn, #photo-modal-close-btn {\nposition: fixed;\ntop: 12px;\nright: 12px;\nbackground: #ff385c;\nborder: none;\nborder-radius: 100px;\nwidth: 40px;\nheight: 40px;\ncolor: white;\nfont-size: 24px;\nline-height: 40px;\ntext-align: center;\ncursor: pointer;\nbox-shadow: 0 2px 8px rgba(255,56,92,0.6);\nz-index: 110001;\ntransition: background 0.3s;\nuser-select:none;\n}\n#modal-close-btn:hover, #photo-modal-close-btn:hover {\nbackground: #d72950;\n}\n#modal-retry-btn {\nalign-self: flex-start;\nbackground: #b00020;\ncolor: white;\nborder: none;\nborder-radius: 8px;\npadding: 8px 16px;\nfont-size: 1rem;\ncursor: pointer;\nbox-shadow: 0 2px 6px rgba(176,0,32,0.8);\ntransition: background 0.3s;\nuser-select:none;\nmargin-top: 8px;\ndisplay: flex;\nalign-items: center;\ngap: 8px;\n}\n#modal-retry-btn:hover:not(:disabled) {\nbackground: #7a000f;\n}\n#modal-retry-btn:disabled {\nbackground: #999999cc;\ncursor: not-allowed;\nbox-shadow: none;\n}\n#photo-modal-buttons {\ndisplay: flex;\njustify-content: space-around;\nmargin-top: 12px;\n}\n#photo-modal-buttons button {\nflex: 1;\nmax-width: 140px;\npadding: 10px;\nfont-size: 1.1rem;\nborder-radius: 12px;\nborder: none;\ncursor: pointer;\nuser-select:none;\ntransition: background 0.3s;\n}\n#photo-tryagain-btn {\nbackground: #b00020;\ncolor: white;\nmargin-right: 12px;\n}\n#photo-tryagain-btn:hover:not(:disabled) {\nbackground: #7a000f;\n}\n#photo-ok-btn {\nbackground: #0077ff;\ncolor: white;\n}\n#photo-ok-btn:hover:not(:disabled) {\nbackground: #005fcc;\n}\n#upload-status {\nmargin-top: 12px;\nmin-height: 18px;\ncolor: #0077ff;\nfont-weight: 600;\ntext-align: center;\n}\n/* Saved Submissions Panel */\n#saved-submissions-panel {\nposition: fixed;\ntop: 0;\nleft: 0;\nwidth: 100vw;\nheight: 100vh;\nbackground: #fff8e1;\nborder: 2px solid #fcbf49;\npadding: 16px;\nbox-sizing: border-box;\ndisplay: none;\nflex-direction: column;\nuser-select:none;\nz-index: 100000;\n}\n#saved-submissions-panel h2 {\nmargin-bottom: 8px;\nfont-weight: 700;\ncolor: #cf8f00;\nfont-size: 1.8rem;\ntext-align: center;\n}\n#saved-submissions-close {\nposition: absolute;\ntop: 12px;\nright: 12px;\nbackground: #ff385c;\nborder: none;\nborder-radius: 100px;\nwidth: 40px;\nheight: 40px;\ncolor: white;\nfont-size: 28px;\nline-height: 40px;\ntext-align: center;\ncursor: pointer;\nbox-shadow: 0 2px 8px rgba(255,56,92,0.6);\ntransition: background 0.3s;\nuser-select:none;\nz-index: 100001;\n}\n#saved-submissions-close:hover {\nbackground: #d72950;\n}\n#pagination-controls {\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\nmargin: 12px 0;\ngap: 8px;\nflex-wrap: wrap;\n}\n#pagination-controls label {\nfont-weight: 700;\nfont-size: 1.1rem;\ncolor: #996700;\n}\n#pagination-controls input[type=date], #pagination-controls input[type=search] {\npadding: 8px 10px;\nfont-size: 1.1rem;\nborder-radius: 8px;\nborder: 1.5px solid #fcbf49;\nwidth: 180px;\nmax-width: 45vw;\nbox-sizing: border-box;\n}\n#saved-submissions-table-wrapper {\n/* Wrapper to enable overflow and fix header */\nwidth: 100%;\noverflow-x: auto;\n}\n#saved-submissions-table {\nborder-collapse: collapse;\nwidth: 100%;\nmin-width: 400px;\n}\n#saved-submissions-table thead th {\nbackground-color: #fde6a3;\nborder: 1px solid #f0c96e;\npadding: 8px 10px;\nfont-size: 1rem;\nfont-weight: 700;\ntext-align: center;\nwhite-space: nowrap;\nposition: sticky;\ntop: 0;\nz-index: 2;\nmin-width: 90px;\n}\n#saved-submissions-table tbody tr {\ncursor: pointer;\ntransition: background-color 0.2s;\n}\n#saved-submissions-table tbody tr:hover {\nbackground-color: #fffae6;\n}\n#saved-submissions-table tbody td {\nborder: 1px solid #f0c96e;\npadding: 8px 10px;\nfont-size: 1rem;\ntext-align: center;\nwhite-space: nowrap;\noverflow: hidden;\ntext-overflow: ellipsis;\nmin-width: 90px;\n}\n\n.status-pending {\ncolor: #d18e00;\nfont-weight: 700;\n}\n.status-success {\ncolor: #2b7a0b;\nfont-weight: 700;\n}\n.status-failed {\ncolor: #b00020;\nfont-weight: 700;\n}\n.thumbnail-img {\nmax-width: 80px;\nmax-height: 60px;\nborder-radius: 8px;\nobject-fit: contain;\n}\n</style>\n\n</head>\n<body>\n<div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n<header>\n<h1>Patient Device Capture</h1>\n<div style=\"display:flex; align-items:center; gap:8px;\">\n<button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n</div>\n<section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n<div><strong id=\"patient-name\"></strong></div>\n<div>MRN: <span id=\"patient-mrn\"></span></div>\n</section>\n<section id=\"mrn-section\" aria-label=\"Patient MRN Input\" style=\"margin-top:12px;\">\n<label for=\"mrn-input\">Scan or Enter Patient MRN:</label>\n<div id=\"mrn-controls\">\n<input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n<button id=\"start-qr-btn\" aria-label=\"Start QR code scanner\">Scan QR</button>\n</div>\n<button id=\"load-devices-btn\" aria-label=\"Load devices for patient\" disabled>Load Devices</button>\n<div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n</section>\n</header>\n\n<main style=\"flex-grow:1;\">\n<section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n<h2>Available Devices</h2>\n<div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n<!-- Device cards inserted dynamically -->\n</div>\n</section>\n\n<section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n<h2>Capture Device Photo</h2>\n<div id=\"camera-wrapper\">\n<video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n<button id=\"capture-btn\" aria-label=\"Take picture\" title=\"Take Picture\"></button>\n</div>\n<button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n<canvas id=\"canvas\" class=\"hidden\"></canvas>\n<img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n<div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n</section>\n\n<!-- Saved Submissions Panel -->\n<section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n<h2>Saved Submissions</h2>\n<button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n<div id=\"pagination-controls\">\n<label for=\"date-filter-input\">Select Date:</label>\n<input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n<label for=\"search-input\">Search:</label>\n<input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n</div>\n<div id=\"saved-submissions-table-wrapper\">\n<table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n<thead>\n<tr>\n<th>MRN</th>\n<th>POC</th>\n<th>Date</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody id=\"saved-submissions-body\" tabindex=\"0\">\n<!-- Entries dynamically inserted -->\n</tbody>\n</table>\n</div>\n</section>\n</main> </div>\n\n<!-- Modal for showing submission details -->\n<div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n<button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n<div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n<!-- Populated dynamically -->\n</div>\n</div>\n\n<!-- Modal to show captured photo and Try Again/Submit buttons -->\n<div id=\"photo-modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Captured Photo Preview\" tabindex=\"-1\">\n<div id=\"photo-modal-content\" tabindex=\"0\">\n<button id=\"photo-modal-close-btn\" aria-label=\"Close photo preview\">×</button>\n<img id=\"photo-modal-img\" alt=\"Captured photo preview\" style=\"max-width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.25);\" />\n<div id=\"photo-modal-buttons\">\n<button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n<button id=\"photo-ok-btn\" aria-label=\"Submit this photo\">Submit</button>\n</div>\n<div id=\"upload-status\"></div>\n</div>\n</div>\n\n<script>\n(() => {\n'use strict';\n\n// Elements\nconst mrnInput = document.getElementById('mrn-input');\nconst loadDevicesBtn = document.getElementById('load-devices-btn');\nconst startQrBtn = document.getElementById('start-qr-btn');\nconst mrnError = document.getElementById('mrn-error');\nconst patientInfoSection = document.getElementById('patient-info');\nconst patientNameElem = document.getElementById('patient-name');\nconst patientMrnElem = document.getElementById('patient-mrn');\nconst devicesSection = document.getElementById('devices-section');\nconst devicesContainer = document.getElementById('devices-container');\nconst cameraSection = document.getElementById('camera-section');\nconst cameraWrapper = document.getElementById('camera-wrapper');\nconst video = document.getElementById('video');\nconst canvas = document.getElementById('canvas');\nconst captureBtn = document.getElementById('capture-btn');\nconst cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n\n// Photo modal elements\nconst photoModalOverlay = document.getElementById('photo-modal-overlay');\nconst photoModalContent = document.getElementById('photo-modal-content');\nconst photoModalImg = document.getElementById('photo-modal-img');\nconst photoModalCloseBtn = document.getElementById('photo-modal-close-btn');\nconst photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\nconst photoOkBtn = document.getElementById('photo-ok-btn');\nconst uploadStatus = photoModalContent.querySelector('#upload-status');\n\n// Modal elements for submissions\nconst modalOverlay = document.getElementById('modal-overlay');\nconst modalDetailContent = document.getElementById('modal-detail-content');\nconst modalCloseBtn = document.getElementById('modal-close-btn');\n\n// Saved submissions elements\nconst showSubmissionsBtn = document.getElementById('show-submissions-btn');\nconst savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\nconst savedSubmissionsBody = document.getElementById('saved-submissions-body');\nconst dateFilterInput = document.getElementById('date-filter-input');\nconst searchInput = document.getElementById('search-input');\nconst savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n// State\nlet currentDevices = [];\nlet selectedDevice = null;\nlet currentMRN = '';\nlet cameraStream = null;\nlet photoBlob = null;\n\nconst STORAGE_KEY = 'patientDeviceSubmissions';\n\n// Utility functions\nfunction clearChildren(el) {\nwhile(el.firstChild) el.removeChild(el.firstChild);\n}\n\nfunction setLoading(btn, isLoading, text) {\nif(isLoading){\nbtn.disabled = true;\nbtn.innerHTML = '<div class=\"loader\" aria-label=\"Loading\"></div>';\n} else {\nbtn.disabled = false;\nbtn.textContent = text;\n}\n}\n\nfunction validateMRN(mrn) {\nreturn mrn.trim().length > 0;\n}\nfunction showError(msg) {\nmrnError.textContent = msg;\n}\nfunction clearError() {\nmrnError.textContent = '';\n}\n\n// Format helpers\nfunction formatDateTime(timestamp) {\nconst dt = new Date(timestamp);\nconst pad = (n) => n.toString().padStart(2,'0');\nreturn \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n}\n\nfunction formatDate(timestamp) {\nconst dt = new Date(timestamp);\nconst pad = (n) => n.toString().padStart(2,'0');\nreturn \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()}\\`;\n}\n\n// Fetch patient info\nasync function fetchPatientInfo(mrn) {\ntry {\nconst res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\nmethod:'POST',\nheaders: {'Content-Type': 'application/json'},\nbody: JSON.stringify({mrn})\n});\nif(!res.ok) throw new Error(\\`Failed: \\${res.status}\\`);\nconst json = await res.json();\nlet patientName = '';\nif(json && typeof json === 'object') {\npatientName = json.patientName || json.name || '';\n}\nif(patientName) {\npatientNameElem.textContent = patientName;\npatientMrnElem.textContent = mrn;\npatientInfoSection.hidden = false;\n} else {\npatientInfoSection.hidden = true;\n}\n} catch(e) {\npatientInfoSection.hidden = true;\nconsole.warn('Failed to fetch patient info:', e);\n}\n}\n\nasync function loadDevices(mrn) {\nsetLoading(loadDevicesBtn, true, '');\nshowError('');\ntry {\nconst res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\nmethod: 'POST',\nheaders: {'Content-Type': 'application/json'},\nbody: JSON.stringify({mrn})\n});\nif(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\nlet devices = await res.json();\nif(!Array.isArray(devices)) throw new Error('Invalid response');\ncurrentDevices = devices;\nif(currentDevices.length === 0) {\nshowError('No devices found for this patient.');\ndevicesSection.hidden = true;\nsetLoading(loadDevicesBtn,false,'Load Devices');\nreturn false;\n}\nrenderDeviceCards(currentDevices);\ndevicesSection.hidden = false;\ndevicesSection.focus();\nsetLoading(loadDevicesBtn,false,'Load Devices');\nreturn true;\n} catch(e) {\nshowError('Failed to load devices: ' + e.message);\ndevicesSection.hidden = true;\nsetLoading(loadDevicesBtn,false,'Load Devices');\nreturn false;\n}\n}\n\nfunction renderDeviceCards(devices) {\nclearChildren(devicesContainer);\nselectedDevice = null;\ndevices.forEach(device => {\nconst card = document.createElement('div');\ncard.classList.add('card');\ncard.role = 'listitem';\ncard.tabIndex = 0;\ncard.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\nconst img = document.createElement('img');\nimg.alt = device.POCEquipment + ' image' || 'Device image';\nimg.src = device.imageurl || '';\nimg.loading = 'lazy';\ncard.appendChild(img);\nconst nameEl = document.createElement('div');\nnameEl.className = 'device-name';\nnameEl.textContent = device.POCEquipment;\ncard.appendChild(nameEl);\nconst descEl = document.createElement('div');\ndescEl.className = 'device-desc';\ndescEl.textContent = device.Description || '';\ncard.appendChild(descEl);\nconst openCameraForDevice = () => {\nselectedDevice = device;\ndevicesSection.hidden = true;\ncameraSection.classList.remove('hidden');\ncameraSection.focus();\n\n// Reset state/UI:\nphotoBlob = null;\nuploadStatus.textContent = '';\n// Hide photo modal initially\nphotoModalOverlay.style.display = 'none';\n\nstartCamera();\n};\ncard.addEventListener('click', openCameraForDevice);\ncard.addEventListener('keydown', e => {\nif(e.key === 'Enter' || e.key === ' ') {\ne.preventDefault();\nopenCameraForDevice();\n}\n});\ndevicesContainer.appendChild(card);\n});\n}\n\nasync function startCamera() {\ntry {\nif(cameraStream) stopCamera();\ncameraStream = await navigator.mediaDevices.getUserMedia({\nvideo: { facingMode: 'environment', width: {ideal:1280}, height: {ideal:720} },\naudio: false\n});\nvideo.srcObject = cameraStream;\nawait video.play();\n} catch(e) {\nalert('Failed to access camera: ' + e.message);\ncancelCaptureBtn.click();\n}\n}\nfunction stopCamera() {\nif(cameraStream){\ncameraStream.getTracks().forEach(t => t.stop());\ncameraStream = null;\n}\n}\n\ncancelCaptureBtn.addEventListener('click', () => {\nstopCamera();\ncameraSection.classList.add('hidden');\ndevicesSection.hidden = false;\nphotoModalOverlay.style.display = 'none';\n});\n\n// Capture button overlays video: take photo, then show modal\ncaptureBtn.addEventListener('click', takePhoto);\nfunction takePhoto() {\nif(!cameraStream) return;\ncanvas.width = video.videoWidth;\ncanvas.height = video.videoHeight;\nconst ctx = canvas.getContext('2d');\nctx.drawImage(video, 0, 0, canvas.width, canvas.height);\ncanvas.toBlob(blob => {\nphotoBlob = blob;\nconst url = URL.createObjectURL(blob);\nphotoModalImg.src = url;\n\n// Show photo modal with Try Again and Submit options\nphotoModalOverlay.style.display = 'flex';\nphotoModalContent.focus();\n}, 'image/jpeg', 0.95);\n}\n\nphotoModalCloseBtn.addEventListener('click', () => {\nphotoModalOverlay.style.display = 'none';\nif(photoModalImg.src) {\nURL.revokeObjectURL(photoModalImg.src);\nphotoModalImg.src = '';\n}\n});\n\nphotoTryAgainBtn.addEventListener('click', () => {\nphotoModalOverlay.style.display = 'none';\nif(photoModalImg.src) {\nURL.revokeObjectURL(photoModalImg.src);\nphotoModalImg.src = '';\n}\n// Allow retaking photo\nphotoBlob = null;\nuploadStatus.textContent = '';\n});\n\nphotoOkBtn.addEventListener('click', uploadPhoto);\n\nasync function uploadPhoto() {\nif (!photoBlob || !selectedDevice || !currentMRN) return;\nsetLoading(photoOkBtn, true, '');\nuploadStatus.textContent = 'Uploading...';\ntry {\nconst formData = new FormData();\nformData.append('mrn', currentMRN);\nformData.append('device', JSON.stringify(selectedDevice));\nformData.append('photo', photoBlob, 'device.jpg');\n\nconst base64DataUrl = await blobToDataURL(photoBlob);\nconst submissionRecord = {\nid: Date.now() + '-' + Math.random().toString(36).substr(2, 9),\nmrn: currentMRN,\ndevice: JSON.stringify(selectedDevice),\nphotoDataUrl: base64DataUrl,\nstatus: 'Pending',\ntimestamp: Date.now()\n};\naddSubmissionRecord(submissionRecord);\nupdateDatePickerRange();\nrenderSavedSubmissions();\n\nconst res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\nmethod: 'POST',\nbody: formData,\n});\nif(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n\nupdateSubmissionStatus(submissionRecord.id, 'Success');\n\n// Cleanup modal and photoBlob\nif(photoModalImg.src) {\nURL.revokeObjectURL(photoModalImg.src);\nphotoModalImg.src = '';\n}\nphotoBlob = null;\n\nuploadStatus.textContent = 'Upload successful!';\nsetTimeout(() => {\nuploadStatus.textContent = '';\nphotoModalOverlay.style.display = 'none';\nstopCamera();\ncameraSection.classList.add('hidden');\ndevicesSection.hidden = false;\n\n// Automatically reload devices after submission\nloadDevices(currentMRN);\n}, 1000);\n} catch(e) {\nuploadStatus.textContent = 'Upload failed: ' + e.message;\nconst submissions = loadSavedSubmissions();\nif(submissions.length > 0){\nupdateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n}\n}\nsetLoading(photoOkBtn, false, 'Submit');\n}\n\nfunction blobToDataURL(blob) {\nreturn new Promise((resolve, reject) => {\nconst reader = new FileReader();\nreader.onloadend = () => resolve(reader.result);\nreader.onerror = reject;\nreader.readAsDataURL(blob);\n});\n}\n\n// LocalStorage helpers\nfunction loadSavedSubmissions() {\ntry {\nconst dataStr = localStorage.getItem(STORAGE_KEY);\nif(!dataStr) return [];\nreturn JSON.parse(dataStr);\n} catch(e){\nconsole.warn('Failed to parse saved submissions in localStorage', e);\nreturn [];\n}\n}\nfunction saveSubmissions(submissions) {\ntry {\nlocalStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n} catch(e){\nconsole.warn('Failed to save submissions to localStorage', e);\n}\n}\nfunction addSubmissionRecord(record) {\nconst submissions = loadSavedSubmissions();\nsubmissions.push(record);\nsaveSubmissions(submissions);\n}\nfunction updateSubmissionStatus(id, newStatus) {\nconst submissions = loadSavedSubmissions();\nconst idx = submissions.findIndex(s => s.id === id);\nif(idx !== -1){\nsubmissions[idx].status = newStatus;\nsaveSubmissions(submissions);\n}\nrenderSavedSubmissions();\n}\n\nfunction renderSavedSubmissions() {\nconst submissions = loadSavedSubmissions();\nlet filtered = submissions;\n\n// Filter by date if set\nif(dateFilterInput.value){\nconst selectedDate = new Date(dateFilterInput.value);\nfiltered = filtered.filter(sub => {\nconst subDate = new Date(sub.timestamp);\nreturn subDate.getFullYear() === selectedDate.getFullYear() &&\nsubDate.getMonth() === selectedDate.getMonth() &&\nsubDate.getDate() === selectedDate.getDate();\n});\n}\n\n// Filter by search input if set\nconst searchTerm = searchInput.value.trim().toLowerCase();\nif(searchTerm) {\nfiltered = filtered.filter(sub => {\nconst deviceObj = JSON.parse(sub.device || '{}');\nreturn sub.mrn.toLowerCase().includes(searchTerm) ||\n(deviceObj.POCEquipment && deviceObj.POCEquipment.toLowerCase().includes(searchTerm));\n});\n}\n\nclearChildren(savedSubmissionsBody);\nif(filtered.length === 0){\nconst tr = document.createElement('tr');\nconst td = document.createElement('td');\ntd.colSpan = 4;\ntd.textContent = 'No submissions found.';\ntd.style.textAlign = 'center';\ntr.appendChild(td);\nsavedSubmissionsBody.appendChild(tr);\nreturn;\n}\nfiltered.forEach(sub => {\nconst tr = document.createElement('tr');\ntr.tabIndex = 0;\ntr.setAttribute('aria-label', \\`Submission for MRN \\${sub.mrn}, Device: \\${(JSON.parse(sub.device).POCEquipment || '')}, Date: \\${formatDate(sub.timestamp)}, Status: \\${sub.status}\\`);\nconst tdMrn = document.createElement('td');\ntdMrn.textContent = sub.mrn;\nconst tdDevice = document.createElement('td');\ntry {\nconst deviceObj = JSON.parse(sub.device);\ntdDevice.textContent = deviceObj.POCEquipment || '';\n} catch {\ntdDevice.textContent = '';\n}\nconst tdDate = document.createElement('td');\n// Show date only (no time)\ntdDate.textContent = formatDate(sub.timestamp);\nconst tdStatus = document.createElement('td');\ntdStatus.textContent = sub.status;\ntdStatus.classList.add(sub.status === 'Pending' ? 'status-pending' : sub.status === 'Success' ? 'status-success' : 'status-failed');\ntr.appendChild(tdMrn);\ntr.appendChild(tdDevice);\ntr.appendChild(tdDate);\ntr.appendChild(tdStatus);\nsavedSubmissionsBody.appendChild(tr);\n\ntr.addEventListener('click', () => {\nshowSubmissionDetails(sub);\n});\ntr.addEventListener('keydown', e => {\nif(e.key === 'Enter' || e.key === ' ') {\ne.preventDefault();\nshowSubmissionDetails(sub);\n}\n});\n});\n}\n\nfunction showSubmissionDetails(submission) {\nclearChildren(modalDetailContent);\n\ntry {\nconst deviceObj = JSON.parse(submission.device);\nconst title = document.createElement('h3');\ntitle.textContent = deviceObj.POCEquipment || 'Device';\nmodalDetailContent.appendChild(title);\nif(deviceObj.Description){\nconst desc = document.createElement('p');\ndesc.textContent = deviceObj.Description;\nmodalDetailContent.appendChild(desc);\n}\n} catch {\n// noop\n}\n\nconst mrnP = document.createElement('p');\nmrnP.textContent = 'MRN: ' + submission.mrn;\nmodalDetailContent.appendChild(mrnP);\n\nconst dateP = document.createElement('p');\n// Keep full date/time here for details modal\ndateP.textContent = 'Date: ' + formatDateTime(submission.timestamp);\nmodalDetailContent.appendChild(dateP);\n\nconst statusP = document.createElement('p');\nstatusP.textContent = 'Status: ' + submission.status;\nstatusP.className = submission.status === 'Pending' ? 'status-pending' : submission.status === 'Success' ? 'status-success' : 'status-failed';\nmodalDetailContent.appendChild(statusP);\n\nif(submission.photoDataUrl){\nconst img = document.createElement('img');\nimg.src = submission.photoDataUrl;\nimg.alt = 'Captured photo of device';\nimg.style.maxWidth = '100%';\nimg.style.borderRadius = '14px';\nimg.style.marginTop = '12px';\nmodalDetailContent.appendChild(img);\n}\n\nmodalOverlay.style.display = 'flex';\nmodalDetailContent.focus();\n}\n\nmodalCloseBtn.addEventListener('click', () => {\nmodalOverlay.style.display = 'none';\n});\n\n// Load Devices and Patient Info button handling\nloadDevicesBtn.addEventListener('click', async () => {\nconst mrn = mrnInput.value.trim();\nif(!validateMRN(mrn)) {\nshowError('Please enter a valid MRN.');\nreturn;\n}\nclearError();\ncurrentMRN = mrn;\npatientMrnElem.textContent = currentMRN;\nawait fetchPatientInfo(currentMRN);\nawait loadDevices(currentMRN);\n});\n\n// Enable Load Devices button only if MRN input has value\nmrnInput.addEventListener('input', () => {\nloadDevicesBtn.disabled = mrnInput.value.trim().length === 0;\n});\n\nmrnInput.addEventListener('keyup', e => {\nif(e.key === 'Enter' && !loadDevicesBtn.disabled){\nloadDevicesBtn.click();\n}\n});\n\n// Show/Hide Saved Submissions panel\nshowSubmissionsBtn.addEventListener('click', () => {\nconst visible = savedSubmissionsPanel.style.display === 'flex';\nif(visible){\nsavedSubmissionsPanel.style.display = 'none';\nshowSubmissionsBtn.textContent = 'Show Saved Submissions';\nshowSubmissionsBtn.setAttribute('aria-pressed', 'false');\n} else {\nsavedSubmissionsPanel.style.display = 'flex';\nshowSubmissionsBtn.textContent = 'Hide Saved Submissions';\nshowSubmissionsBtn.setAttribute('aria-pressed', 'true');\nupdateDatePickerRange();\nrenderSavedSubmissions();\n}\n});\n\nsavedSubmissionsCloseBtn.addEventListener('click', () => {\nsavedSubmissionsPanel.style.display = 'none';\nshowSubmissionsBtn.textContent = 'Show Saved Submissions';\nshowSubmissionsBtn.setAttribute('aria-pressed', 'false');\n});\n\n// Date filter input updates submission table on change\ndateFilterInput.addEventListener('change', () => {\nrenderSavedSubmissions();\n});\n\n// Search input updates submission table on input\nsearchInput.addEventListener('input', () => {\nrenderSavedSubmissions();\n});\n\n// Initial load for MRN in URL\nfunction getQueryParam(param) {\nconst urlParams = new URLSearchParams(window.location.search);\nreturn urlParams.get(param);\n}\nasync function initialLoad() {\nconst mrnFromUrl = getQueryParam('mrn') || '';\nif(validateMRN(mrnFromUrl)){\nmrnInput.value = mrnFromUrl;\nloadDevicesBtn.disabled = false;\ncurrentMRN = mrnFromUrl;\nawait fetchPatientInfo(currentMRN);\nawait loadDevices(currentMRN);\n}\n}\ninitialLoad();\n\n// Update date picker min/max based on saved submissions and default to today\nfunction updateDatePickerRange() {\nconst submissions = loadSavedSubmissions();\nif(submissions.length === 0){\ndateFilterInput.min = '';\ndateFilterInput.max = '';\ndateFilterInput.value = '';\n// Default to today anyway\nconst today = new Date();\ndateFilterInput.value = today.toISOString().split('T')[0];\nreturn;\n}\nconst timestamps = submissions.map(s => s.timestamp);\nconst minDt = new Date(Math.min(...timestamps));\nconst maxDt = new Date(Math.max(...timestamps));\nconst pad = n => n.toString().padStart(2, '0');\ndateFilterInput.min = \\`\\${minDt.getFullYear()}-\\${pad(minDt.getMonth()+1)}-\\${pad(minDt.getDate())}\\`;\ndateFilterInput.max = \\`\\${maxDt.getFullYear()}-\\${pad(maxDt.getMonth()+1)}-\\${pad(maxDt.getDate())}\\`;\n\n// Default to today's date, but only if not already set or outside range\nconst today = new Date();\nconst todayStr = today.toISOString().split('T')[0];\nif(!dateFilterInput.value || dateFilterInput.value < dateFilterInput.min || dateFilterInput.value > dateFilterInput.max){\ndateFilterInput.value = todayStr;\n}\n}\n\n})();\n</script>\n</body>\n</html>`\n}\n}\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -180,
        1940
      ],
      "id": "a55e9e2a-f890-4c93-a899-53e6ed2da3b7",
      "name": "Code12"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "DECLARE @STARTDATE DATE = '2025-07-29'\n\nDECLARE @ENDDATE DATE = '2025-07-29'\n\nDECLARE @MRN VARCHAR(30) = '%%'\n\nDECLARE @FIRSTNAME VARCHAR(30) = '%%'\n\nDECLARE @LASTNAME VARCHAR(30) = '%%'\n\nDECLARE @DOB VARCHAR(30) = '%%' \n\nDECLARE @LOC VARCHAR(100) = '%%'\n\nDECLARE @RES VARCHAR(50)= '%%'\n \nSELECT \n\n    a.[Patient_Number] AS MRN,\n\n    g.Patient_First_Name,\n\n    g.Patient_Last_Name,\n\n    FORMAT(g.Patient_DOB, 'MM-dd-yyyy') Patient_DOB,\n\n    a.[Appt_DateTime],\n\n    a.[Appt_Sched_Location_Descr],\n\n    a.[Appt_Resource_Descr],\n\n    a.[Appt_Resource_Assoc_Prov_LFI],\n\n    a.[Appt_Status]\n\nFROM \n\n    [Ntier_EPIC].[dbo].[vwGenPatApptInfo] a\n\nLEFT JOIN \n\n    [dbo].[vwGenPatInfo] g ON a.Patient_Number = g.Patient_Number\n\nWHERE \n\n    CAST(a.Appt_DateTime AS DATE) BETWEEN @STARTDATE AND @ENDDATE\n\n    AND a.Appt_Status = 'A'\n\n    AND a.Patient_Number LIKE @MRN\n\n    AND a.Appt_Sched_Location_Descr LIKE @LOC AND a.Appt_Resource_Descr like @RES\n\n    AND (\n\n        g.Patient_First_Name LIKE @FIRSTNAME\n\n        AND g.Patient_Last_Name LIKE @LASTNAME\n\n        AND CONVERT(VARCHAR, g.Patient_DOB, 23) LIKE @DOB\n \n    );\n\n "
      },
      "type": "n8n-nodes-base.microsoftSql",
      "typeVersion": 1.1,
      "position": [
        3300,
        480
      ],
      "id": "3dc645c9-ef10-4459-8b5d-46037f573a35",
      "name": "Paitents",
      "credentials": {
        "microsoftSql": {
          "id": "wyNxSZ4e8ERWmP4v",
          "name": "Microsoft SQL PM"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      html: `<!DOCTYPE html>\n\n<html lang=\"en\" >\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Patient Device Capture with Saved Data - Full Screen, Date Picker & Search</title>\n<style>\n/* Reset and base */\n* {\nbox-sizing: border-box;\nmargin: 0; padding: 0;\n}\nhtml, body {\nheight: 100%;\nfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\nUbuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\nbackground: #f7f9fc;\ncolor: #1a1a1a;\n}\n#app {\nmax-width: 480px;\nmargin: auto;\npadding: 16px;\ndisplay: flex;\nflex-direction: column;\nmin-height: 100vh;\n}\nheader {\nmargin-bottom: 16px;\ndisplay: flex;\nflex-direction: column;\ngap: 8px;\n}\nh1 {\nfont-weight: 700;\nletter-spacing: 0.08em;\nfont-size: 1.5rem;\ncolor: #003366;\nmargin-bottom: 12px;\ntext-align: center;\n}\n#patient-info {\nmargin-bottom: 24px;\npadding: 12px 16px;\nbackground: #e7f0fa;\nborder-radius: 12px;\nbox-shadow: inset 0 0 10px #aad4ff88;\n}\n#patient-info strong {\ncolor: #0077ff;\nfont-size: 1.15rem;\n}\nlabel {\nfont-weight: 600;\ndisplay: block;\nmargin-bottom: 8px;\ncolor: #004bb5;\n}\n#mrn-section {\nmargin-top:12px;\n}\n#mrn-error {\ncolor:#b00020; \nmargin-top:8px; \nmin-height:18px;\n}\nbutton {\ncursor: pointer;\nbackground: linear-gradient(135deg, #0077ff, #005fcc);\ncolor: white;\nborder: none;\npadding: 14px 0;\nfont-size: 1.2rem;\nborder-radius: 12px;\nbox-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\ntransition: background 0.3s, transform 0.15s;\nflex: none;\nwidth: 120px;\nuser-select:none;\n}\nbutton:hover:not(:disabled) {\nbackground: linear-gradient(135deg, #005fcc, #004bb5);\ntransform: translateY(-2px);\n}\nbutton:disabled, button[aria-disabled='true'] {\nbackground: #999999cc;\ncursor: not-allowed;\ntransform: none;\nbox-shadow: none;\n}\n#show-submissions-btn {\nbackground: linear-gradient(135deg, #ffa500, #cc8400);\nwidth: auto;\npadding: 10px 16px;\nfont-size: 1rem;\nborder-radius: 12px;\nbox-shadow: 0 4px 10px rgba(255,165,0, 0.5);\ntransition: background 0.3s, transform 0.15s;\nmargin-left: auto;\nuser-select:none;\n}\n#show-submissions-btn:hover {\nbackground: linear-gradient(135deg, #cc8400, #aa6a00);\ntransform: translateY(-2px);\n}\n.cards-container {\ndisplay: grid;\ngrid-template-columns: 1fr 1fr;\ngap: 14px;\nmargin-top: 8px;\nmargin-bottom: 24px;\n}\n@media (max-width:400px) {\n.cards-container {\ngrid-template-columns: 1fr;\n}\n}\n.card {\nbackground: white;\nborder-radius: 14px;\nbox-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\npadding: 16px;\ncursor: pointer;\ntransition: transform 0.3s ease, box-shadow 0.3s ease;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\ntext-align: center;\nuser-select: none;\nborder: 2px solid transparent;\n}\n.card:hover, .card:focus {\nbox-shadow: 0 8px 20px rgba(0,120,220, 0.3);\nborder-color: #0077ff;\noutline: none;\ntransform: scale(1.05);\n}\n.card img {\nwidth: 100px;\nheight: 100px;\nobject-fit: contain;\nmargin-bottom: 12px;\nfilter: grayscale(30%);\ntransition: filter 0.3s;\nborder-radius: 12px;\n}\n.card:hover img, .card:focus img {\nfilter: none;\n}\n.device-name {\nfont-weight: 700;\nfont-size: 1.15rem;\nmargin-bottom: 6px;\ncolor: #004bb5;\n}\n.device-desc {\nfont-size: 0.9rem;\ncolor: #555;\n}\n#camera-section {\nmargin-top: auto;\nmargin-bottom: 24px;\nposition: relative;\ndisplay: flex;\nflex-direction: column;\nalign-items: center;\ngap: 12px;\n}\n#camera-wrapper {\nposition: relative;\nwidth: 100%;\nmax-width: 320px;\nborder-radius: 16px;\noverflow: hidden;\nbox-shadow: 0 4px 12px rgba(0,0,0,0.25);\nbackground: black;\n}\n#video {\nwidth: 100%;\nheight: 240px;\nobject-fit: cover;\ndisplay: block;\n}\n#capture-btn {\nposition: absolute;\nbottom: 12px;\nleft: 50%;\ntransform: translateX(-50%);\nwidth: 56px;\nheight: 56px;\nborder-radius: 50%;\nborder: 4px solid white;\nbackground: rgba(0, 119, 255, 0.8);\nbox-shadow: 0 2px 6px rgba(0, 119, 255, 0.9);\nfont-size: 0;\ncursor: pointer;\ntransition: background 0.3s, box-shadow 0.3s;\nuser-select: none;\nz-index: 10;\n}\n#capture-btn:hover:not(:disabled) {\nbackground: rgba(0, 119, 255, 1);\nbox-shadow: 0 4px 10px rgba(0, 119, 255, 1);\n}\n#capture-btn:focus {\noutline: 2px solid #004bb5;\noutline-offset: 2px;\n}\n#cancel-capture-btn {\nmargin-top: 12px;\nalign-self: center;\nwidth: 140px;\n}\n#canvas {\ndisplay: none;\n}\n#captured-photo {\ndisplay: none;\n}\n.hidden {\ndisplay: none !important;\n}\n/* Loader */\n.loader {\nborder: 5px solid #f3f3f3;\nborder-top: 5px solid #0077ff;\nborder-radius: 50%;\nwidth: 36px;\nheight: 36px;\nanimation: spin 1.1s linear infinite;\nmargin: 0 auto;\n}\n@keyframes spin {\n0% { transform: rotate(0deg); }\n100% { transform: rotate(360deg); }\n}\n/* Modal for details */\n#modal-overlay, #photo-modal-overlay {\nposition: fixed;\ninset: 0;\nbackground: rgba(0,0,0,0.5);\nbackdrop-filter: blur(4px);\ndisplay: none;\nalign-items: center;\njustify-content: center;\nz-index: 110000;\n}\n#modal-detail-content, #photo-modal-content {\nmax-height: 80vh;\noverflow-y: auto;\nfont-size: 1rem;\ncolor: #1a1a1a;\nline-height: 1.4;\nbackground: white;\nborder-radius: 14px;\npadding: 16px 24px;\nbox-shadow: 0 8px 28px rgba(0,0,0,0.35);\nwidth: 90vw;\nmax-width: 480px;\nbox-sizing: border-box;\nposition: relative;\ndisplay: flex;\nflex-direction: column;\ngap: 12px;\n}\n#modal-close-btn, #photo-modal-close-btn {\nposition: fixed;\ntop: 12px;\nright: 12px;\nbackground: #ff385c;\nborder: none;\nborder-radius: 100px;\nwidth: 40px;\nheight: 40px;\ncolor: white;\nfont-size: 24px;\nline-height: 40px;\ntext-align: center;\ncursor: pointer;\nbox-shadow: 0 2px 8px rgba(255,56,92,0.6);\nz-index: 110001;\ntransition: background 0.3s;\nuser-select:none;\n}\n#modal-close-btn:hover, #photo-modal-close-btn:hover {\nbackground: #d72950;\n}\n#modal-retry-btn {\nalign-self: flex-start;\nbackground: #b00020;\ncolor: white;\nborder: none;\nborder-radius: 8px;\npadding: 8px 16px;\nfont-size: 1rem;\ncursor: pointer;\nbox-shadow: 0 2px 6px rgba(176,0,32,0.8);\ntransition: background 0.3s;\nuser-select:none;\nmargin-top: 8px;\ndisplay: flex;\nalign-items: center;\ngap: 8px;\n}\n#modal-retry-btn:hover:not(:disabled) {\nbackground: #7a000f;\n}\n#modal-retry-btn:disabled {\nbackground: #999999cc;\ncursor: not-allowed;\nbox-shadow: none;\n}\n#photo-modal-buttons {\ndisplay: flex;\njustify-content: space-around;\nmargin-top: 12px;\n}\n#photo-modal-buttons button {\nflex: 1;\nmax-width: 140px;\npadding: 10px;\nfont-size: 1.1rem;\nborder-radius: 12px;\nborder: none;\ncursor: pointer;\nuser-select:none;\ntransition: background 0.3s;\n}\n#photo-tryagain-btn {\nbackground: #b00020;\ncolor: white;\nmargin-right: 12px;\n}\n#photo-tryagain-btn:hover:not(:disabled) {\nbackground: #7a000f;\n}\n#photo-ok-btn {\nbackground: #0077ff;\ncolor: white;\n}\n#photo-ok-btn:hover:not(:disabled) {\nbackground: #005fcc;\n}\n#upload-status {\nmargin-top: 12px;\nmin-height: 18px;\ncolor: #0077ff;\nfont-weight: 600;\ntext-align: center;\n}\n/* Saved Submissions Panel */\n#saved-submissions-panel {\nposition: fixed;\ntop: 0;\nleft: 0;\nwidth: 100vw;\nheight: 100vh;\nbackground: #fff8e1;\nborder: 2px solid #fcbf49;\npadding: 16px;\nbox-sizing: border-box;\ndisplay: none;\nflex-direction: column;\nuser-select:none;\nz-index: 100000;\n}\n#saved-submissions-panel h2 {\nmargin-bottom: 8px;\nfont-weight: 700;\ncolor: #cf8f00;\nfont-size: 1.8rem;\ntext-align: center;\n}\n#saved-submissions-close {\nposition: absolute;\ntop: 12px;\nright: 12px;\nbackground: #ff385c;\nborder: none;\nborder-radius: 100px;\nwidth: 40px;\nheight: 40px;\ncolor: white;\nfont-size: 28px;\nline-height: 40px;\ntext-align: center;\ncursor: pointer;\nbox-shadow: 0 2px 8px rgba(255,56,92,0.6);\ntransition: background 0.3s;\nuser-select:none;\nz-index: 100001;\n}\n#saved-submissions-close:hover {\nbackground: #d72950;\n}\n#pagination-controls {\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\nmargin: 12px 0;\ngap: 8px;\nflex-wrap: wrap;\n}\n#pagination-controls label {\nfont-weight: 700;\nfont-size: 1.1rem;\ncolor: #996700;\n}\n#pagination-controls input[type=date], #pagination-controls input[type=search] {\npadding: 8px 10px;\nfont-size: 1.1rem;\nborder-radius: 8px;\nborder: 1.5px solid #fcbf49;\nwidth: 180px;\nmax-width: 45vw;\nbox-sizing: border-box;\n}\n#saved-submissions-table-wrapper {\nwidth: 100%;\noverflow-x: auto;\n}\n#saved-submissions-table {\nborder-collapse: collapse;\nwidth: 100%;\nmin-width: 400px;\n}\n#saved-submissions-table thead th {\nbackground-color: #fde6a3;\nborder: 1px solid #f0c96e;\npadding: 8px 10px;\nfont-size: 1rem;\nfont-weight: 700;\ntext-align: center;\nwhite-space: nowrap;\nposition: sticky;\ntop: 0;\nz-index: 2;\nmin-width: 90px;\n}\n#saved-submissions-table tbody tr {\ncursor: pointer;\ntransition: background-color 0.2s;\n}\n#saved-submissions-table tbody tr:hover {\nbackground-color: #fffae6;\n}\n#saved-submissions-table tbody td {\nborder: 1px solid #f0c96e;\npadding: 8px 10px;\nfont-size: 1rem;\ntext-align: center;\nwhite-space: nowrap;\noverflow: hidden;\ntext-overflow: ellipsis;\nmin-width: 90px;\n}\n\n.status-pending {\ncolor: #d18e00;\nfont-weight: 700;\n}\n.status-success {\ncolor: #2b7a0b;\nfont-weight: 700;\n}\n.status-failed {\ncolor: #b00020;\nfont-weight: 700;\n}\n.thumbnail-img {\nmax-width: 80px;\nmax-height: 60px;\nborder-radius: 8px;\nobject-fit: contain;\n}\n\n/* Full page modal for patient/location selection */\n#patient-loading-modal {\n  position: fixed;\n  inset: 0;\n  background: rgba(0,0,0,0.6);\n  backdrop-filter: blur(5px);\n  z-index: 120000;\n  overflow: auto;\n  display: none;\n  align-items: center;\n  justify-content: center;\n}\n#patient-loading-modal[aria-hidden=\"false\"] {\n  display: flex;\n}\n#patient-loading-modal-content {\n  background: #fff;\n  max-width: 480px;\n  margin: 40px auto;\n  border-radius: 16px;\n  padding: 24px;\n  box-shadow: 0 4px 16px rgba(0,0,0,0.3);\n  max-height: 90vh;\n  overflow-y: auto;\n  outline: none;\n}\n#patient-loading-modal-close {\n  position: fixed;\n  top: 16px;\n  right: 16px;\n  width: 40px;\n  height: 40px;\n  background: #ff385c;\n  border: none;\n  border-radius: 50%;\n  color: #fff;\n  font-size: 28px;\n  cursor: pointer;\n  z-index: 120001;\n  box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n  transition: background 0.3s;\n  user-select: none;\n}\n#patient-loading-modal-close:hover {\n  background: #d72950;\n}\n</style>\n\n</head>\n<body>\n<div id=\"app\" role=\"main\" aria-label=\"Patient Device Capture App\">\n<header>\n<h1>Patient Device Capture</h1>\n<div style=\"display:flex; align-items:center; gap:8px;\">\n<button id=\"show-submissions-btn\" aria-pressed=\"false\" aria-label=\"Toggle saved submissions panel\">Show Saved Submissions</button>\n</div>\n\n<section id=\"patient-info\" aria-live=\"polite\" aria-atomic=\"true\" aria-label=\"Patient information\" hidden>\n<div><strong id=\"patient-name\"></strong></div>\n<div>MRN: <span id=\"patient-mrn\"></span></div>\n</section>\n\n<section id=\"mrn-section\" aria-label=\"Patient Selection\" style=\"margin-top:12px;\">\n  <button id=\"load-patient-btn\" aria-label=\"Load patient\" >Load Patient</button>\n  <div id=\"mrn-error\"></div>\n</section>\n</header>\n\n<main style=\"flex-grow:1;\">\n<section id=\"devices-section\" aria-label=\"Device selection\" tabindex=\"-1\" hidden>\n<h2>Available Devices</h2>\n<div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n<!-- Device cards inserted dynamically -->\n</div>\n</section>\n\n<section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\" >\n<h2>Capture Device Photo</h2>\n<div id=\"camera-wrapper\">\n<video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n<button id=\"capture-btn\" aria-label=\"Take picture\" title=\"Take Picture\"></button>\n</div>\n<button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n<canvas id=\"canvas\" class=\"hidden\"></canvas>\n<img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n<div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n</section>\n\n<!-- Saved Submissions Panel -->\n<section id=\"saved-submissions-panel\" aria-label=\"Saved Submitted Images\">\n<h2>Saved Submissions</h2>\n<button id=\"saved-submissions-close\" aria-label=\"Close saved submissions panel\" title=\"Close saved submissions panel\" tabindex=\"0\">×</button>\n<div id=\"pagination-controls\">\n<label for=\"date-filter-input\">Select Date:</label>\n<input type=\"date\" id=\"date-filter-input\" aria-label=\"Select submission date\" />\n<label for=\"search-input\">Search:</label>\n<input type=\"search\" id=\"search-input\" placeholder=\"Filter by MRN or Device Name\" aria-label=\"Search submissions\" />\n</div>\n<div id=\"saved-submissions-table-wrapper\">\n<table id=\"saved-submissions-table\" aria-live=\"polite\" aria-relevant=\"all\">\n<thead>\n<tr>\n<th>MRN</th>\n<th>POC</th>\n<th>Date</th>\n<th>Status</th>\n</tr>\n</thead>\n<tbody id=\"saved-submissions-body\" tabindex=\"0\">\n<!-- Entries dynamically inserted -->\n</tbody>\n</table>\n</div>\n</section>\n</main> </div>\n\n<!-- Modal for showing submission details -->\n<div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Submission Details Modal\" tabindex=\"-1\">\n<button id=\"modal-close-btn\" aria-label=\"Close details modal\">×</button>\n<div id=\"modal-detail-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\">\n<!-- Populated dynamically -->\n</div>\n</div>\n\n<!-- Modal to show captured photo and Try Again/Submit buttons -->\n<div id=\"photo-modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Captured Photo Preview\" tabindex=\"-1\">\n<div id=\"photo-modal-content\" tabindex=\"0\">\n<button id=\"photo-modal-close-btn\" aria-label=\"Close photo preview\">×</button>\n<img id=\"photo-modal-img\" alt=\"Captured photo preview\" style=\"max-width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.25);\" />\n<div id=\"photo-modal-buttons\">\n<button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n<button id=\"photo-ok-btn\" aria-label=\"Submit this photo\">Submit</button>\n</div>\n<div id=\"upload-status\"></div>\n</div>\n</div>\n\n<!-- Full-page modal for patient/location select -->\n<div id=\"patient-loading-modal\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Select Patient\" tabindex=\"-1\" aria-hidden=\"true\">\n  <div id=\"patient-loading-modal-content\" tabindex=\"0\" aria-live=\"polite\" aria-atomic=\"true\" ></div>\n  <button id=\"patient-loading-modal-close\" aria-label=\"Close patient selector\" title=\"Close patient selector\">×</button>\n</div>\n\n<script>\n(() => {\n'use strict';\n\n// Elements\nconst loadPatientBtn = document.getElementById('load-patient-btn');\nconst mrnError = document.getElementById('mrn-error');\n\nconst patientInfoSection = document.getElementById('patient-info');\nconst patientNameElem = document.getElementById('patient-name');\nconst patientMrnElem = document.getElementById('patient-mrn');\n\nconst devicesSection = document.getElementById('devices-section');\nconst devicesContainer = document.getElementById('devices-container');\n\nconst cameraSection = document.getElementById('camera-section');\nconst cameraWrapper = document.getElementById('camera-wrapper');\nconst video = document.getElementById('video');\nconst canvas = document.getElementById('canvas');\nconst captureBtn = document.getElementById('capture-btn');\nconst cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n\nconst photoModalOverlay = document.getElementById('photo-modal-overlay');\nconst photoModalContent = document.getElementById('photo-modal-content');\nconst photoModalImg = document.getElementById('photo-modal-img');\nconst photoModalCloseBtn = document.getElementById('photo-modal-close-btn');\nconst photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\nconst photoOkBtn = document.getElementById('photo-ok-btn');\nconst uploadStatus = photoModalContent.querySelector('#upload-status');\n\nconst modalOverlay = document.getElementById('modal-overlay');\nconst modalDetailContent = document.getElementById('modal-detail-content');\nconst modalCloseBtn = document.getElementById('modal-close-btn');\n\nconst showSubmissionsBtn = document.getElementById('show-submissions-btn');\nconst savedSubmissionsPanel = document.getElementById('saved-submissions-panel');\nconst savedSubmissionsBody = document.getElementById('saved-submissions-body');\nconst dateFilterInput = document.getElementById('date-filter-input');\nconst searchInput = document.getElementById('search-input');\nconst savedSubmissionsCloseBtn = document.getElementById('saved-submissions-close');\n\n// New patient loading modal elements\nconst patientLoadingModal = document.getElementById('patient-loading-modal');\nconst patientLoadingModalContent = document.getElementById('patient-loading-modal-content');\nconst patientLoadingModalClose = document.getElementById('patient-loading-modal-close');\n\n// State\nlet currentDevices = [];\nlet selectedDevice = null;\nlet currentMRN = '';\nlet cameraStream = null;\nlet photoBlob = null;\n\nconst STORAGE_KEY = 'patientDeviceSubmissions';\n\n// Utility functions\nfunction clearChildren(el) {\n  while(el.firstChild) el.removeChild(el.firstChild);\n}\n\nfunction setLoading(btn, isLoading, text) {\n  if(isLoading){\n    btn.disabled = true;\n    btn.innerHTML = '<div class=\"loader\" aria-label=\"Loading\"></div>';\n  } else {\n    btn.disabled = false;\n    btn.textContent = text;\n  }\n}\n\nfunction validateMRN(mrn) {\n  return mrn.trim().length > 0;\n}\nfunction showError(msg) {\n  mrnError.textContent = msg;\n}\nfunction clearError() {\n  mrnError.textContent = '';\n}\n\nfunction formatDateTime(timestamp) {\n  const dt = new Date(timestamp);\n  const pad = (n) => n.toString().padStart(2,'0');\n  return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()} \\${pad(dt.getHours())}:\\${pad(dt.getMinutes())}\\`;\n}\n\nfunction formatDate(timestamp) {\n  const dt = new Date(timestamp);\n  const pad = (n) => n.toString().padStart(2,'0');\n  return \\`\\${pad(dt.getMonth()+1)}/\\${pad(dt.getDate())}/\\${dt.getFullYear()}\\`;\n}\n\nasync function fetchPatientInfo(mrn) {\n  try {\n    const res = await fetch('https://xl.epicpc.com/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n      method:'POST',\n      headers: {'Content-Type': 'application/json'},\n      body: JSON.stringify({mrn})\n    });\n    if(!res.ok) throw new Error(\\`Failed: \\${res.status}\\`);\n    const json = await res.json();\n    let patientName = '';\n    if(json && typeof json === 'object') {\n      patientName = json.patientName || json.name || '';\n    }\n    if(patientName) {\n      patientNameElem.textContent = patientName;\n      patientMrnElem.textContent = mrn;\n      patientInfoSection.hidden = false;\n    } else {\n      patientInfoSection.hidden = true;\n    }\n  } catch(e) {\n    patientInfoSection.hidden = true;\n    console.warn('Failed to fetch patient info:', e);\n  }\n}\n\nasync function loadDevices(mrn) {\n  setLoading(loadPatientBtn, true, '');\n  clearError();\n  try {\n    const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n      method: 'POST',\n      headers: {'Content-Type': 'application/json'},\n      body: JSON.stringify({mrn})\n    });\n    if(!res.ok) throw new Error(\\`Server error: \\${res.status}\\`);\n    let devices = await res.json();\n    if(!Array.isArray(devices)) throw new Error('Invalid response');\n    currentDevices = devices;\n    if(currentDevices.length === 0) {\n      showError('No devices found for this patient.');\n      devicesSection.hidden = true;\n      setLoading(loadPatientBtn,false,'Load Patient');\n      return false;\n    }\n    renderDeviceCards(currentDevices);\n    devicesSection.hidden = false;\n    devicesSection.focus();\n    setLoading(loadPatientBtn,false,'Load Patient');\n    return true;\n  } catch(e) {\n    showError('Failed to load devices: ' + e.message);\n    devicesSection.hidden = true;\n    setLoading(loadPatientBtn,false,'Load Patient');\n    return false;\n  }\n}\n\nfunction renderDeviceCards(devices) {\n  clearChildren(devicesContainer);\n  selectedDevice = null;\n  devices.forEach(device => {\n    const card = document.createElement('div');\n    card.classList.add('card');\n    card.role = 'listitem';\n    card.tabIndex = 0;\n    card.setAttribute('aria-label', device.POCEquipment + (device.Description ? ': ' + device.Description : ''));\n    const img = document.createElement('img');\n    img.alt = device.POCEquipment + ' image' || 'Device image';\n    img.src = device.imageurl || '';\n    img.loading = 'lazy';\n    card.appendChild(img);\n    const nameEl = document.createElement('div');\n    nameEl.className = 'device-name';\n    nameEl.textContent = device.POCEquipment;\n    card.appendChild(nameEl);\n    const descEl = document.createElement('div');\n    descEl.className = 'device-desc';\n    descEl.textContent = device.Description || '';\n    card.appendChild(descEl);\n    const openCameraForDevice = () => {\n      selectedDevice = device;\n      devicesSection.hidden = true;\n      cameraSection.classList.remove('hidden');\n      cameraSection.focus();\n\n      photoBlob = null;\n      uploadStatus.textContent = '';\n      photoModalOverlay.style.display = 'none';\n\n      startCamera();\n    };\n    card.addEventListener('click', openCameraForDevice);\n    card.addEventListener('keydown', e => {\n      if(e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        openCameraForDevice();\n      }\n    });\n    devicesContainer.appendChild(card);\n  });\n}\n\nasync function startCamera() {\n  try {\n    if(cameraStream) stopCamera();\n    cameraStream = await navigator.mediaDevices.getUserMedia({\n      video: { facingMode: 'environment', width: {ideal:1280}, height: {ideal:720} },\n      audio: false\n    });\n    video.srcObject = cameraStream;\n    await video.play();\n  } catch(e) {\n    alert('Failed to access camera: ' + e.message);\n    cancelCaptureBtn.click();\n  }\n}\nfunction stopCamera() {\n  if(cameraStream){\n    cameraStream.getTracks().forEach(t => t.stop());\n    cameraStream = null;\n  }\n}\n\ncancelCaptureBtn.addEventListener('click', () => {\n  stopCamera();\n  cameraSection.classList.add('hidden');\n  devicesSection.hidden = false;\n  photoModalOverlay.style.display = 'none';\n});\n\ncaptureBtn.addEventListener('click', takePhoto);\nfunction takePhoto() {\n  if(!cameraStream) return;\n  canvas.width = video.videoWidth;\n  canvas.height = video.videoHeight;\n  const ctx = canvas.getContext('2d');\n  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n  canvas.toBlob(blob => {\n    photoBlob = blob;\n    const url = URL.createObjectURL(blob);\n    photoModalImg.src = url;\n    photoModalOverlay.style.display = 'flex';\n    photoModalContent.focus();\n  }, 'image/jpeg', 0.95);\n}\n\nphotoModalCloseBtn.addEventListener('click', () => {\n  photoModalOverlay.style.display = 'none';\n  if(photoModalImg.src) {\n    URL.revokeObjectURL(photoModalImg.src);\n    photoModalImg.src = '';\n  }\n});\n\nphotoTryAgainBtn.addEventListener('click', () => {\n  photoModalOverlay.style.display = 'none';\n  if(photoModalImg.src) {\n    URL.revokeObjectURL(photoModalImg.src);\n    photoModalImg.src = '';\n  }\n  photoBlob = null;\n  uploadStatus.textContent = '';\n});\n\nphotoOkBtn.addEventListener('click', uploadPhoto);\n\nasync function uploadPhoto() {\n  if (!photoBlob || !selectedDevice || !currentMRN) return;\n  setLoading(photoOkBtn, true, '');\n  uploadStatus.textContent = 'Uploading...';\n  try {\n    const formData = new FormData();\n    formData.append('mrn', currentMRN);\n    formData.append('device', JSON.stringify(selectedDevice));\n    formData.append('photo', photoBlob, 'device.jpg');\n\n    const base64DataUrl = await blobToDataURL(photoBlob);\n    const submissionRecord = {\n      id: Date.now() + '-' + Math.random().toString(36).substr(2, 9),\n      mrn: currentMRN,\n      device: JSON.stringify(selectedDevice),\n      photoDataUrl: base64DataUrl,\n      status: 'Pending',\n      timestamp: Date.now()\n    };\n    addSubmissionRecord(submissionRecord);\n    updateDatePickerRange();\n    renderSavedSubmissions();\n\n    const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n      method: 'POST',\n      body: formData,\n    });\n    if(!res.ok) throw new Error(\\`Upload failed: \\${res.statusText}\\`);\n\n    updateSubmissionStatus(submissionRecord.id, 'Success');\n\n    if(photoModalImg.src) {\n      URL.revokeObjectURL(photoModalImg.src);\n      photoModalImg.src = '';\n    }\n    photoBlob = null;\n\n    uploadStatus.textContent = 'Upload successful!';\n    setTimeout(() => {\n      uploadStatus.textContent = '';\n      photoModalOverlay.style.display = 'none';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n      devicesSection.hidden = false;\n\n      loadDevices(currentMRN);\n    }, 1000);\n  } catch(e) {\n    uploadStatus.textContent = 'Upload failed: ' + e.message;\n    const submissions = loadSavedSubmissions();\n    if(submissions.length > 0){\n      updateSubmissionStatus(submissions[submissions.length-1].id, 'Failed');\n    }\n  }\n  setLoading(photoOkBtn, false, 'Submit');\n}\n\nfunction blobToDataURL(blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onloadend = () => resolve(reader.result);\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n}\n\n// LocalStorage helpers\nfunction loadSavedSubmissions() {\n  try {\n    const dataStr = localStorage.getItem(STORAGE_KEY);\n    if(!dataStr) return [];\n    return JSON.parse(dataStr);\n  } catch(e){\n    console.warn('Failed to parse saved submissions in localStorage', e);\n    return [];\n  }\n}\nfunction saveSubmissions(submissions) {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(submissions));\n  } catch(e){\n    console.warn('Failed to save submissions to localStorage', e);\n  }\n}\nfunction addSubmissionRecord(record) {\n  const submissions = loadSavedSubmissions();\n  submissions.push(record);\n  saveSubmissions(submissions);\n}\nfunction updateSubmissionStatus(id, newStatus) {\n  const submissions = loadSavedSubmissions();\n  const idx = submissions.findIndex(s => s.id === id);\n  if(idx !== -1){\n    submissions[idx].status = newStatus;\n    saveSubmissions(submissions);\n  }\n  renderSavedSubmissions();\n}\n\nfunction renderSavedSubmissions() {\n  const submissions = loadSavedSubmissions();\n  let filtered = submissions;\n\n  if(dateFilterInput.value){\n    const selectedDate = new Date(dateFilterInput.value);\n    filtered = filtered.filter(sub => {\n      const subDate = new Date(sub.timestamp);\n      return subDate.getFullYear() === selectedDate.getFullYear() &&\n             subDate.getMonth() === selectedDate.getMonth() &&\n             subDate.getDate() === selectedDate.getDate();\n    });\n  }\n\n  const searchTerm = searchInput.value.trim().toLowerCase();\n  if(searchTerm) {\n    filtered = filtered.filter(sub => {\n      const deviceObj = JSON.parse(sub.device || '{}');\n      return sub.mrn.toLowerCase().includes(searchTerm) ||\n             (deviceObj.POCEquipment && deviceObj.POCEquipment.toLowerCase().includes(searchTerm));\n    });\n  }\n\n  clearChildren(savedSubmissionsBody);\n  if(filtered.length === 0){\n    const tr = document.createElement('tr');\n    const td = document.createElement('td');\n    td.colSpan = 4;\n    td.textContent = 'No submissions found.';\n    td.style.textAlign = 'center';\n    tr.appendChild(td);\n    savedSubmissionsBody.appendChild(tr);\n    return;\n  }\n  filtered.forEach(sub => {\n    const tr = document.createElement('tr');\n    tr.tabIndex = 0;\n    tr.setAttribute('aria-label', \\`Submission for MRN \\${sub.mrn}, Device: \\${(JSON.parse(sub.device).POCEquipment || '')}, Date: \\${formatDate(sub.timestamp)}, Status: \\${sub.status}\\`);\n    const tdMrn = document.createElement('td');\n    tdMrn.textContent = sub.mrn;\n    const tdDevice = document.createElement('td');\n    try {\n      const deviceObj = JSON.parse(sub.device);\n      tdDevice.textContent = deviceObj.POCEquipment || '';\n    } catch {\n      tdDevice.textContent = '';\n    }\n    const tdDate = document.createElement('td');\n    tdDate.textContent = formatDate(sub.timestamp);\n    const tdStatus = document.createElement('td');\n    tdStatus.textContent = sub.status;\n    tdStatus.classList.add(sub.status === 'Pending' ? 'status-pending' : sub.status === 'Success' ? 'status-success' : 'status-failed');\n    tr.appendChild(tdMrn);\n    tr.appendChild(tdDevice);\n    tr.appendChild(tdDate);\n    tr.appendChild(tdStatus);\n    savedSubmissionsBody.appendChild(tr);\n\n    tr.addEventListener('click', () => {\n      showSubmissionDetails(sub);\n    });\n    tr.addEventListener('keydown', e => {\n      if(e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        showSubmissionDetails(sub);\n      }\n    });\n  });\n}\n\nfunction showSubmissionDetails(submission) {\n  clearChildren(modalDetailContent);\n\n  try {\n    const deviceObj = JSON.parse(submission.device);\n    const title = document.createElement('h3');\n    title.textContent = deviceObj.POCEquipment || 'Device';\n    modalDetailContent.appendChild(title);\n    if(deviceObj.Description){\n      const desc = document.createElement('p');\n      desc.textContent = deviceObj.Description;\n      modalDetailContent.appendChild(desc);\n    }\n  } catch {\n    // noop\n  }\n\n  const mrnP = document.createElement('p');\n  mrnP.textContent = 'MRN: ' + submission.mrn;\n  modalDetailContent.appendChild(mrnP);\n\n  const dateP = document.createElement('p');\n  dateP.textContent = 'Date: ' + formatDateTime(submission.timestamp);\n  modalDetailContent.appendChild(dateP);\n\n  const statusP = document.createElement('p');\n  statusP.textContent = 'Status: ' + submission.status;\n  statusP.className = submission.status === 'Pending' ? 'status-pending' : submission.status === 'Success' ? 'status-success' : 'status-failed';\n  modalDetailContent.appendChild(statusP);\n\n  if(submission.photoDataUrl){\n    const img = document.createElement('img');\n    img.src = submission.photoDataUrl;\n    img.alt = 'Captured photo of device';\n    img.style.maxWidth = '100%';\n    img.style.borderRadius = '14px';\n    img.style.marginTop = '12px';\n    modalDetailContent.appendChild(img);\n  }\n\n  modalOverlay.style.display = 'flex';\n  modalDetailContent.focus();\n}\n\nmodalCloseBtn.addEventListener('click', () => {\n  modalOverlay.style.display = 'none';\n});\n\n\n// -- New patient modal logic --\n\n// Expose function for modal content to call when patient selected\nwindow.onPatientSelected = async function(mrn) {\n  if (!mrn || typeof mrn !== 'string') {\n    showError('Invalid patient MRN selected');\n    return;\n  }\n  closePatientLoadingModal();\n  currentMRN = mrn.trim();\n  mrnError.textContent = '';\n  patientMrnElem.textContent = currentMRN;\n\n  await fetchPatientInfo(currentMRN);\n  await loadDevices(currentMRN);\n};\n\nasync function openPatientLoadingModal() {\n  patientLoadingModal.style.display = 'flex';\n  patientLoadingModal.setAttribute('aria-hidden', 'false');\n  patientLoadingModalContent.innerHTML = '';\n  mrnError.textContent = '';\n  try {\n    setLoading(loadPatientBtn, true, '');\n    const res = await fetch('https://xl.epicpc.com/webhook/db943f99-599c-482b-8b0e-6b83a287e8d9', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ action: 'getLocations' })\n    });\n    if(!res.ok) throw new Error('Failed to load patient selection UI');\n    const htmlText = await res.text();\n    patientLoadingModalContent.innerHTML = htmlText;\n    patientLoadingModalContent.focus();\n  } catch(e) {\n    patientLoadingModalContent.innerHTML = \\`<p style=\"color:red;\">Error loading patient selection: \\${e.message}</p>\\`;\n  } finally {\n    setLoading(loadPatientBtn, false, 'Load Patient');\n  }\n}\n\nfunction closePatientLoadingModal() {\n  patientLoadingModal.style.display = 'none';\n  patientLoadingModal.setAttribute('aria-hidden', 'true');\n  patientLoadingModalContent.innerHTML = '';\n  loadPatientBtn.focus();\n}\n\npatientLoadingModalClose.addEventListener('click', closePatientLoadingModal);\npatientLoadingModal.addEventListener('click', (e) => {\n  if (e.target === patientLoadingModal) {\n    closePatientLoadingModal();\n  }\n});\n\n// Load Patient button opens modal\nloadPatientBtn.addEventListener('click', openPatientLoadingModal);\n\n\n// Show/hide Saved Submissions panel\nshowSubmissionsBtn.addEventListener('click', () => {\n  const visible = savedSubmissionsPanel.style.display === 'flex';\n  if(visible){\n    savedSubmissionsPanel.style.display = 'none';\n    showSubmissionsBtn.textContent = 'Show Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n  } else {\n    savedSubmissionsPanel.style.display = 'flex';\n    showSubmissionsBtn.textContent = 'Hide Saved Submissions';\n    showSubmissionsBtn.setAttribute('aria-pressed', 'true');\n    updateDatePickerRange();\n    renderSavedSubmissions();\n  }\n});\n\nsavedSubmissionsCloseBtn.addEventListener('click', () => {\n  savedSubmissionsPanel.style.display = 'none';\n  showSubmissionsBtn.textContent = 'Show Saved Submissions';\n  showSubmissionsBtn.setAttribute('aria-pressed', 'false');\n});\n\ndateFilterInput.addEventListener('change', () => {\n  renderSavedSubmissions();\n});\n\nsearchInput.addEventListener('input', () => {\n  renderSavedSubmissions();\n});\n\n// Initial load for MRN from URL query param (if any)\nfunction getQueryParam(param) {\n  const urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get(param);\n}\nasync function initialLoad() {\n  const mrnFromUrl = getQueryParam('mrn') || '';\n  if(validateMRN(mrnFromUrl)){\n    currentMRN = mrnFromUrl;\n    patientMrnElem.textContent = currentMRN;\n    await fetchPatientInfo(currentMRN);\n    await loadDevices(currentMRN);\n  }\n}\ninitialLoad();\n\nfunction updateDatePickerRange() {\n  const submissions = loadSavedSubmissions();\n  if(submissions.length === 0){\n    dateFilterInput.min = '';\n    dateFilterInput.max = '';\n    dateFilterInput.value = '';\n    const today = new Date();\n    dateFilterInput.value = today.toISOString().split('T')[0];\n    return;\n  }\n  const timestamps = submissions.map(s => s.timestamp);\n  const minDt = new Date(Math.min(...timestamps));\n  const maxDt = new Date(Math.max(...timestamps));\n  const pad = n => n.toString().padStart(2, '0');\n  dateFilterInput.min = \\`\\${minDt.getFullYear()}-\\${pad(minDt.getMonth()+1)}-\\${pad(minDt.getDate())}\\`;\n  dateFilterInput.max = \\`\\${maxDt.getFullYear()}-\\${pad(maxDt.getMonth()+1)}-\\${pad(maxDt.getDate())}\\`;\n  const today = new Date();\n  const todayStr = today.toISOString().split('T')[0];\n  if(!dateFilterInput.value || dateFilterInput.value < dateFilterInput.min || dateFilterInput.value > dateFilterInput.max){\n    dateFilterInput.value = todayStr;\n  }\n}\n\n})();\n</script>\n</body>\n</html>`\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -360,
        1940
      ],
      "id": "5863bc0d-d389-435e-9fe6-cdcd95151d22",
      "name": "Code13"
    },
    {
      "parameters": {
        "content": "# Get Patients",
        "height": 300,
        "width": 1320,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2860,
        320
      ],
      "id": "097e1db6-faa6-423d-ae2c-cd5d143e600d",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "# Get Devices",
        "height": 320,
        "width": 1360,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2860,
        780
      ],
      "id": "db1c0223-a013-470c-a78d-64c7598d9b58",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "# Add Record to Database",
        "height": 280,
        "width": 1420,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2860,
        1480
      ],
      "id": "b98cf94d-81a6-4605-bfbb-fcea13f5bf8f",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "height": 240,
        "width": 1360
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2860,
        1160
      ],
      "id": "869b4594-5ca7-4e99-89c1-eea26531c860",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "db943f99-599c-482b-8b0e-6b83a287e8d9",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        3020,
        1260
      ],
      "id": "75f4d067-99ec-4c75-93b4-b3376cbe7df2",
      "name": "Webhook6",
      "webhookId": "db943f99-599c-482b-8b0e-6b83a287e8d9"
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "getAll",
        "projectId": "pltr87351hgxdjk",
        "table": "maz6gfzo0vu40pw",
        "returnAll": true,
        "options": {
          "where": "(Field,eq,location)"
        }
      },
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        3240,
        1260
      ],
      "id": "32c2bda2-d200-4407-b0e0-e96fe9c2163b",
      "name": "Get many rows1",
      "credentials": {
        "nocoDbApiToken": {
          "id": "tJrRYhH9PABi968X",
          "name": "NCDB http"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "<h2>Select Location</h2>\n<button id=\"btnWardA\">Ward A</button>\n<button id=\"btnWardB\">Ward B</button>\n\n<div id=\"patients-list\" style=\"margin-top:16px; display: flex; flex-wrap: wrap; gap: 12px;\"></div>\n\n<script>\n  async function loadPatientsForLocation(location) {\n    console.log('Loading patients for:', location);\n    const container = document.getElementById('patients-list');\n    container.innerHTML = '<p>Loading patients for ' + location + '...</p>';\n    try {\n      const res = await fetch('/webhook/529e525f-c819-4520-a8c6-ee412032cd57', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ location })\n      });\n      if (!res.ok) throw new Error('Failed to load patients: ' + res.status);\n      \n      const patients = await res.json();\n\n      let patientList = patients;\n      if (!Array.isArray(patients)) {\n        patientList = [patients];\n      }\n\n      if (patientList.length === 0) {\n        container.innerHTML = '<p>No patients found for ' + location + '</p>';\n        return;\n      }\n\n      container.innerHTML = '';\n\n      patientList.forEach(p => {\n        const card = document.createElement('div');\n        card.style.border = '1px solid #ccc';\n        card.style.borderRadius = '8px';\n        card.style.padding = '12px';\n        card.style.width = '180px';\n        card.style.boxShadow = '0 2px 6px rgba(0,0,0,0.1)';\n        card.style.cursor = 'pointer';\n        card.style.background = '#fafafa';\n\n        const nameEl = document.createElement('div');\n        nameEl.textContent = `${p.Patient_First_Name} ${p.Patient_Last_Name}`;\n        nameEl.style.fontWeight = 'bold';\n        nameEl.style.marginBottom = '6px';\n\n        const mrnEl = document.createElement('div');\n        mrnEl.textContent = 'MRN: ' + p.MRN;\n        mrnEl.style.color = '#555';\n        mrnEl.style.fontSize = '0.9em';\n\n        card.appendChild(nameEl);\n        card.appendChild(mrnEl);\n\n        card.onclick = () => {\n          if (typeof window.onPatientSelected === 'function') {\n            window.onPatientSelected(p.MRN);\n          } else {\n            console.log('Selected MRN:', p.MRN);\n          }\n        };\n\n        container.appendChild(card);\n      });\n\n    } catch (e) {\n      container.innerHTML = '<p style=\"color:red;\">Error: ' + e.message + '</p>';\n    }\n  }\n\n  // Attach event listeners after the modal content loads\n  document.getElementById('btnWardA').addEventListener('click', () => loadPatientsForLocation('Ward A'));\n  document.getElementById('btnWardB').addEventListener('click', () => loadPatientsForLocation('Ward B'));\n</script>",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        3420,
        1260
      ],
      "id": "f0752c54-acd1-4f4c-ab72-da1f3bbd3df4",
      "name": "Respond to Webhook18"
    },
    {
      "parameters": {
        "maxItems": 10
      },
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        3520,
        480
      ],
      "id": "23781227-9a1c-4a79-935d-a560b77da51f",
      "name": "Limit"
    }
  ],
  "pinData": {
    "Webhook1": [
      {
        "json": {
          "headers": {
            "host": "n8n.cybertech.app",
            "user-agent": "Mozilla/5.0 (Linux; Android 14; SM-S928U1 Build/UP1A.231005.007; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/134.0.6998.135 Mobile Safari/537.36",
            "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
            "accept-encoding": "gzip, br",
            "accept-language": "en-US,en;q=0.9",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "2607:fb90:8d26:c09f:74a9:c247:95f2:3ba1",
            "cf-ipcountry": "US",
            "cf-ray": "92b8f1927b4d10d0-ORD",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "cf-warp-tag-id": "ec0ac55f-1097-4c49-abf4-678d9d262e3a",
            "connection": "keep-alive",
            "priority": "u=0, i",
            "sec-ch-ua": "\"Chromium\";v=\"134\", \"Not:A-Brand\";v=\"24\", \"Android WebView\";v=\"134\"",
            "sec-ch-ua-mobile": "?1",
            "sec-ch-ua-platform": "\"Android\"",
            "sec-fetch-dest": "document",
            "sec-fetch-mode": "navigate",
            "sec-fetch-site": "none",
            "sec-fetch-user": "?1",
            "upgrade-insecure-requests": "1",
            "x-forwarded-for": "2607:fb90:8d26:c09f:74a9:c247:95f2:3ba1",
            "x-forwarded-proto": "https",
            "x-requested-with": "app.toms.tomsapp"
          },
          "params": {},
          "query": {},
          "body": {},
          "webhookUrl": "https://n8n.cybertech.app/webhook/e225c70c-13d2-4902-bef9-977e3207b715",
          "executionMode": "production"
        }
      }
    ],
    "Code": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Get many rows": [
      {
        "json": {
          "Id": 1,
          "POCEquipment": "ECG",
          "CreatedAt": "2025-07-29 15:20:07",
          "UpdatedAt": "2025-07-29 15:24:38",
          "Description": "Heart stuff ECG",
          "DevicePicture": [
            {
              "path": "download/noco/pg461bptu3aimnk/mx0a7l9g3403nip/cvn8t7xnfi6yz6b/ecg_oRb-C.svg",
              "title": "ecg.svg",
              "mimetype": "image/svg+xml",
              "size": 1582,
              "signedPath": "dltemp/bLWciGSoAT4mPVza/1753810200000/noco/pg461bptu3aimnk/mx0a7l9g3403nip/cvn8t7xnfi6yz6b/ecg_oRb-C.svg"
            }
          ]
        }
      }
    ],
    "Respond to Webhook15": [
      {
        "json": {
          "Id": 1,
          "POCEquipment": "ECG",
          "CreatedAt": "2025-07-29 15:20:07",
          "UpdatedAt": "2025-07-29 15:24:38",
          "Description": "Heart stuff ECG",
          "DevicePicture": [
            {
              "path": "download/noco/pg461bptu3aimnk/mx0a7l9g3403nip/cvn8t7xnfi6yz6b/ecg_oRb-C.svg",
              "title": "ecg.svg",
              "mimetype": "image/svg+xml",
              "size": 1582,
              "signedPath": "dltemp/bLWciGSoAT4mPVza/1753810200000/noco/pg461bptu3aimnk/mx0a7l9g3403nip/cvn8t7xnfi6yz6b/ecg_oRb-C.svg"
            }
          ],
          "imageurl": "https://ncdb.epicpc.com/dltemp/bLWciGSoAT4mPVza/1753810200000/noco/pg461bptu3aimnk/mx0a7l9g3403nip/cvn8t7xnfi6yz6b/ecg_oRb-C.svg"
        }
      }
    ],
    "Code2": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code3": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code4": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code5": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code6": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code7": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code8": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code9": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code10": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code11": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code12": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Code13": [
      {
        "json": {
          "html": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\" />\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />\n<title>Device Capture</title>\n<style>\n  /* Reset and base */\n  * {\n    box-sizing: border-box;\n    margin: 0; padding: 0;\n  }\n  html, body {\n    height: 100%;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,\n      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    background: #f7f9fc;\n    color: #1a1a1a;\n  }\n  #app {\n    max-width: 480px;\n    margin: auto;\n    padding: 16px;\n  }\n  h1, h2 {\n    font-weight: 600;\n    letter-spacing: 0.05em;\n    color: #222;\n    margin-bottom: 16px;\n  }\n  input[type=text] {\n    width: 100%;\n    padding: 12px;\n    font-size: 1.1rem;\n    border: 1.5px solid #ccc;\n    border-radius: 8px;\n    transition: border-color 0.3s;\n  }\n  input[type=text]:focus {\n    border-color: #0077ff;\n    outline: none;\n  }\n  button {\n    cursor: pointer;\n    background: linear-gradient(135deg, #0077ff, #005fcc);\n    color: white;\n    border: none;\n    padding: 14px 0;\n    font-size: 1.2rem;\n    border-radius: 12px;\n    box-shadow: 0 5px 12px rgba(0, 119, 255, 0.3);\n    transition: background 0.3s, transform 0.15s;\n    width: 100%;\n    margin: 12px 0;\n  }\n  button:hover {\n    background: linear-gradient(135deg, #005fcc, #004bb5);\n    transform: translateY(-2px);\n  }\n  .cards-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 14px;\n  }\n  @media (max-width:400px) {\n    .cards-container {\n      grid-template-columns: 1fr;\n    }\n  }\n  .card {\n    background: white;\n    border-radius: 14px;\n    box-shadow: 0 2px 8px rgba(34, 60, 80, 0.1);\n    padding: 16px;\n    cursor: pointer;\n    transition: transform 0.3s ease, box-shadow 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n    user-select: none;\n  }\n  .card:hover, .card.selected {\n    box-shadow: 0 8px 20px rgba(0,120,220, 0.3);\n    transform: scale(1.05);\n  }\n  .card img {\n    width: 80px;\n    height: 80px;\n    object-fit: contain;\n    margin-bottom: 12px;\n    filter: grayscale(30%);\n    transition: filter 0.3s;\n  }\n  .card.selected img {\n    filter: none;\n  }\n  .device-name {\n    font-weight: 600;\n    font-size: 1.1rem;\n    margin-bottom: 6px;\n    color: #004bb5;\n  }\n  .device-desc {\n    font-size: 0.85rem;\n    color: #555;\n  }\n  #camera-section {\n    margin-top: 24px;\n  }\n  video {\n    width: 100%;\n    border-radius: 16px;\n    background: black;\n  }\n  #capture-btns {\n    display: flex;\n    justify-content: space-around;\n    margin-top: 12px;\n  }\n  #capture-btns button {\n    flex-grow: 1;\n    margin: 0 6px;\n  }\n  #captured-photo {\n    width: 100%;\n    margin-top: 12px;\n    border-radius: 16px;\n    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.15);\n  }\n  .hidden {\n    display: none;\n  }\n  /* Loader */\n  .loader {\n    border: 5px solid #f3f3f3;\n    border-top: 5px solid #0077ff;\n    border-radius: 50%;\n    width: 36px;\n    height: 36px;\n    animation: spin 1.1s linear infinite;\n    margin: 24px auto;\n  }\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n  /* Modal for returned HTML */\n  #modal-overlay {\n    position: fixed;\n    inset: 0;\n    background: rgba(0,0,0,0.5);\n    backdrop-filter: blur(4px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 9999;\n  }\n  #modal-content {\n    background: white;\n    border-radius: 14px;\n    max-width: 95vw;\n    max-height: 90vh;\n    overflow: auto;\n    padding: 16px;\n    box-shadow: 0 8px 28px rgba(0,0,0,0.35);\n    animation: fadeInScale 0.35s ease forwards;\n  }\n  @keyframes fadeInScale {\n    0% {opacity: 0; transform: scale(0.85);}\n    100% {opacity: 1; transform: scale(1);}\n  }\n  #modal-close-btn {\n    position: fixed;\n    top: 12px;\n    right: 12px;\n    background: #ff385c;\n    border: none;\n    border-radius: 100px;\n    width: 40px;\n    height: 40px;\n    color: white;\n    font-size: 24px;\n    line-height: 40px;\n    text-align: center;\n    cursor: pointer;\n    box-shadow: 0 2px 8px rgba(255,56,92,0.6);\n    z-index: 10000;\n    transition: background 0.3s;\n  }\n  #modal-close-btn:hover {\n    background: #d72950;\n  }\n</style>\n</head>\n<body>\n  <div id=\"app\" role=\"main\" aria-label=\"Device Capture App\">\n    <h1>Patient Device Capture</h1>\n\n    <!-- Step 1: Enter/Scan Patient MRN (from QR) -->\n    <section id=\"mrn-section\" aria-label=\"Patient MRN Input\">\n      <label for=\"mrn-input\" style=\"font-weight:600; margin-bottom:8px; display:block;\">Scan or Enter Patient MRN:</label>\n      <input type=\"text\" id=\"mrn-input\" autocomplete=\"off\" inputmode=\"text\" aria-required=\"true\" placeholder=\"MRN from QR Code\" />\n      <button id=\"load-devices-btn\" aria-label=\"Load devices for patient\">Load Devices</button>\n      <div id=\"mrn-error\" style=\"color:#b00020; margin-top:8px; min-height:18px;\"></div>\n    </section>\n\n    <!-- Step 2: Display devices -->\n    <section id=\"devices-section\" aria-label=\"Device selection\" class=\"hidden\" tabindex=\"-1\">\n      <h2>Select Device</h2>\n      <div class=\"cards-container\" id=\"devices-container\" role=\"list\">\n        <!-- cards inserted dynamically -->\n      </div>\n      <button id=\"confirm-device-btn\" disabled aria-disabled=\"true\" aria-label=\"Confirm selected device\">Confirm Device</button>\n    </section>\n\n    <!-- Step 3: Camera capture -->\n    <section id=\"camera-section\" class=\"hidden\" aria-label=\"Take a photo of device\" tabindex=\"-1\">\n      <h2>Capture Device Photo</h2>\n      <video id=\"video\" autoplay playsinline aria-label=\"Camera preview\"></video>\n      <canvas id=\"canvas\" class=\"hidden\"></canvas>\n\n      <div id=\"capture-btns\">\n        <button id=\"capture-btn\" aria-label=\"Take picture\">Take Picture</button>\n        <button id=\"cancel-capture-btn\" aria-label=\"Cancel capture\">Cancel</button>\n      </div>\n\n      <img id=\"captured-photo\" alt=\"Captured photo preview\" class=\"hidden\" />\n      <div id=\"photo-controls\" class=\"hidden\" style=\"display:flex; justify-content:space-around; margin-top:12px;\">\n        <button id=\"photo-tryagain-btn\" aria-label=\"Try taking photo again\">Try Again</button>\n        <button id=\"photo-ok-btn\" aria-label=\"Confirm this photo\">OK</button>\n      </div>\n      <div id=\"upload-status\" style=\"margin-top:12px; min-height:18px; color:#0077ff; font-weight:600;\"></div>\n    </section>\n  </div>\n\n  <!-- Modal for returned HTML/CSS/JS -->\n  <div id=\"modal-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Result Modal\">\n    <button id=\"modal-close-btn\" aria-label=\"Close result modal\">×</button>\n    <iframe id=\"modal-content\" sandbox=\"allow-scripts allow-same-origin\" frameborder=\"0\" aria-live=\"polite\"></iframe>\n  </div>\n\n<script>\n(() => {\n  'use strict';\n  const mrnInput = document.getElementById('mrn-input');\n  const loadDevicesBtn = document.getElementById('load-devices-btn');\n  const mrnError = document.getElementById('mrn-error');\n  const devicesSection = document.getElementById('devices-section');\n  const devicesContainer = document.getElementById('devices-container');\n  const confirmDeviceBtn = document.getElementById('confirm-device-btn');\n  const cameraSection = document.getElementById('camera-section');\n  const video = document.getElementById('video');\n  const canvas = document.getElementById('canvas');\n  const captureBtn = document.getElementById('capture-btn');\n  const cancelCaptureBtn = document.getElementById('cancel-capture-btn');\n  const capturedPhoto = document.getElementById('captured-photo');\n  const photoControls = document.getElementById('photo-controls');\n  const photoTryAgainBtn = document.getElementById('photo-tryagain-btn');\n  const photoOkBtn = document.getElementById('photo-ok-btn');\n  const uploadStatus = document.getElementById('upload-status');\n  const modalOverlay = document.getElementById('modal-overlay');\n  const modalContent = document.getElementById('modal-content');\n  const modalCloseBtn = document.getElementById('modal-close-btn');\n\n  let currentDevices = [];\n  let selectedDevice = null;\n  let currentMRN = '';\n  let stream = null;\n  let photoBlob = null;\n\n  function clearChildren(el) {\n    while(el.firstChild) el.removeChild(el.firstChild);\n  }\n  function setLoading(btn, isLoading, text) {\n    if(isLoading){\n      btn.disabled = true;\n      btn.textContent = 'Loading...';\n    } else {\n      btn.disabled = false;\n      btn.textContent = text;\n    }\n  }\n\n  function validateMRN(mrn) {\n    return mrn.trim().length > 0;\n  }\n\n  function showError(msg) {\n    mrnError.textContent = msg;\n  }\n  function clearError() {\n    mrnError.textContent = '';\n  }\n\n  async function loadDevices(mrn) {\n    setLoading(loadDevicesBtn, true, '');\n    showError('');\n    try {\n      const res = await fetch('https://xl.epicpc.com/webhook/46551f79-7e2c-4222-8c14-8eb335257994', {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify({mrn})\n      });\n      if(!res.ok) throw new Error(`Server error: ${res.status}`);\n      const json = await res.json();\n      if(!Array.isArray(json.devices)) {\n        throw new Error('Invalid response format: devices array missing');\n      }\n      currentDevices = json.devices;\n      if(currentDevices.length === 0) {\n        showError('No devices found for this patient.');\n        setLoading(loadDevicesBtn,false,'Load Devices');\n        return false;\n      }\n      renderDeviceCards(currentDevices);\n      devicesSection.classList.remove('hidden');\n      devicesSection.focus();\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return true;\n    } catch (e) {\n      showError('Failed to load devices: ' + e.message);\n      setLoading(loadDevicesBtn,false,'Load Devices');\n      return false;\n    }\n  }\n\n  function renderDeviceCards(devices) {\n    clearChildren(devicesContainer);\n    selectedDevice = null;\n    confirmDeviceBtn.disabled = true;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'true');\n    devices.forEach((device, i) => {\n      const card = document.createElement('div');\n      card.classList.add('card');\n      card.role = 'listitem';\n      card.tabIndex = 0;\n      card.setAttribute('aria-selected', 'false');\n\n      const img = document.createElement('img');\n      img.alt = device.name + ' image' || 'Device image';\n      img.src = device.picture || '';\n      img.loading = 'lazy';\n      card.appendChild(img);\n\n      const nameEl = document.createElement('div');\n      nameEl.className = 'device-name';\n      nameEl.textContent = device.name;\n      card.appendChild(nameEl);\n\n      const descEl = document.createElement('div');\n      descEl.className = 'device-desc';\n      descEl.textContent = device.description || '';\n      card.appendChild(descEl);\n\n      card.addEventListener('click', () => selectDevice(i));\n      card.addEventListener('keydown', (e) => {\n        if(e.key === 'Enter' || e.key ===' ') {\n          e.preventDefault();\n          selectDevice(i);\n        }\n      });\n      devicesContainer.appendChild(card);\n    });\n  }\n\n  function selectDevice(index) {\n    selectedDevice = currentDevices[index];\n    [...devicesContainer.children].forEach((card,i) => {\n      if(i===index){\n        card.classList.add('selected');\n        card.setAttribute('aria-selected', 'true');\n      } else {\n        card.classList.remove('selected');\n        card.setAttribute('aria-selected', 'false');\n      }\n    });\n    confirmDeviceBtn.disabled = false;\n    confirmDeviceBtn.setAttribute('aria-disabled', 'false');\n  }\n\n  confirmDeviceBtn.addEventListener('click', () => {\n    if(!selectedDevice) return;\n    devicesSection.classList.add('hidden');\n    cameraSection.classList.remove('hidden');\n    cameraSection.focus();\n    startCamera();\n  });\n\n  cancelCaptureBtn.addEventListener('click', () => {\n    stopCamera();\n    cameraSection.classList.add('hidden');\n    devicesSection.classList.remove('hidden');\n  });\n  captureBtn.addEventListener('click', takePhoto);\n  photoTryAgainBtn.addEventListener('click', () => {\n    capturedPhoto.classList.add('hidden');\n    photoControls.classList.add('hidden');\n    captureBtn.classList.remove('hidden');\n    video.classList.remove('hidden');\n    uploadStatus.textContent = '';\n    photoBlob = null;\n  });\n  photoOkBtn.addEventListener('click', uploadPhoto);\n\n  modalCloseBtn.addEventListener('click', () => {\n    modalOverlay.style.display = 'none';\n    modalContent.srcdoc = '';\n  });\n\n  async function startCamera() {\n    try {\n      if(stream) stopCamera();\n      stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: 'environment',\n          width: {ideal: 1280},\n          height: {ideal: 720}\n        },\n        audio: false\n      });\n      video.srcObject = stream;\n    } catch(e) {\n      alert('Failed to access camera: ' + e.message);\n      cancelCaptureBtn.click();\n    }\n  }\n\n  function stopCamera() {\n    if(stream){\n      stream.getTracks().forEach(track => track.stop());\n      stream = null;\n    }\n  }\n\n  function takePhoto() {\n    if(!stream) return;\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      photoBlob = blob;\n      const url = URL.createObjectURL(blob);\n      capturedPhoto.src = url;\n      capturedPhoto.classList.remove('hidden');\n      photoControls.classList.remove('hidden');\n      captureBtn.classList.add('hidden');\n      video.classList.add('hidden');\n    }, 'image/jpeg', 0.95);\n  }\n\n  async function uploadPhoto() {\n    if(!photoBlob || !selectedDevice || !currentMRN) return;\n    uploadStatus.textContent = '';\n    setLoading(photoOkBtn, true, 'Uploading...');\n    try {\n      const formData = new FormData();\n      formData.append('mrn', currentMRN);\n      formData.append('device', JSON.stringify(selectedDevice));\n      formData.append('photo', photoBlob, 'device.jpg');\n\n      const res = await fetch('https://xl.epicpc.com/webhook/29fcc38d-2ae6-45f4-bce2-b6097cf84c55', {\n        method: 'POST',\n        body: formData,\n      });\n      if(!res.ok) throw new Error(`Upload failed: ${res.statusText}`);\n      const html = await res.text();\n\n      modalContent.srcdoc = html;\n      modalOverlay.style.display = 'flex';\n      stopCamera();\n      cameraSection.classList.add('hidden');\n    } catch(e) {\n      uploadStatus.textContent = 'Upload failed: ' + e.message;\n    }\n    setLoading(photoOkBtn, false, 'OK');\n  }\n\n  loadDevicesBtn.addEventListener('click', async () => {\n    const mrn = mrnInput.value.trim();\n    if(!validateMRN(mrn)) {\n      showError('Please enter a valid MRN.');\n      return;\n    }\n    clearError();\n    currentMRN = mrn;\n    await loadDevices(mrn);\n  });\n\n  mrnInput.addEventListener('keyup', (e) => {\n    if(e.key === 'Enter'){\n      loadDevicesBtn.click();\n    }\n  });\n\n  modalOverlay.addEventListener('keydown', (e) => {\n    if(e.key === 'Escape') {\n      modalCloseBtn.click();\n    }\n  });\n})();\n</script>\n</body>\n</html>"
        }
      }
    ],
    "Paitents": [
      {
        "json": {
          "MRN": "037505",
          "Patient_First_Name": "KEARA",
          "Patient_Last_Name": "MCBRIDE",
          "Patient_DOB": "04-30-2001",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "000432",
          "Patient_First_Name": "SHIRLEY",
          "Patient_Last_Name": "DREW",
          "Patient_DOB": "01-15-1959",
          "Appt_DateTime": "2025-07-29T08:30:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "004313",
          "Patient_First_Name": "BARBARA",
          "Patient_Last_Name": "DAJAS",
          "Patient_DOB": "03-21-1961",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "045831",
          "Patient_First_Name": "WALTER",
          "Patient_Last_Name": "GRASSI",
          "Patient_DOB": "10-21-1960",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "004608",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "STILL",
          "Patient_DOB": "01-15-1945",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "049022",
          "Patient_First_Name": "WARREN",
          "Patient_Last_Name": "MORCHE",
          "Patient_DOB": "11-02-1968",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "059617",
          "Patient_First_Name": "NATALEE",
          "Patient_Last_Name": "HILL",
          "Patient_DOB": "03-25-1976",
          "Appt_DateTime": "2025-07-29T14:30:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "050581",
          "Patient_First_Name": "FRED",
          "Patient_Last_Name": "SHEARER",
          "Patient_DOB": "01-30-1954",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "005105",
          "Patient_First_Name": "KIMBERLY",
          "Patient_Last_Name": "PIERCE",
          "Patient_DOB": "09-26-1973",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "053885",
          "Patient_First_Name": "JOSEPH",
          "Patient_Last_Name": "DEMPSEY",
          "Patient_DOB": "02-18-2008",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "055554",
          "Patient_First_Name": "TANYA",
          "Patient_Last_Name": "BALL",
          "Patient_DOB": "12-18-1972",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "055713",
          "Patient_First_Name": "SONIA",
          "Patient_Last_Name": "SPRAGINS",
          "Patient_DOB": "01-22-1967",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Riggins NP, Valerie",
          "Appt_Resource_Assoc_Prov_LFI": "Riggins, Valerie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "005469",
          "Patient_First_Name": "GAIL",
          "Patient_Last_Name": "SHEDRICK",
          "Patient_DOB": "02-27-1967",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "057401",
          "Patient_First_Name": "GREGORY",
          "Patient_Last_Name": "SANTIKIAN",
          "Patient_DOB": "06-13-1980",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "005718",
          "Patient_First_Name": "KRISTA",
          "Patient_Last_Name": "BIEDUL",
          "Patient_DOB": "10-10-1972",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "059007",
          "Patient_First_Name": "THOMAS",
          "Patient_Last_Name": "MURPHY JR",
          "Patient_DOB": "11-28-1988",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "005944",
          "Patient_First_Name": "VICTORIA",
          "Patient_Last_Name": "STEWART",
          "Patient_DOB": "03-31-1960",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "063664",
          "Patient_First_Name": "JANET",
          "Patient_Last_Name": "HALE",
          "Patient_DOB": "02-13-1955",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "065071",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "KARAMANOS",
          "Patient_DOB": "06-28-1971",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "065249",
          "Patient_First_Name": "MAUREEN",
          "Patient_Last_Name": "MAHONEY",
          "Patient_DOB": "11-30-1981",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "066248",
          "Patient_First_Name": "BYRON",
          "Patient_Last_Name": "SHELBY",
          "Patient_DOB": "05-02-1981",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Tourlaeva NP, Alyona",
          "Appt_Resource_Assoc_Prov_LFI": "Tourlaeva, Alyona",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "066622",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "DOUGHERTY",
          "Patient_DOB": "10-05-1958",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "069546",
          "Patient_First_Name": "RAMEY",
          "Patient_Last_Name": "HAMILTON",
          "Patient_DOB": "11-10-1998",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "007928",
          "Patient_First_Name": "PAULA",
          "Patient_Last_Name": "CARR",
          "Patient_DOB": "10-09-1966",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "009913",
          "Patient_First_Name": "ELIZABETH",
          "Patient_Last_Name": "DYER",
          "Patient_DOB": "03-04-1962",
          "Appt_DateTime": "2025-07-29T10:25:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "010481",
          "Patient_First_Name": "MARK",
          "Patient_Last_Name": "ENGLAND",
          "Patient_DOB": "05-22-1965",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "010553",
          "Patient_First_Name": "DREUX",
          "Patient_Last_Name": "KAPUT",
          "Patient_DOB": "10-14-1962",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "010457",
          "Patient_First_Name": "MICHAEL",
          "Patient_Last_Name": "SIMMS",
          "Patient_DOB": "12-05-1971",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "94380",
          "Patient_First_Name": "ALFRED",
          "Patient_Last_Name": "TAYLOR JR",
          "Patient_DOB": "09-09-1944",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "112590",
          "Patient_First_Name": "SHIRLEY",
          "Patient_Last_Name": "WEBB",
          "Patient_DOB": "07-17-1963",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "124000",
          "Patient_First_Name": "DAWN",
          "Patient_Last_Name": "ORCUTT",
          "Patient_DOB": "03-01-1961",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "135010",
          "Patient_First_Name": "MICHAEL",
          "Patient_Last_Name": "MARTIN JR",
          "Patient_DOB": "09-17-1972",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "137960",
          "Patient_First_Name": "JEFFEREY",
          "Patient_Last_Name": "FORD",
          "Patient_DOB": "01-27-1972",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "162640",
          "Patient_First_Name": "GARY",
          "Patient_Last_Name": "GROSS",
          "Patient_DOB": "07-28-1938",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "175430",
          "Patient_First_Name": "CORDELL",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "02-27-1980",
          "Appt_DateTime": "2025-07-29T17:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "177260",
          "Patient_First_Name": "ANN",
          "Patient_Last_Name": "HELTON",
          "Patient_DOB": "04-22-1970",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "180980",
          "Patient_First_Name": "KATHLEEN",
          "Patient_Last_Name": "DALY",
          "Patient_DOB": "07-26-1965",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "BH - Karen",
          "Appt_Resource_Assoc_Prov_LFI": "Nugent, Karen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "186430",
          "Patient_First_Name": "JOSEPH",
          "Patient_Last_Name": "PINTAR",
          "Patient_DOB": "02-01-1972",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "BH - Rose B.",
          "Appt_Resource_Assoc_Prov_LFI": "Psychotherapy, Ferndale",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "191480",
          "Patient_First_Name": "JEFFERY",
          "Patient_Last_Name": "GOUGEON",
          "Patient_DOB": "03-04-1957",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "192020",
          "Patient_First_Name": "PATRICIA",
          "Patient_Last_Name": "VANBUREN",
          "Patient_DOB": "02-10-1952",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "192320",
          "Patient_First_Name": "JUSTIN",
          "Patient_Last_Name": "WOODARD",
          "Patient_DOB": "02-02-1971",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "195650",
          "Patient_First_Name": "SCOTT",
          "Patient_Last_Name": "HAGEN",
          "Patient_DOB": "03-30-1972",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "198620",
          "Patient_First_Name": "JENNIFER",
          "Patient_Last_Name": "BRIGHT",
          "Patient_DOB": "07-13-1972",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "206490",
          "Patient_First_Name": "JANICE",
          "Patient_Last_Name": "GLIDDEN",
          "Patient_DOB": "03-13-1963",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Gray, Jacquis",
          "Appt_Resource_Assoc_Prov_LFI": "Gray, Jacquis",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "207220",
          "Patient_First_Name": "CHARLOTTE",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "01-14-1971",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "211950",
          "Patient_First_Name": "LAKIESHA",
          "Patient_Last_Name": "BENJAMIN-KING",
          "Patient_DOB": "03-04-1976",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "212580",
          "Patient_First_Name": "AMY",
          "Patient_Last_Name": "MITCHELL",
          "Patient_DOB": "04-04-1982",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "212620",
          "Patient_First_Name": "WILLIAM",
          "Patient_Last_Name": "BRYANT",
          "Patient_DOB": "07-15-1979",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "220720",
          "Patient_First_Name": "STEPHANIE",
          "Patient_Last_Name": "CAPTAIN",
          "Patient_DOB": "01-19-1970",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "220720",
          "Patient_First_Name": "STEPHANIE",
          "Patient_Last_Name": "CAPTAIN",
          "Patient_DOB": "01-19-1970",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "226290",
          "Patient_First_Name": "EDWARD",
          "Patient_Last_Name": "GUNDER",
          "Patient_DOB": "03-11-1948",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "227290",
          "Patient_First_Name": "TAMARA",
          "Patient_Last_Name": "SANDERS NOLAN",
          "Patient_DOB": "05-15-1981",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "BH - Rose B.",
          "Appt_Resource_Assoc_Prov_LFI": "Psychotherapy, Ferndale",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "234000",
          "Patient_First_Name": "IRASEMA",
          "Patient_Last_Name": "CONTRERAS",
          "Patient_DOB": "07-04-1977",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "235870",
          "Patient_First_Name": "ROBYN",
          "Patient_Last_Name": "HIVELY",
          "Patient_DOB": "07-27-1960",
          "Appt_DateTime": "2025-07-29T13:45:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "237091",
          "Patient_First_Name": "TRACEY",
          "Patient_Last_Name": "ATWATER",
          "Patient_DOB": "08-05-1971",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "237520",
          "Patient_First_Name": "ANN",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "06-01-1950",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "239240",
          "Patient_First_Name": "LAMAN",
          "Patient_Last_Name": "KALLABAT",
          "Patient_DOB": "09-30-1962",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "241110",
          "Patient_First_Name": "LUKE",
          "Patient_Last_Name": "JACOTA",
          "Patient_DOB": "09-13-1973",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "247370",
          "Patient_First_Name": "ANDREW",
          "Patient_Last_Name": "WEEKS",
          "Patient_DOB": "11-19-1963",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "249700",
          "Patient_First_Name": "NATHAN",
          "Patient_Last_Name": "STRINGER JR",
          "Patient_DOB": "02-22-1957",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "251770",
          "Patient_First_Name": "YASMEEN",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "06-16-1979",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "254070",
          "Patient_First_Name": "MARTIN",
          "Patient_Last_Name": "MOORE",
          "Patient_DOB": "01-28-1962",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "254410",
          "Patient_First_Name": "JUDITH",
          "Patient_Last_Name": "HOLLAND",
          "Patient_DOB": "06-15-1953",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "255120",
          "Patient_First_Name": "CHRISTINE",
          "Patient_Last_Name": "GEISER",
          "Patient_DOB": "08-14-1965",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "256870",
          "Patient_First_Name": "SONYA",
          "Patient_Last_Name": "PITTMAN",
          "Patient_DOB": "05-04-1968",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "263500",
          "Patient_First_Name": "BRIAN",
          "Patient_Last_Name": "ELYAS",
          "Patient_DOB": "04-17-1965",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "264730",
          "Patient_First_Name": "TY",
          "Patient_Last_Name": "NGUYEN",
          "Patient_DOB": "08-12-1964",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "268440",
          "Patient_First_Name": "PAUL",
          "Patient_Last_Name": "BILLINGS",
          "Patient_DOB": "06-17-1972",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "271020",
          "Patient_First_Name": "CHRISTIAN",
          "Patient_Last_Name": "SHUMYLO",
          "Patient_DOB": "10-29-1995",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "276110",
          "Patient_First_Name": "SHEILA",
          "Patient_Last_Name": "GADDIE",
          "Patient_DOB": "04-23-1957",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "276820",
          "Patient_First_Name": "TA-TANISHA",
          "Patient_Last_Name": "FARRIES",
          "Patient_DOB": "10-22-1972",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "277330",
          "Patient_First_Name": "BEVERLY",
          "Patient_Last_Name": "WINDER",
          "Patient_DOB": "06-14-1958",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "278330",
          "Patient_First_Name": "JONATHAN",
          "Patient_Last_Name": "BELL",
          "Patient_DOB": "02-28-1959",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "283630",
          "Patient_First_Name": "DANIALE",
          "Patient_Last_Name": "LINDSEY",
          "Patient_DOB": "01-09-1969",
          "Appt_DateTime": "2025-07-29T09:15:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "284830",
          "Patient_First_Name": "KRISTINE",
          "Patient_Last_Name": "COOK",
          "Patient_DOB": "06-02-1969",
          "Appt_DateTime": "2025-07-29T15:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "288090",
          "Patient_First_Name": "DONOVAN",
          "Patient_Last_Name": "SELPH",
          "Patient_DOB": "05-28-2003",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Riggins NP, Valerie",
          "Appt_Resource_Assoc_Prov_LFI": "Riggins, Valerie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "289980",
          "Patient_First_Name": "LATRICE",
          "Patient_Last_Name": "HOPWOOD",
          "Patient_DOB": "10-04-1982",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "291250",
          "Patient_First_Name": "LASHAE",
          "Patient_Last_Name": "MCFADDEN",
          "Patient_DOB": "03-05-1987",
          "Appt_DateTime": "2025-07-29T14:50:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Benti",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/CAROTID",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "291840",
          "Patient_First_Name": "DEMETRIUS",
          "Patient_Last_Name": "PARKER",
          "Patient_DOB": "05-30-1974",
          "Appt_DateTime": "2025-07-29T14:10:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "291840",
          "Patient_First_Name": "DEMETRIUS",
          "Patient_Last_Name": "PARKER",
          "Patient_DOB": "05-30-1974",
          "Appt_DateTime": "2025-07-29T14:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "294820",
          "Patient_First_Name": "DENISE",
          "Patient_Last_Name": "WATKINS",
          "Patient_DOB": "08-04-1964",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Gray, Jacquis",
          "Appt_Resource_Assoc_Prov_LFI": "Gray, Jacquis",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "299230",
          "Patient_First_Name": "WILLIAM",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "01-03-1944",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "299570",
          "Patient_First_Name": "TERRANCE",
          "Patient_Last_Name": "MILTON",
          "Patient_DOB": "02-24-1981",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Allergy Testing",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "307990",
          "Patient_First_Name": "PAMELA",
          "Patient_Last_Name": "TUGGLE",
          "Patient_DOB": "07-14-1955",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "310260",
          "Patient_First_Name": "PAUL",
          "Patient_Last_Name": "MONTGOMERY",
          "Patient_DOB": "12-24-1962",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "311380",
          "Patient_First_Name": "ALICIA",
          "Patient_Last_Name": "DYER",
          "Patient_DOB": "07-12-1978",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "311950",
          "Patient_First_Name": "JOSEPH",
          "Patient_Last_Name": "WATKINS",
          "Patient_DOB": "07-05-1979",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "313000",
          "Patient_First_Name": "KIMBERLY",
          "Patient_Last_Name": "REDD-PHILLIPS",
          "Patient_DOB": "04-13-1970",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "314300",
          "Patient_First_Name": "SHUNICE",
          "Patient_Last_Name": "SPEARMAN",
          "Patient_DOB": "10-10-1987",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit W Davison",
          "Appt_Resource_Descr": "Baugh PA, Leslie",
          "Appt_Resource_Assoc_Prov_LFI": "Baugh, Leslie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "314880",
          "Patient_First_Name": "BONITA",
          "Patient_Last_Name": "HERZFELD",
          "Patient_DOB": "10-06-1947",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "315410",
          "Patient_First_Name": "SARAH",
          "Patient_Last_Name": "WOOD",
          "Patient_DOB": "02-01-1991",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "316370",
          "Patient_First_Name": "WILLIAM",
          "Patient_Last_Name": "EDELEN",
          "Patient_DOB": "01-22-1992",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "318250",
          "Patient_First_Name": "CHARLES",
          "Patient_Last_Name": "HUBER",
          "Patient_DOB": "09-30-1973",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "320550",
          "Patient_First_Name": "ELANA",
          "Patient_Last_Name": "ARRINGTON",
          "Patient_DOB": "12-14-1973",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "326390",
          "Patient_First_Name": "KENDALL",
          "Patient_Last_Name": "HARRIS",
          "Patient_DOB": "05-28-1997",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "327740",
          "Patient_First_Name": "RACHEL",
          "Patient_Last_Name": "DUFRESNE",
          "Patient_DOB": "05-02-1990",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "328010",
          "Patient_First_Name": "AMONI",
          "Patient_Last_Name": "DAWSON",
          "Patient_DOB": "06-16-2005",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit W Davison",
          "Appt_Resource_Descr": "Baugh PA, Leslie",
          "Appt_Resource_Assoc_Prov_LFI": "Baugh, Leslie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "330360",
          "Patient_First_Name": "DOROTHYMAE",
          "Patient_Last_Name": "BELL",
          "Patient_DOB": "11-18-1949",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "338590",
          "Patient_First_Name": "KELSEY",
          "Patient_Last_Name": "BONEY",
          "Patient_DOB": "07-30-1993",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "342840",
          "Patient_First_Name": "JOSHUA",
          "Patient_Last_Name": "KASSABIAN",
          "Patient_DOB": "02-14-1986",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "347540",
          "Patient_First_Name": "CHARLES",
          "Patient_Last_Name": "HENDON",
          "Patient_DOB": "04-07-1970",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "349190",
          "Patient_First_Name": "TANISHA",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "03-15-1983",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "352990",
          "Patient_First_Name": "JANET",
          "Patient_Last_Name": "MARBURY",
          "Patient_DOB": "03-21-1960",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "353260",
          "Patient_First_Name": "LISA",
          "Patient_Last_Name": "COUSINEAU",
          "Patient_DOB": "12-06-1977",
          "Appt_DateTime": "2025-07-29T08:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "DPT - Garavaglia, Scott",
          "Appt_Resource_Assoc_Prov_LFI": "Therapy, Physical",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "354830",
          "Patient_First_Name": "RACHEL",
          "Patient_Last_Name": "STONE-SHISSLER",
          "Patient_DOB": "04-10-1986",
          "Appt_DateTime": "2025-07-29T08:10:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "355160",
          "Patient_First_Name": "ANITA",
          "Patient_Last_Name": "THOMPSON",
          "Patient_DOB": "09-22-1950",
          "Appt_DateTime": "2025-07-29T11:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "355160",
          "Patient_First_Name": "ANITA",
          "Patient_Last_Name": "THOMPSON",
          "Patient_DOB": "09-22-1950",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "357100",
          "Patient_First_Name": "TIANA",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "05-28-2000",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "357930",
          "Patient_First_Name": "GABRIELLE",
          "Patient_Last_Name": "SAROKI",
          "Patient_DOB": "02-01-1988",
          "Appt_DateTime": "2025-07-29T10:10:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "358800",
          "Patient_First_Name": "SHANICE",
          "Patient_Last_Name": "FUQUA",
          "Patient_DOB": "06-17-1986",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "361880",
          "Patient_First_Name": "LORENA",
          "Patient_Last_Name": "BRADFORD",
          "Patient_DOB": "07-01-1971",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Gray, Jacquis",
          "Appt_Resource_Assoc_Prov_LFI": "Gray, Jacquis",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "361880",
          "Patient_First_Name": "LORENA",
          "Patient_Last_Name": "BRADFORD",
          "Patient_DOB": "07-01-1971",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "365180",
          "Patient_First_Name": "NICOLE",
          "Patient_Last_Name": "PATTERSON",
          "Patient_DOB": "03-24-1976",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "366700",
          "Patient_First_Name": "TRACY",
          "Patient_Last_Name": "WILLIS",
          "Patient_DOB": "07-22-1983",
          "Appt_DateTime": "2025-07-29T15:30:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "371700",
          "Patient_First_Name": "DERRICK",
          "Patient_Last_Name": "LOWE",
          "Patient_DOB": "03-28-1969",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "372840",
          "Patient_First_Name": "CANDICE",
          "Patient_Last_Name": "ALDRICH",
          "Patient_DOB": "03-27-1984",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Royal Oak Woodward",
          "Appt_Resource_Descr": "US - Tanisha",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/MSK",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "383350",
          "Patient_First_Name": "MARK",
          "Patient_Last_Name": "SCHWARTZ",
          "Patient_DOB": "10-06-1959",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "387750",
          "Patient_First_Name": "TIFFANY",
          "Patient_Last_Name": "FLUKER",
          "Patient_DOB": "08-07-1978",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "387930",
          "Patient_First_Name": "JOSEPH",
          "Patient_Last_Name": "KENNEY",
          "Patient_DOB": "01-31-1963",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "388600",
          "Patient_First_Name": "KENNETH",
          "Patient_Last_Name": "ANDREWS",
          "Patient_DOB": "12-25-1952",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "391360",
          "Patient_First_Name": "MARIAH",
          "Patient_Last_Name": "HAWKINS",
          "Patient_DOB": "09-18-1995",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "395290",
          "Patient_First_Name": "DELORES",
          "Patient_Last_Name": "HENSON",
          "Patient_DOB": "06-19-1953",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "400030",
          "Patient_First_Name": "CYNKIA",
          "Patient_Last_Name": "TINSLEY-JELKS",
          "Patient_DOB": "04-12-1993",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "400360",
          "Patient_First_Name": "STEPHANIE",
          "Patient_Last_Name": "STEELE",
          "Patient_DOB": "06-01-1986",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Henderson, Lauren",
          "Appt_Resource_Assoc_Prov_LFI": "Henderson, Lauren",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "400360",
          "Patient_First_Name": "STEPHANIE",
          "Patient_Last_Name": "STEELE",
          "Patient_DOB": "06-01-1986",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "402970",
          "Patient_First_Name": "BRITTANY",
          "Patient_Last_Name": "JENNINGS",
          "Patient_DOB": "10-27-1998",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "402990",
          "Patient_First_Name": "ADAM",
          "Patient_Last_Name": "THOMPSON",
          "Patient_DOB": "09-08-1984",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "405920",
          "Patient_First_Name": "MICHELLE",
          "Patient_Last_Name": "BIDIGARE",
          "Patient_DOB": "06-27-1966",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "407350",
          "Patient_First_Name": "LAVERN",
          "Patient_Last_Name": "CLARK",
          "Patient_DOB": "12-26-1946",
          "Appt_DateTime": "2025-07-29T14:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "DPT - Garavaglia, Scott",
          "Appt_Resource_Assoc_Prov_LFI": "Therapy, Physical",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "409430",
          "Patient_First_Name": "ELIZABETH",
          "Patient_Last_Name": "DANIEL",
          "Patient_DOB": "05-21-1971",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "418390",
          "Patient_First_Name": "CHRISTOPHER",
          "Patient_Last_Name": "KOCJAN",
          "Patient_DOB": "07-23-1966",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "418390",
          "Patient_First_Name": "CHRISTOPHER",
          "Patient_Last_Name": "KOCJAN",
          "Patient_DOB": "07-23-1966",
          "Appt_DateTime": "2025-07-29T12:40:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "418830",
          "Patient_First_Name": "LATRISE",
          "Patient_Last_Name": "POSEY",
          "Patient_DOB": "08-07-1985",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "419880",
          "Patient_First_Name": "ASHLEY",
          "Patient_Last_Name": "KRATZKE",
          "Patient_DOB": "10-07-1986",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "BH - Rose B.",
          "Appt_Resource_Assoc_Prov_LFI": "Psychotherapy, Ferndale",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "424000",
          "Patient_First_Name": "CLAUDIA",
          "Patient_Last_Name": "PAULGER",
          "Patient_DOB": "06-27-1976",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "426990",
          "Patient_First_Name": "RUBY",
          "Patient_Last_Name": "ZACKERY",
          "Patient_DOB": "08-07-1947",
          "Appt_DateTime": "2025-07-29T17:30:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "427070",
          "Patient_First_Name": "JOSLYN",
          "Patient_Last_Name": "HAMPTON",
          "Patient_DOB": "07-01-1996",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "429570",
          "Patient_First_Name": "AMY",
          "Patient_Last_Name": "WILLHOFT",
          "Patient_DOB": "11-07-1991",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "429770",
          "Patient_First_Name": "HEATHER",
          "Patient_Last_Name": "FARROW",
          "Patient_DOB": "12-20-1967",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "438530",
          "Patient_First_Name": "JOHN",
          "Patient_Last_Name": "GRAHAM",
          "Patient_DOB": "12-24-1970",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "440280",
          "Patient_First_Name": "TAWAUNNA",
          "Patient_Last_Name": "DUNCAN-LONDON",
          "Patient_DOB": "05-29-1956",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "444580",
          "Patient_First_Name": "LARRY",
          "Patient_Last_Name": "NORMAN",
          "Patient_DOB": "12-11-1953",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "445000",
          "Patient_First_Name": "SANG",
          "Patient_Last_Name": "DANH",
          "Patient_DOB": "07-15-1960",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "445500",
          "Patient_First_Name": "ERICA",
          "Patient_Last_Name": "REECE",
          "Patient_DOB": "12-22-1983",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "449520",
          "Patient_First_Name": "JACOB",
          "Patient_Last_Name": "BAIN",
          "Patient_DOB": "08-03-2000",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "456640",
          "Patient_First_Name": "FRANK",
          "Patient_Last_Name": "WELLS",
          "Patient_DOB": "12-19-1967",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "460060",
          "Patient_First_Name": "LISA",
          "Patient_Last_Name": "CARR",
          "Patient_DOB": "12-16-1967",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "460690",
          "Patient_First_Name": "JAMEKA",
          "Patient_Last_Name": "LOTT",
          "Patient_DOB": "05-26-1988",
          "Appt_DateTime": "2025-07-29T11:50:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "461490",
          "Patient_First_Name": "KIAMBA",
          "Patient_Last_Name": "WILLSON",
          "Patient_DOB": "07-31-1981",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "462560",
          "Patient_First_Name": "VIVENNE",
          "Patient_Last_Name": "HENRY",
          "Patient_DOB": "02-10-1984",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "465250",
          "Patient_First_Name": "CRYSTAL",
          "Patient_Last_Name": "HALL",
          "Patient_DOB": "06-08-1982",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "465270",
          "Patient_First_Name": "DENISE",
          "Patient_Last_Name": "SANDFORD",
          "Patient_DOB": "10-12-1967",
          "Appt_DateTime": "2025-07-29T09:19:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Tourlaeva NP, Alyona",
          "Appt_Resource_Assoc_Prov_LFI": "Tourlaeva, Alyona",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "469880",
          "Patient_First_Name": "NICHOLAS",
          "Patient_Last_Name": "SIMON",
          "Patient_DOB": "12-01-1989",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "471330",
          "Patient_First_Name": "SIRENA",
          "Patient_Last_Name": "HATCHER",
          "Patient_DOB": "10-05-1980",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "472590",
          "Patient_First_Name": "JHATON",
          "Patient_Last_Name": "MADISON",
          "Patient_DOB": "03-28-1984",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "476150",
          "Patient_First_Name": "YOLANDA",
          "Patient_Last_Name": "JACKSON",
          "Patient_DOB": "10-16-1971",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "477040",
          "Patient_First_Name": "LINNIE",
          "Patient_Last_Name": "HUEY",
          "Patient_DOB": "06-10-1930",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "478460",
          "Patient_First_Name": "RALPH",
          "Patient_Last_Name": "MITCHELL JR",
          "Patient_DOB": "08-03-1967",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "478740",
          "Patient_First_Name": "DAVID",
          "Patient_Last_Name": "WHITE",
          "Patient_DOB": "09-30-1980",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "478740",
          "Patient_First_Name": "DAVID",
          "Patient_Last_Name": "WHITE",
          "Patient_DOB": "09-30-1980",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "492100",
          "Patient_First_Name": "KIMBERLY",
          "Patient_Last_Name": "GUNN",
          "Patient_DOB": "06-06-1980",
          "Appt_DateTime": "2025-07-29T17:15:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "492550",
          "Patient_First_Name": "SARAH",
          "Patient_Last_Name": "LATTIMORE",
          "Patient_DOB": "01-14-2002",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "493040",
          "Patient_First_Name": "CANDICE",
          "Patient_Last_Name": "CODY",
          "Patient_DOB": "04-01-1982",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "493100",
          "Patient_First_Name": "HOWARD",
          "Patient_Last_Name": "EWING JR",
          "Patient_DOB": "09-24-1940",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "495420",
          "Patient_First_Name": "LATAMARA",
          "Patient_Last_Name": "MORROW",
          "Patient_DOB": "08-23-1977",
          "Appt_DateTime": "2025-07-29T10:04:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "496930",
          "Patient_First_Name": "MORIOM",
          "Patient_Last_Name": "CHOWDHURY",
          "Patient_DOB": "10-20-1990",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "496970",
          "Patient_First_Name": "DAWN",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "02-06-1966",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "497510",
          "Patient_First_Name": "LAQUANA",
          "Patient_Last_Name": "BOTTEN",
          "Patient_DOB": "12-30-1976",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "499410",
          "Patient_First_Name": "TERRIE",
          "Patient_Last_Name": "PHILLIPS",
          "Patient_DOB": "11-30-1968",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "499960",
          "Patient_First_Name": "ABU",
          "Patient_Last_Name": "ZUBER",
          "Patient_DOB": "06-04-1975",
          "Appt_DateTime": "2025-07-29T14:05:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "500420",
          "Patient_First_Name": "CHARLES",
          "Patient_Last_Name": "CALLOWAY",
          "Patient_DOB": "09-29-1972",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "501960",
          "Patient_First_Name": "CORA",
          "Patient_Last_Name": "LOWE",
          "Patient_DOB": "09-15-1951",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "503270",
          "Patient_First_Name": "JOHNNY",
          "Patient_Last_Name": "KING",
          "Patient_DOB": "10-24-1967",
          "Appt_DateTime": "2025-07-29T10:33:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "503410",
          "Patient_First_Name": "VALESTA",
          "Patient_Last_Name": "CATO",
          "Patient_DOB": "05-14-1956",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "506040",
          "Patient_First_Name": "TYRELL",
          "Patient_Last_Name": "ORR",
          "Patient_DOB": "10-19-1994",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "506940",
          "Patient_First_Name": "KEITH",
          "Patient_Last_Name": "ROBERTSON",
          "Patient_DOB": "09-08-1960",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "507730",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "HARVELL",
          "Patient_DOB": "02-17-1932",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "508960",
          "Patient_First_Name": "WILLIE",
          "Patient_Last_Name": "POWELL",
          "Patient_DOB": "02-22-1950",
          "Appt_DateTime": "2025-07-29T15:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "510020",
          "Patient_First_Name": "DESTINY",
          "Patient_Last_Name": "SIMPSON",
          "Patient_DOB": "04-10-2001",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "512200",
          "Patient_First_Name": "DESTINY",
          "Patient_Last_Name": "ROBY",
          "Patient_DOB": "09-01-1999",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "514690",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "HAIRSTON",
          "Patient_DOB": "12-25-1951",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "514720",
          "Patient_First_Name": "ANTHONY",
          "Patient_Last_Name": "PICKETT",
          "Patient_DOB": "05-04-1961",
          "Appt_DateTime": "2025-07-29T12:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "524260",
          "Patient_First_Name": "CLAUDETTE",
          "Patient_Last_Name": "MUNDY",
          "Patient_DOB": "12-07-1967",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "524880",
          "Patient_First_Name": "DAMITRICE",
          "Patient_Last_Name": "VANN",
          "Patient_DOB": "11-14-1982",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Allergy Testing",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "527010",
          "Patient_First_Name": "LATASHIA",
          "Patient_Last_Name": "DIXON",
          "Patient_DOB": "08-27-1971",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "529480",
          "Patient_First_Name": "SEDGIE",
          "Patient_Last_Name": "FORTENBERRY",
          "Patient_DOB": "04-09-1978",
          "Appt_DateTime": "2025-07-29T10:15:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "529760",
          "Patient_First_Name": "FELTON",
          "Patient_Last_Name": "LYNN JR",
          "Patient_DOB": "09-04-1953",
          "Appt_DateTime": "2025-07-29T08:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "532020",
          "Patient_First_Name": "DENNIS",
          "Patient_Last_Name": "JENKINS",
          "Patient_DOB": "09-19-1974",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "534310",
          "Patient_First_Name": "NETASHA",
          "Patient_Last_Name": "HENDERSON",
          "Patient_DOB": "03-01-1970",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "537580",
          "Patient_First_Name": "RUKIA",
          "Patient_Last_Name": "HARDY",
          "Patient_DOB": "04-16-1984",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "538151",
          "Patient_First_Name": "RICHARD",
          "Patient_Last_Name": "ROBERTSON",
          "Patient_DOB": "09-12-1974",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "539601",
          "Patient_First_Name": "FRANKENE",
          "Patient_Last_Name": "BOLDEN",
          "Patient_DOB": "05-10-1989",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "547410",
          "Patient_First_Name": "TWANA",
          "Patient_Last_Name": "JEMISON",
          "Patient_DOB": "07-17-1972",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "547640",
          "Patient_First_Name": "JERONE",
          "Patient_Last_Name": "HAMLER",
          "Patient_DOB": "08-05-1974",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "548120",
          "Patient_First_Name": "DELDRE",
          "Patient_Last_Name": "JORDAN",
          "Patient_DOB": "03-30-1972",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "548380",
          "Patient_First_Name": "LAQUITTA",
          "Patient_Last_Name": "JONES",
          "Patient_DOB": "04-16-1975",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "551810",
          "Patient_First_Name": "FEOZIFE",
          "Patient_Last_Name": "LEONARD",
          "Patient_DOB": "03-18-1978",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "553440",
          "Patient_First_Name": "SHALONA",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "02-20-1976",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "562430",
          "Patient_First_Name": "ANTWON",
          "Patient_Last_Name": "DAVIS",
          "Patient_DOB": "02-04-1977",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "565830",
          "Patient_First_Name": "DENISE",
          "Patient_Last_Name": "PETTIES",
          "Patient_DOB": "03-26-1977",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "568790",
          "Patient_First_Name": "SHARON",
          "Patient_Last_Name": "GRAHAM",
          "Patient_DOB": "12-29-1961",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "568800",
          "Patient_First_Name": "EBONY",
          "Patient_Last_Name": "THOMPSON",
          "Patient_DOB": "05-07-1981",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "BH - Karen",
          "Appt_Resource_Assoc_Prov_LFI": "Nugent, Karen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "576590",
          "Patient_First_Name": "ASHLEY",
          "Patient_Last_Name": "SIMPSON",
          "Patient_DOB": "12-07-1990",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "579030",
          "Patient_First_Name": "SHARETA",
          "Patient_Last_Name": "SILVER",
          "Patient_DOB": "06-12-1987",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "581280",
          "Patient_First_Name": "RODNEY",
          "Patient_Last_Name": "TAYLOR",
          "Patient_DOB": "01-04-1966",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "583580",
          "Patient_First_Name": "EDDIE",
          "Patient_Last_Name": "FALKNER",
          "Patient_DOB": "09-15-1977",
          "Appt_DateTime": "2025-07-29T15:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "584030",
          "Patient_First_Name": "BLANCHE",
          "Patient_Last_Name": "JACKSON",
          "Patient_DOB": "09-04-1969",
          "Appt_DateTime": "2025-07-29T15:50:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "584290",
          "Patient_First_Name": "MORGAN",
          "Patient_Last_Name": "BENNETT",
          "Patient_DOB": "10-19-1982",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "584360",
          "Patient_First_Name": "SHANETTA",
          "Patient_Last_Name": "CLARK-HAWKINS",
          "Patient_DOB": "10-10-1972",
          "Appt_DateTime": "2025-07-29T11:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "DPT - Garavaglia, Scott",
          "Appt_Resource_Assoc_Prov_LFI": "Therapy, Physical",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "585200",
          "Patient_First_Name": "KENT",
          "Patient_Last_Name": "MCGEE",
          "Patient_DOB": "09-24-1972",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "585220",
          "Patient_First_Name": "FAITH",
          "Patient_Last_Name": "SAMUELS HERRON",
          "Patient_DOB": "11-17-1957",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "585790",
          "Patient_First_Name": "JERRID",
          "Patient_Last_Name": "PERNELL",
          "Patient_DOB": "01-24-1975",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "586360",
          "Patient_First_Name": "TALINA",
          "Patient_Last_Name": "MONDAY",
          "Patient_DOB": "09-04-1975",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "586450",
          "Patient_First_Name": "GLENN",
          "Patient_Last_Name": "FOUCART",
          "Patient_DOB": "01-26-1945",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "587420",
          "Patient_First_Name": "APRIL",
          "Patient_Last_Name": "ROBINSON",
          "Patient_DOB": "11-03-1972",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "594260",
          "Patient_First_Name": "AARON",
          "Patient_Last_Name": "EVANS",
          "Patient_DOB": "03-20-1989",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "595870",
          "Patient_First_Name": "RANA",
          "Patient_Last_Name": "KHAN",
          "Patient_DOB": "01-30-1962",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "596010",
          "Patient_First_Name": "CHARLOTTE",
          "Patient_Last_Name": "CRAWFORD",
          "Patient_DOB": "02-28-1961",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "601050",
          "Patient_First_Name": "EDWIN",
          "Patient_Last_Name": "STANDBERRY",
          "Patient_DOB": "09-27-1967",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "604020",
          "Patient_First_Name": "DARYL",
          "Patient_Last_Name": "AUSTIN",
          "Patient_DOB": "09-01-1966",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "607450",
          "Patient_First_Name": "TIMOTHY",
          "Patient_Last_Name": "BENNETT",
          "Patient_DOB": "11-11-1969",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "640610",
          "Patient_First_Name": "RODERIC",
          "Patient_Last_Name": "RAY",
          "Patient_DOB": "03-10-1987",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "642830",
          "Patient_First_Name": "KENNETH",
          "Patient_Last_Name": "MORRIS",
          "Patient_DOB": "02-20-1945",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "648450",
          "Patient_First_Name": "REESHEMAH",
          "Patient_Last_Name": "ATKINSON",
          "Patient_DOB": "08-14-1984",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "BH - Karen",
          "Appt_Resource_Assoc_Prov_LFI": "Nugent, Karen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "650390",
          "Patient_First_Name": "ALANA",
          "Patient_Last_Name": "LOGANSANDERS",
          "Patient_DOB": "08-26-1979",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "655020",
          "Patient_First_Name": "JAVIER",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "12-09-2005",
          "Appt_DateTime": "2025-07-29T08:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "655300",
          "Patient_First_Name": "ALIRIA",
          "Patient_Last_Name": "GOLPHIN",
          "Patient_DOB": "06-17-1989",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "655510",
          "Patient_First_Name": "DEANNA",
          "Patient_Last_Name": "LUCAS",
          "Patient_DOB": "07-14-1968",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "BH - Karen",
          "Appt_Resource_Assoc_Prov_LFI": "Nugent, Karen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "655850",
          "Patient_First_Name": "VERNEAKER",
          "Patient_Last_Name": "HOLLINS",
          "Patient_DOB": "07-23-1976",
          "Appt_DateTime": "2025-07-29T16:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "656090",
          "Patient_First_Name": "KARMELA",
          "Patient_Last_Name": "WHITE",
          "Patient_DOB": "04-14-1978",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "658050",
          "Patient_First_Name": "ANTHONY",
          "Patient_Last_Name": "HARRIS",
          "Patient_DOB": "03-28-1969",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "659110",
          "Patient_First_Name": "JAYCEON",
          "Patient_Last_Name": "DUSKIN",
          "Patient_DOB": "06-16-2020",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "660310",
          "Patient_First_Name": "DEMETRIUS",
          "Patient_Last_Name": "MYERS",
          "Patient_DOB": "08-21-1988",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "660910",
          "Patient_First_Name": "JULIAN",
          "Patient_Last_Name": "MORTON RUIZ",
          "Patient_DOB": "02-16-1948",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "665160",
          "Patient_First_Name": "KEIRA",
          "Patient_Last_Name": "COSTNER",
          "Patient_DOB": "08-10-1993",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "683500",
          "Patient_First_Name": "CHARLIE",
          "Patient_Last_Name": "HORNBUCKLE",
          "Patient_DOB": "09-06-1974",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "684510",
          "Patient_First_Name": "CHRISTIAN",
          "Patient_Last_Name": "LYLE",
          "Patient_DOB": "01-22-2000",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "684610",
          "Patient_First_Name": "ERINN",
          "Patient_Last_Name": "REYNOLDS",
          "Patient_DOB": "08-26-1999",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "686280",
          "Patient_First_Name": "JERELL",
          "Patient_Last_Name": "DANIELS",
          "Patient_DOB": "11-07-1984",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Tourlaeva NP, Alyona",
          "Appt_Resource_Assoc_Prov_LFI": "Tourlaeva, Alyona",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "687790",
          "Patient_First_Name": "WILLIE",
          "Patient_Last_Name": "WAGNER",
          "Patient_DOB": "03-18-1986",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "687830",
          "Patient_First_Name": "INEZ",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "08-20-1955",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "691370",
          "Patient_First_Name": "EUNIQUE",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "11-14-1992",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "695040",
          "Patient_First_Name": "JULIEN",
          "Patient_Last_Name": "WALTON",
          "Patient_DOB": "12-11-1988",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "DPT - Garavaglia, Scott",
          "Appt_Resource_Assoc_Prov_LFI": "Therapy, Physical",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "695180",
          "Patient_First_Name": "REBA",
          "Patient_Last_Name": "WILSON",
          "Patient_DOB": "11-03-1968",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "696110",
          "Patient_First_Name": "LISA",
          "Patient_Last_Name": "TROTTER",
          "Patient_DOB": "09-12-1966",
          "Appt_DateTime": "2025-07-29T14:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "696820",
          "Patient_First_Name": "LESTER",
          "Patient_Last_Name": "HALE",
          "Patient_DOB": "01-05-1952",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "696840",
          "Patient_First_Name": "FAYE",
          "Patient_Last_Name": "GIBSON",
          "Patient_DOB": "03-19-1958",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "698590",
          "Patient_First_Name": "BEVERLY",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "07-15-1959",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "BH - Karen",
          "Appt_Resource_Assoc_Prov_LFI": "Nugent, Karen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "698940",
          "Patient_First_Name": "DESHAUGHN",
          "Patient_Last_Name": "WIGGINS",
          "Patient_DOB": "02-16-1989",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "704260",
          "Patient_First_Name": "KATRINA",
          "Patient_Last_Name": "ANDERSON",
          "Patient_DOB": "05-21-1972",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "706230",
          "Patient_First_Name": "AMBERLEE",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "08-17-1980",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "706930",
          "Patient_First_Name": "BRITTANY",
          "Patient_Last_Name": "WARD",
          "Patient_DOB": "07-10-1996",
          "Appt_DateTime": "2025-07-29T16:10:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "709070",
          "Patient_First_Name": "CORNELL",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "06-02-1973",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "712810",
          "Patient_First_Name": "ADRIANNA",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "01-01-1986",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "714190",
          "Patient_First_Name": "LISA",
          "Patient_Last_Name": "PATEE",
          "Patient_DOB": "06-17-1965",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "714240",
          "Patient_First_Name": "MINETTE",
          "Patient_Last_Name": "COURTNEY",
          "Patient_DOB": "05-30-1990",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "715850",
          "Patient_First_Name": "SVITLANA",
          "Patient_Last_Name": "SHARATA",
          "Patient_DOB": "04-30-1940",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "715930",
          "Patient_First_Name": "CLAYTON",
          "Patient_Last_Name": "SALTER",
          "Patient_DOB": "03-05-1949",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Riggins NP, Valerie",
          "Appt_Resource_Assoc_Prov_LFI": "Riggins, Valerie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "716340",
          "Patient_First_Name": "CHRISTINE",
          "Patient_Last_Name": "PELLOW",
          "Patient_DOB": "07-10-1985",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "716640",
          "Patient_First_Name": "BENNIE",
          "Patient_Last_Name": "POPE",
          "Patient_DOB": "11-17-1951",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "718390",
          "Patient_First_Name": "THEODORE",
          "Patient_Last_Name": "MICHEAU",
          "Patient_DOB": "09-11-1946",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "718580",
          "Patient_First_Name": "STACEY",
          "Patient_Last_Name": "WEAKS",
          "Patient_DOB": "04-11-1970",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "721830",
          "Patient_First_Name": "TERRY",
          "Patient_Last_Name": "MORGAN",
          "Patient_DOB": "02-23-1953",
          "Appt_DateTime": "2025-07-29T11:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "722020",
          "Patient_First_Name": "SARAH",
          "Patient_Last_Name": "PORTER",
          "Patient_DOB": "12-11-1960",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "723340",
          "Patient_First_Name": "JESSICA",
          "Patient_Last_Name": "MCMILLIAN",
          "Patient_DOB": "01-01-1994",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "723620",
          "Patient_First_Name": "ANDRE",
          "Patient_Last_Name": "HOOTEN",
          "Patient_DOB": "12-23-1983",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "724160",
          "Patient_First_Name": "JAMES",
          "Patient_Last_Name": "FRAISER",
          "Patient_DOB": "03-15-1967",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "727630",
          "Patient_First_Name": "ALLENA",
          "Patient_Last_Name": "HUDGINS",
          "Patient_DOB": "06-09-1995",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "732840",
          "Patient_First_Name": "JOHN",
          "Patient_Last_Name": "CLEMENTZ",
          "Patient_DOB": "04-09-1958",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "740500",
          "Patient_First_Name": "AARON",
          "Patient_Last_Name": "BEARD",
          "Patient_DOB": "05-23-1982",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "745060",
          "Patient_First_Name": "ANISSA",
          "Patient_Last_Name": "STEPHENS",
          "Patient_DOB": "08-18-1993",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "745190",
          "Patient_First_Name": "MARCHELLE",
          "Patient_Last_Name": "HAIR",
          "Patient_DOB": "08-21-1988",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "746570",
          "Patient_First_Name": "BELINDA",
          "Patient_Last_Name": "MATTHEWS",
          "Patient_DOB": "03-19-1969",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "747910",
          "Patient_First_Name": "DESHAWN",
          "Patient_Last_Name": "BOOTH",
          "Patient_DOB": "12-28-1978",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Tourlaeva NP, Alyona",
          "Appt_Resource_Assoc_Prov_LFI": "Tourlaeva, Alyona",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "750620",
          "Patient_First_Name": "GARY",
          "Patient_Last_Name": "SHELLY",
          "Patient_DOB": "09-27-1968",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "752990",
          "Patient_First_Name": "MICHELLE",
          "Patient_Last_Name": "PERRIN",
          "Patient_DOB": "11-27-1977",
          "Appt_DateTime": "2025-07-29T12:30:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Allergy Testing",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "766980",
          "Patient_First_Name": "ROSETTA",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "05-04-1976",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "775820",
          "Patient_First_Name": "ARTHUR",
          "Patient_Last_Name": "CARRIER",
          "Patient_DOB": "04-28-1938",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "780090",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "WEISS",
          "Patient_DOB": "03-22-1956",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "784310",
          "Patient_First_Name": "GARRY",
          "Patient_Last_Name": "TURK",
          "Patient_DOB": "01-11-1960",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "785620",
          "Patient_First_Name": "EDWARD",
          "Patient_Last_Name": "DERONNE",
          "Patient_DOB": "07-23-1956",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "785730",
          "Patient_First_Name": "LORI",
          "Patient_Last_Name": "WIMBROW",
          "Patient_DOB": "10-10-1964",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "786340",
          "Patient_First_Name": "KELLY",
          "Patient_Last_Name": "MILLARD",
          "Patient_DOB": "03-17-1970",
          "Appt_DateTime": "2025-07-29T11:21:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "793360",
          "Patient_First_Name": "MARK",
          "Patient_Last_Name": "FRAZIER",
          "Patient_DOB": "09-19-1975",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "800940",
          "Patient_First_Name": "SHAYLENE",
          "Patient_Last_Name": "CHENCHICK",
          "Patient_DOB": "10-14-1989",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "803360",
          "Patient_First_Name": "DANIEL",
          "Patient_Last_Name": "EASLEY",
          "Patient_DOB": "11-09-1976",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "804860",
          "Patient_First_Name": "ERIK",
          "Patient_Last_Name": "GARMANY",
          "Patient_DOB": "10-07-1974",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "826130",
          "Patient_First_Name": "ERIKA",
          "Patient_Last_Name": "KEYES",
          "Patient_DOB": "04-22-1987",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "834270",
          "Patient_First_Name": "STEVEN",
          "Patient_Last_Name": "MEIER",
          "Patient_DOB": "09-09-1971",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "834450",
          "Patient_First_Name": "JEROME",
          "Patient_Last_Name": "GARRISON",
          "Patient_DOB": "09-20-1983",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "835450",
          "Patient_First_Name": "JOHN",
          "Patient_Last_Name": "MARSHALL",
          "Patient_DOB": "02-17-1964",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "840610",
          "Patient_First_Name": "WAYNE",
          "Patient_Last_Name": "GADIE",
          "Patient_DOB": "06-03-1983",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "841260",
          "Patient_First_Name": "ZACKREY",
          "Patient_Last_Name": "RYBAK",
          "Patient_DOB": "08-20-1993",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "843140",
          "Patient_First_Name": "JOHN",
          "Patient_Last_Name": "MAXON",
          "Patient_DOB": "05-16-1969",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "845100",
          "Patient_First_Name": "DAEZON",
          "Patient_Last_Name": "LUSBY",
          "Patient_DOB": "03-22-2001",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "849640",
          "Patient_First_Name": "MELANIE",
          "Patient_Last_Name": "MCKELVEY",
          "Patient_DOB": "01-17-1972",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "851130",
          "Patient_First_Name": "SELINK",
          "Patient_Last_Name": "GOODWIN",
          "Patient_DOB": "11-22-1975",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "851870",
          "Patient_First_Name": "KIZZEY",
          "Patient_Last_Name": "HARDMAN",
          "Patient_DOB": "01-26-1978",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "852100",
          "Patient_First_Name": "ANDREA",
          "Patient_Last_Name": "GRIER",
          "Patient_DOB": "04-25-1991",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "855440",
          "Patient_First_Name": "NICOLE",
          "Patient_Last_Name": "FINLEYTHORPE",
          "Patient_DOB": "05-07-1972",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Tourlaeva NP, Alyona",
          "Appt_Resource_Assoc_Prov_LFI": "Tourlaeva, Alyona",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "855700",
          "Patient_First_Name": "LUKE",
          "Patient_Last_Name": "SUTTER",
          "Patient_DOB": "04-02-1978",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "856650",
          "Patient_First_Name": "LADONNA",
          "Patient_Last_Name": "BARNES",
          "Patient_DOB": "01-14-1978",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "857720",
          "Patient_First_Name": "PHYLLIS",
          "Patient_Last_Name": "BERRY",
          "Patient_DOB": "08-11-1957",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "857720",
          "Patient_First_Name": "PHYLLIS",
          "Patient_Last_Name": "BERRY",
          "Patient_DOB": "08-11-1957",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "857750",
          "Patient_First_Name": "INGRID",
          "Patient_Last_Name": "WALTON",
          "Patient_DOB": "08-07-1981",
          "Appt_DateTime": "2025-07-29T12:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "DPT - Garavaglia, Scott",
          "Appt_Resource_Assoc_Prov_LFI": "Therapy, Physical",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "859160",
          "Patient_First_Name": "NANCI",
          "Patient_Last_Name": "ADAMS",
          "Patient_DOB": "02-22-1966",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "859380",
          "Patient_First_Name": "JOSEPH",
          "Patient_Last_Name": "BURNHAM",
          "Patient_DOB": "04-18-1996",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "859400",
          "Patient_First_Name": "CHUNCEY",
          "Patient_Last_Name": "KOONCE",
          "Patient_DOB": "09-11-1981",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "862470",
          "Patient_First_Name": "JANEIS",
          "Patient_Last_Name": "PARKER",
          "Patient_DOB": "11-27-1993",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "865560",
          "Patient_First_Name": "JESSICA",
          "Patient_Last_Name": "GRAY",
          "Patient_DOB": "05-08-1993",
          "Appt_DateTime": "2025-07-29T09:15:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "BH - Karen",
          "Appt_Resource_Assoc_Prov_LFI": "Nugent, Karen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "871930",
          "Patient_First_Name": "CHELSEA",
          "Patient_Last_Name": "HOOD",
          "Patient_DOB": "01-12-1996",
          "Appt_DateTime": "2025-07-29T15:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "873230",
          "Patient_First_Name": "CHRISTOPHER",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "10-23-1961",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "873710",
          "Patient_First_Name": "RODNISHA",
          "Patient_Last_Name": "LOCKETT",
          "Patient_DOB": "01-23-1987",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "877780",
          "Patient_First_Name": "TAQUELA",
          "Patient_Last_Name": "BATES",
          "Patient_DOB": "07-27-1981",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Mammogram",
          "Appt_Resource_Assoc_Prov_LFI": "Mammogram",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "877780",
          "Patient_First_Name": "TAQUELA",
          "Patient_Last_Name": "BATES",
          "Patient_DOB": "07-27-1981",
          "Appt_DateTime": "2025-07-29T13:50:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "877780",
          "Patient_First_Name": "TAQUELA",
          "Patient_Last_Name": "BATES",
          "Patient_DOB": "07-27-1981",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "881620",
          "Patient_First_Name": "KORTENEY",
          "Patient_Last_Name": "FLETCHER",
          "Patient_DOB": "02-05-1999",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "883110",
          "Patient_First_Name": "STEVEN",
          "Patient_Last_Name": "BARKER",
          "Patient_DOB": "08-26-1982",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "887400",
          "Patient_First_Name": "DANIEL",
          "Patient_Last_Name": "SANDERS",
          "Patient_DOB": "05-23-1952",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "888470",
          "Patient_First_Name": "LINDA",
          "Patient_Last_Name": "JAMES",
          "Patient_DOB": "06-22-2004",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "888670",
          "Patient_First_Name": "RACHEL",
          "Patient_Last_Name": "HOLLOWELL",
          "Patient_DOB": "05-18-1997",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "889590",
          "Patient_First_Name": "JAMEKA",
          "Patient_Last_Name": "SHAVERS",
          "Patient_DOB": "01-15-1980",
          "Appt_DateTime": "2025-07-29T12:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "891990",
          "Patient_First_Name": "ROBBIE",
          "Patient_Last_Name": "EDDINS",
          "Patient_DOB": "03-04-1985",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "893950",
          "Patient_First_Name": "AMBER",
          "Patient_Last_Name": "WISE",
          "Patient_DOB": "03-10-1989",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "895240",
          "Patient_First_Name": "DONELL",
          "Patient_Last_Name": "CAFFEY",
          "Patient_DOB": "01-17-1988",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "896150",
          "Patient_First_Name": "MICHELE",
          "Patient_Last_Name": "RAHN",
          "Patient_DOB": "08-11-1954",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Sufi PA, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Sufi, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "898230",
          "Patient_First_Name": "TERRA",
          "Patient_Last_Name": "STROHM",
          "Patient_DOB": "03-16-1972",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Mammogram",
          "Appt_Resource_Assoc_Prov_LFI": "Mammogram",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "901680",
          "Patient_First_Name": "DEHARMONY",
          "Patient_Last_Name": "FOREMAN",
          "Patient_DOB": "07-13-1988",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "902220",
          "Patient_First_Name": "CEDRIC",
          "Patient_Last_Name": "HUBERT SR",
          "Patient_DOB": "04-23-1984",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "902721",
          "Patient_First_Name": "MICHAEL",
          "Patient_Last_Name": "THOMAS",
          "Patient_DOB": "01-29-2008",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "905200",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "BELL",
          "Patient_DOB": "02-22-1958",
          "Appt_DateTime": "2025-07-29T12:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "905640",
          "Patient_First_Name": "JOHN",
          "Patient_Last_Name": "SELLERS",
          "Patient_DOB": "05-23-1955",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "906270",
          "Patient_First_Name": "JOHN",
          "Patient_Last_Name": "EASTMAN",
          "Patient_DOB": "01-16-1986",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "911760",
          "Patient_First_Name": "ANDREW",
          "Patient_Last_Name": "GREGORY",
          "Patient_DOB": "05-10-1981",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "913940",
          "Patient_First_Name": "SHANAE",
          "Patient_Last_Name": "VALENTINE",
          "Patient_DOB": "05-19-1992",
          "Appt_DateTime": "2025-07-29T15:15:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "914510",
          "Patient_First_Name": "ASHLEY",
          "Patient_Last_Name": "MONTAGUE",
          "Patient_DOB": "08-11-1988",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "914750",
          "Patient_First_Name": "INGRID",
          "Patient_Last_Name": "RICE",
          "Patient_DOB": "11-08-2002",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "917980",
          "Patient_First_Name": "ANITA",
          "Patient_Last_Name": "DENNIS",
          "Patient_DOB": "12-06-1958",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Mammogram",
          "Appt_Resource_Assoc_Prov_LFI": "Mammogram",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "918600",
          "Patient_First_Name": "JENNIFER",
          "Patient_Last_Name": "BREMER",
          "Patient_DOB": "03-03-1994",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "BH - Rose B.",
          "Appt_Resource_Assoc_Prov_LFI": "Psychotherapy, Ferndale",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "922770",
          "Patient_First_Name": "ALEX",
          "Patient_Last_Name": "COOPER",
          "Patient_DOB": "12-14-1960",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "923240",
          "Patient_First_Name": "BARBARA",
          "Patient_Last_Name": "MADVIN",
          "Patient_DOB": "04-22-1981",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "925490",
          "Patient_First_Name": "DENISE",
          "Patient_Last_Name": "WALKER",
          "Patient_DOB": "10-16-1960",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "926210",
          "Patient_First_Name": "CARRIE",
          "Patient_Last_Name": "LAUX",
          "Patient_DOB": "07-30-1978",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "BH - Rose B.",
          "Appt_Resource_Assoc_Prov_LFI": "Psychotherapy, Ferndale",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "922161",
          "Patient_First_Name": "SHAMIKA",
          "Patient_Last_Name": "HUDSON",
          "Patient_DOB": "10-29-1989",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "926950",
          "Patient_First_Name": "ROSLAND",
          "Patient_Last_Name": "JONES",
          "Patient_DOB": "09-13-1957",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "935530",
          "Patient_First_Name": "TANIAH",
          "Patient_Last_Name": "GAINEY",
          "Patient_DOB": "06-12-2004",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "936390",
          "Patient_First_Name": "TAMISHA",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "05-06-2005",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "941490",
          "Patient_First_Name": "BOBBY",
          "Patient_Last_Name": "FIZER",
          "Patient_DOB": "06-03-1964",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "941980",
          "Patient_First_Name": "KERRY",
          "Patient_Last_Name": "HUMBLES",
          "Patient_DOB": "12-30-1962",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "948580",
          "Patient_First_Name": "RONDA",
          "Patient_Last_Name": "PIERCE",
          "Patient_DOB": "09-18-1964",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "952550",
          "Patient_First_Name": "DEZIREE",
          "Patient_Last_Name": "BURFORD",
          "Patient_DOB": "03-13-2001",
          "Appt_DateTime": "2025-07-29T11:10:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "952980",
          "Patient_First_Name": "OSCAR",
          "Patient_Last_Name": "CASTILLO",
          "Patient_DOB": "08-15-2023",
          "Appt_DateTime": "2025-07-29T10:35:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Riggins NP, Valerie",
          "Appt_Resource_Assoc_Prov_LFI": "Riggins, Valerie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "954310",
          "Patient_First_Name": "SYLVIA",
          "Patient_Last_Name": "FARLEY",
          "Patient_DOB": "03-27-2004",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Henderson, Lauren",
          "Appt_Resource_Assoc_Prov_LFI": "Henderson, Lauren",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "955680",
          "Patient_First_Name": "JESSICA",
          "Patient_Last_Name": "SEXTON",
          "Patient_DOB": "07-08-1984",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Mammogram",
          "Appt_Resource_Assoc_Prov_LFI": "Mammogram",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "955840",
          "Patient_First_Name": "KATRINA",
          "Patient_Last_Name": "GALLMORE",
          "Patient_DOB": "07-20-1975",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "956610",
          "Patient_First_Name": "KARSON",
          "Patient_Last_Name": "WHITE",
          "Patient_DOB": "08-06-2021",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "957140",
          "Patient_First_Name": "LINDA",
          "Patient_Last_Name": "DUKE",
          "Patient_DOB": "02-06-1950",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "959670",
          "Patient_First_Name": "RUSSELL",
          "Patient_Last_Name": "KELLY",
          "Patient_DOB": "01-18-1961",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "968300",
          "Patient_First_Name": "KAREN",
          "Patient_Last_Name": "BRISKIE",
          "Patient_DOB": "01-23-1959",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "969540",
          "Patient_First_Name": "ROSE",
          "Patient_Last_Name": "THOMAS",
          "Patient_DOB": "12-07-1946",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "972110",
          "Patient_First_Name": "JOY",
          "Patient_Last_Name": "KLEMMER",
          "Patient_DOB": "01-13-1955",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "981070",
          "Patient_First_Name": "MICHELLE",
          "Patient_Last_Name": "VIA",
          "Patient_DOB": "08-11-1970",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "998990",
          "Patient_First_Name": "RYAN",
          "Patient_Last_Name": "NEWTON",
          "Patient_DOB": "06-05-1980",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "011631",
          "Patient_First_Name": "ANA",
          "Patient_Last_Name": "FEKETE",
          "Patient_DOB": "09-15-1963",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "011914",
          "Patient_First_Name": "SHONTANNA",
          "Patient_Last_Name": "TAYLOR",
          "Patient_DOB": "09-25-1979",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "001245",
          "Patient_First_Name": "MARCUS",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "12-03-1958",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "014807",
          "Patient_First_Name": "GREGORY",
          "Patient_Last_Name": "BEAUFORD",
          "Patient_DOB": "08-15-1976",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "027987",
          "Patient_First_Name": "LINDA",
          "Patient_Last_Name": "KATTE",
          "Patient_DOB": "09-18-1947",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "BH - Rose B.",
          "Appt_Resource_Assoc_Prov_LFI": "Psychotherapy, Ferndale",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "002803",
          "Patient_First_Name": "DELNICE",
          "Patient_Last_Name": "DENT",
          "Patient_DOB": "03-21-1983",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "029962",
          "Patient_First_Name": "ROSS",
          "Patient_Last_Name": "GOYETTE",
          "Patient_DOB": "01-10-1963",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "DPT - Garavaglia, Scott",
          "Appt_Resource_Assoc_Prov_LFI": "Therapy, Physical",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "002872",
          "Patient_First_Name": "SHANNON",
          "Patient_Last_Name": "MCCAFFREY",
          "Patient_DOB": "03-30-1978",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "033730",
          "Patient_First_Name": "DAVID",
          "Patient_Last_Name": "CIPIELEWSKI",
          "Patient_DOB": "12-15-1991",
          "Appt_DateTime": "2025-07-29T08:32:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "033730",
          "Patient_First_Name": "DAVID",
          "Patient_Last_Name": "CIPIELEWSKI",
          "Patient_DOB": "12-15-1991",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "035277",
          "Patient_First_Name": "LEONARD",
          "Patient_Last_Name": "CHEESEBOROUGH",
          "Patient_DOB": "08-27-1962",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "015449",
          "Patient_First_Name": "DOUGLAS",
          "Patient_Last_Name": "COLEMAN",
          "Patient_DOB": "10-05-1977",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "009547",
          "Patient_First_Name": "KIMBERLY",
          "Patient_Last_Name": "BORDEN",
          "Patient_DOB": "02-27-1977",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "009547",
          "Patient_First_Name": "KIMBERLY",
          "Patient_Last_Name": "BORDEN",
          "Patient_DOB": "02-27-1977",
          "Appt_DateTime": "2025-07-29T16:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "002195",
          "Patient_First_Name": "LYNN",
          "Patient_Last_Name": "CURD",
          "Patient_DOB": "03-09-1965",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "022865",
          "Patient_First_Name": "SHELLEY",
          "Patient_Last_Name": "MARSHALL",
          "Patient_DOB": "10-30-1971",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Henderson, Lauren",
          "Appt_Resource_Assoc_Prov_LFI": "Henderson, Lauren",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "022865",
          "Patient_First_Name": "SHELLEY",
          "Patient_Last_Name": "MARSHALL",
          "Patient_DOB": "10-30-1971",
          "Appt_DateTime": "2025-07-29T13:50:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Benti",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/CAROTID",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "025546",
          "Patient_First_Name": "TIMOTHY",
          "Patient_Last_Name": "MATEJEWSKI",
          "Patient_DOB": "06-28-1955",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "025546",
          "Patient_First_Name": "TIMOTHY",
          "Patient_Last_Name": "MATEJEWSKI",
          "Patient_DOB": "06-28-1955",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Benti",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/CAROTID",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "026026",
          "Patient_First_Name": "BEVERLY",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "07-19-1950",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "002645",
          "Patient_First_Name": "MEGAN",
          "Patient_Last_Name": "KOSIBA",
          "Patient_DOB": "10-18-1989",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "914260",
          "Patient_First_Name": "NYA",
          "Patient_Last_Name": "HARRIS",
          "Patient_DOB": "06-09-2008",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "920900",
          "Patient_First_Name": "NALAH",
          "Patient_Last_Name": "JONES",
          "Patient_DOB": "02-06-2021",
          "Appt_DateTime": "2025-07-29T10:25:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "922170",
          "Patient_First_Name": "JAYSHAWN",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "11-22-2012",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "922180",
          "Patient_First_Name": "JAYCEON",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "09-18-2016",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "928170",
          "Patient_First_Name": "JALEN",
          "Patient_Last_Name": "LEAVELLS",
          "Patient_DOB": "07-27-2023",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "934410",
          "Patient_First_Name": "EDWARD",
          "Patient_Last_Name": "NOREUS",
          "Patient_DOB": "01-27-1989",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Benti",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/CAROTID",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "953660",
          "Patient_First_Name": "AYANNA",
          "Patient_Last_Name": "HARDEN",
          "Patient_DOB": "01-19-2006",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1186290",
          "Patient_First_Name": "KIEARRA",
          "Patient_Last_Name": "BROWN",
          "Patient_DOB": "08-26-2007",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1199990",
          "Patient_First_Name": "LEXI",
          "Patient_Last_Name": "FORD",
          "Patient_DOB": "05-03-2014",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1342840",
          "Patient_First_Name": "RICHARD",
          "Patient_Last_Name": "DRAKE",
          "Patient_DOB": "05-13-1980",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1016050",
          "Patient_First_Name": "RICHARD",
          "Patient_Last_Name": "WALLACE",
          "Patient_DOB": "08-01-1961",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1016400",
          "Patient_First_Name": "HUSSEIN",
          "Patient_Last_Name": "HAZIME",
          "Patient_DOB": "03-02-1993",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1016400",
          "Patient_First_Name": "HUSSEIN",
          "Patient_Last_Name": "HAZIME",
          "Patient_DOB": "03-02-1993",
          "Appt_DateTime": "2025-07-29T12:30:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Henderson, Lauren",
          "Appt_Resource_Assoc_Prov_LFI": "Henderson, Lauren",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1016400",
          "Patient_First_Name": "HUSSEIN",
          "Patient_Last_Name": "HAZIME",
          "Patient_DOB": "03-02-1993",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Gray, Jacquis",
          "Appt_Resource_Assoc_Prov_LFI": "Gray, Jacquis",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1016650",
          "Patient_First_Name": "MATHEW",
          "Patient_Last_Name": "HAGGART",
          "Patient_DOB": "09-15-1984",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1104670",
          "Patient_First_Name": "DENISE",
          "Patient_Last_Name": "GRAVES",
          "Patient_DOB": "06-06-1993",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1114340",
          "Patient_First_Name": "GENEVA",
          "Patient_Last_Name": "MAPP",
          "Patient_DOB": "11-23-1986",
          "Appt_DateTime": "2025-07-29T09:59:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1115200",
          "Patient_First_Name": "PATRICIA",
          "Patient_Last_Name": "WILKOS",
          "Patient_DOB": "03-17-1967",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1116030",
          "Patient_First_Name": "TRACEY",
          "Patient_Last_Name": "TATE",
          "Patient_DOB": "05-24-1970",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1121320",
          "Patient_First_Name": "TANGANIKA",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "09-03-1979",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1121320",
          "Patient_First_Name": "TANGANIKA",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "09-03-1979",
          "Appt_DateTime": "2025-07-29T13:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Mammogram",
          "Appt_Resource_Assoc_Prov_LFI": "Mammogram",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1122780",
          "Patient_First_Name": "TANERYKAH",
          "Patient_Last_Name": "BERRY",
          "Patient_DOB": "06-20-1997",
          "Appt_DateTime": "2025-07-29T14:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "PTA - Wood, Liz",
          "Appt_Resource_Assoc_Prov_LFI": "PTA - Wood, Liz",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1125120",
          "Patient_First_Name": "ALONZO",
          "Patient_Last_Name": "EDWARDS",
          "Patient_DOB": "07-12-1950",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1125300",
          "Patient_First_Name": "PATRICE",
          "Patient_Last_Name": "COLEMAN",
          "Patient_DOB": "08-02-1978",
          "Appt_DateTime": "2025-07-29T16:10:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1141130",
          "Patient_First_Name": "KRISTIN",
          "Patient_Last_Name": "JOHNSTON",
          "Patient_DOB": "12-09-1984",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1141130",
          "Patient_First_Name": "KRISTIN",
          "Patient_Last_Name": "JOHNSTON",
          "Patient_DOB": "12-09-1984",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Royal Oak Woodward",
          "Appt_Resource_Descr": "US - Tanisha",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/MSK",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1141590",
          "Patient_First_Name": "GEORGE",
          "Patient_Last_Name": "STUTEVILLE",
          "Patient_DOB": "10-06-1988",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1144950",
          "Patient_First_Name": "SHANAE",
          "Patient_Last_Name": "SANDERS",
          "Patient_DOB": "03-25-1991",
          "Appt_DateTime": "2025-07-29T15:10:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1149830",
          "Patient_First_Name": "KASHAWN",
          "Patient_Last_Name": "WHITE",
          "Patient_DOB": "08-19-1978",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1152690",
          "Patient_First_Name": "DANTE",
          "Patient_Last_Name": "ALLEN",
          "Patient_DOB": "12-31-1999",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1153090",
          "Patient_First_Name": "HEATHER",
          "Patient_Last_Name": "HICKS",
          "Patient_DOB": "05-17-1995",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1153640",
          "Patient_First_Name": "JENNIFER",
          "Patient_Last_Name": "SCHOELCH",
          "Patient_DOB": "11-21-1976",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1153640",
          "Patient_First_Name": "JENNIFER",
          "Patient_Last_Name": "SCHOELCH",
          "Patient_DOB": "11-21-1976",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1153690",
          "Patient_First_Name": "MAXWELL",
          "Patient_Last_Name": "BOYD",
          "Patient_DOB": "11-29-1994",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1155670",
          "Patient_First_Name": "BRITTANY",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "02-18-1989",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1156970",
          "Patient_First_Name": "RYAN",
          "Patient_Last_Name": "NOOR",
          "Patient_DOB": "07-01-1966",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Sufi PA, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Sufi, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1158230",
          "Patient_First_Name": "ANIYAH",
          "Patient_Last_Name": "WHITMIRE",
          "Patient_DOB": "11-25-2011",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1161150",
          "Patient_First_Name": "SCOTT",
          "Patient_Last_Name": "HANDLEY",
          "Patient_DOB": "03-17-1993",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1163670",
          "Patient_First_Name": "GAIL",
          "Patient_Last_Name": "DAVIS",
          "Patient_DOB": "05-27-1968",
          "Appt_DateTime": "2025-07-29T15:45:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Mammogram",
          "Appt_Resource_Assoc_Prov_LFI": "Mammogram",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1166000",
          "Patient_First_Name": "KAMARI",
          "Patient_Last_Name": "COX",
          "Patient_DOB": "06-27-1977",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1166540",
          "Patient_First_Name": "JULIE",
          "Patient_Last_Name": "BARNETT",
          "Patient_DOB": "04-18-1983",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1167590",
          "Patient_First_Name": "JAMES",
          "Patient_Last_Name": "MASOURAS",
          "Patient_DOB": "03-02-1948",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1170750",
          "Patient_First_Name": "DENNIS",
          "Patient_Last_Name": "FISHER",
          "Patient_DOB": "10-04-1987",
          "Appt_DateTime": "2025-07-29T15:10:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1174660",
          "Patient_First_Name": "LYDIA",
          "Patient_Last_Name": "LORENZ",
          "Patient_DOB": "01-22-1996",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1175410",
          "Patient_First_Name": "RACHEL",
          "Patient_Last_Name": "DIGREGORIO",
          "Patient_DOB": "07-25-1986",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1176000",
          "Patient_First_Name": "DAVID",
          "Patient_Last_Name": "EVANS",
          "Patient_DOB": "04-28-1988",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1176330",
          "Patient_First_Name": "DELILAH",
          "Patient_Last_Name": "MOULTRY LOVE",
          "Patient_DOB": "07-06-1960",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Mammogram",
          "Appt_Resource_Assoc_Prov_LFI": "Mammogram",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1178890",
          "Patient_First_Name": "KEVIN",
          "Patient_Last_Name": "MESERVY",
          "Patient_DOB": "02-22-1991",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1182490",
          "Patient_First_Name": "CHARLENE",
          "Patient_Last_Name": "TEAGUE",
          "Patient_DOB": "07-05-1963",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1191500",
          "Patient_First_Name": "ALONZO",
          "Patient_Last_Name": "HARRISON",
          "Patient_DOB": "09-04-1968",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1191610",
          "Patient_First_Name": "MARIYA",
          "Patient_Last_Name": "CALHOUN",
          "Patient_DOB": "06-09-1999",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1191950",
          "Patient_First_Name": "TIANA",
          "Patient_Last_Name": "MCMILLER",
          "Patient_DOB": "03-25-1980",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1191970",
          "Patient_First_Name": "KEVIN",
          "Patient_Last_Name": "CAIN",
          "Patient_DOB": "04-14-1962",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1194900",
          "Patient_First_Name": "RENO",
          "Patient_Last_Name": "LANDERS",
          "Patient_DOB": "07-30-1968",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "063357",
          "Patient_First_Name": "FAITH",
          "Patient_Last_Name": "JONES",
          "Patient_DOB": "11-21-2008",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "644780",
          "Patient_First_Name": "TAMARA",
          "Patient_Last_Name": "REDD",
          "Patient_DOB": "02-25-1997",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "674680",
          "Patient_First_Name": "JOURNEY",
          "Patient_Last_Name": "LEAVELLS",
          "Patient_DOB": "07-21-2021",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "716580",
          "Patient_First_Name": "LAILA",
          "Patient_Last_Name": "HURT",
          "Patient_DOB": "11-14-2007",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "751580",
          "Patient_First_Name": "NEFERTARI",
          "Patient_Last_Name": "CRUMP",
          "Patient_DOB": "08-01-2022",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "766140",
          "Patient_First_Name": "MORGAN",
          "Patient_Last_Name": "SCOTT",
          "Patient_DOB": "08-16-2011",
          "Appt_DateTime": "2025-07-29T09:10:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "850020",
          "Patient_First_Name": "DARRYL",
          "Patient_Last_Name": "FREDERICK",
          "Patient_DOB": "11-22-1965",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "872570",
          "Patient_First_Name": "ERNEST",
          "Patient_Last_Name": "MONTGOMERY",
          "Patient_DOB": "01-09-2023",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Riggins NP, Valerie",
          "Appt_Resource_Assoc_Prov_LFI": "Riggins, Valerie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "256200",
          "Patient_First_Name": "KACEN",
          "Patient_Last_Name": "MAPPS",
          "Patient_DOB": "02-05-2015",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Riggins NP, Valerie",
          "Appt_Resource_Assoc_Prov_LFI": "Riggins, Valerie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "270660",
          "Patient_First_Name": "ALEXANDER",
          "Patient_Last_Name": "DIKIN",
          "Patient_DOB": "01-23-2009",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "BH - Rose B.",
          "Appt_Resource_Assoc_Prov_LFI": "Psychotherapy, Ferndale",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "379420",
          "Patient_First_Name": "XAVIER",
          "Patient_Last_Name": "SPEARMAN",
          "Patient_DOB": "05-16-2016",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit W Davison",
          "Appt_Resource_Descr": "Baugh PA, Leslie",
          "Appt_Resource_Assoc_Prov_LFI": "Baugh, Leslie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "187650",
          "Patient_First_Name": "JOY",
          "Patient_Last_Name": "JONES",
          "Patient_DOB": "06-15-2011",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "212900",
          "Patient_First_Name": "ZAIN",
          "Patient_Last_Name": "Al-KHABI",
          "Patient_DOB": "08-15-2009",
          "Appt_DateTime": "2025-07-29T09:01:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1217410",
          "Patient_First_Name": "LARON",
          "Patient_Last_Name": "KINNEY",
          "Patient_DOB": "08-30-1971",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1217470",
          "Patient_First_Name": "DARRELL",
          "Patient_Last_Name": "JOSEPH",
          "Patient_DOB": "11-26-1970",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1220580",
          "Patient_First_Name": "JOE",
          "Patient_Last_Name": "TODD",
          "Patient_DOB": "09-20-1972",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1226260",
          "Patient_First_Name": "ERIC",
          "Patient_Last_Name": "GARDNER",
          "Patient_DOB": "03-28-1994",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1226450",
          "Patient_First_Name": "ZAIRE",
          "Patient_Last_Name": "BARTON",
          "Patient_DOB": "09-13-1995",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1227150",
          "Patient_First_Name": "ALESIA",
          "Patient_Last_Name": "DEANE",
          "Patient_DOB": "04-18-1965",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1227560",
          "Patient_First_Name": "MALIK",
          "Patient_Last_Name": "FARONBI",
          "Patient_DOB": "12-25-1998",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1228130",
          "Patient_First_Name": "JULIET",
          "Patient_Last_Name": "THOMAS",
          "Patient_DOB": "02-04-1955",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1229600",
          "Patient_First_Name": "CARNELL",
          "Patient_Last_Name": "GILBERT",
          "Patient_DOB": "08-24-1962",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1230120",
          "Patient_First_Name": "SHARICE",
          "Patient_Last_Name": "ROUSEAU",
          "Patient_DOB": "05-10-1971",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Sufi PA, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Sufi, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1239870",
          "Patient_First_Name": "CEOLA",
          "Patient_Last_Name": "MERITY",
          "Patient_DOB": "08-17-1950",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1246660",
          "Patient_First_Name": "EDA",
          "Patient_Last_Name": "GASTMAN",
          "Patient_DOB": "01-15-1946",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1248690",
          "Patient_First_Name": "GEOFFREY",
          "Patient_Last_Name": "SHERMAN",
          "Patient_DOB": "04-16-1956",
          "Appt_DateTime": "2025-07-29T12:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1250610",
          "Patient_First_Name": "JACK",
          "Patient_Last_Name": "JORDAN",
          "Patient_DOB": "01-01-1973",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1261060",
          "Patient_First_Name": "MARILEAN",
          "Patient_Last_Name": "WHEELER",
          "Patient_DOB": "03-14-1963",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1262610",
          "Patient_First_Name": "MENACHEM",
          "Patient_Last_Name": "COHEN",
          "Patient_DOB": "02-12-1972",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1263920",
          "Patient_First_Name": "NANCY",
          "Patient_Last_Name": "CLAY",
          "Patient_DOB": "05-07-1947",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1263920",
          "Patient_First_Name": "NANCY",
          "Patient_Last_Name": "CLAY",
          "Patient_DOB": "05-07-1947",
          "Appt_DateTime": "2025-07-29T11:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1264220",
          "Patient_First_Name": "NEHEMIAH",
          "Patient_Last_Name": "HAMM",
          "Patient_DOB": "05-03-1976",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1266200",
          "Patient_First_Name": "PRINCE",
          "Patient_Last_Name": "BADIE",
          "Patient_DOB": "08-21-1967",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "011242",
          "Patient_First_Name": "NADIA",
          "Patient_Last_Name": "HARRIS",
          "Patient_DOB": "09-03-2000",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "021326",
          "Patient_First_Name": "ANNA",
          "Patient_Last_Name": "VENUK",
          "Patient_DOB": "03-07-2005",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "031548",
          "Patient_First_Name": "MOLLY",
          "Patient_Last_Name": "WILSON",
          "Patient_DOB": "09-21-2005",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "036139",
          "Patient_First_Name": "ROLAN",
          "Patient_Last_Name": "SUNDBERG",
          "Patient_DOB": "08-17-2006",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1272860",
          "Patient_First_Name": "TERESA",
          "Patient_Last_Name": "HOLLOWAY",
          "Patient_DOB": "12-19-1958",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1278960",
          "Patient_First_Name": "TIMNELL",
          "Patient_Last_Name": "MONTGOMERY",
          "Patient_DOB": "02-10-1980",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1278960",
          "Patient_First_Name": "TIMNELL",
          "Patient_Last_Name": "MONTGOMERY",
          "Patient_DOB": "02-10-1980",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Gray, Jacquis",
          "Appt_Resource_Assoc_Prov_LFI": "Gray, Jacquis",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1278960",
          "Patient_First_Name": "TIMNELL",
          "Patient_Last_Name": "MONTGOMERY",
          "Patient_DOB": "02-10-1980",
          "Appt_DateTime": "2025-07-29T14:30:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1281050",
          "Patient_First_Name": "SUREKHA",
          "Patient_Last_Name": "VEERA",
          "Patient_DOB": "03-29-1988",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1281890",
          "Patient_First_Name": "JOSLYN",
          "Patient_Last_Name": "MITCHELL",
          "Patient_DOB": "11-25-1973",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1282670",
          "Patient_First_Name": "DARRYL",
          "Patient_Last_Name": "STALLWORTH",
          "Patient_DOB": "07-22-1986",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Haque PA, Samra",
          "Appt_Resource_Assoc_Prov_LFI": "Haque, Samra",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1333340",
          "Patient_First_Name": "CAROL",
          "Patient_Last_Name": "WEAVER",
          "Patient_DOB": "08-09-1984",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1333810",
          "Patient_First_Name": "LILIAN",
          "Patient_Last_Name": "WILLIAMS",
          "Patient_DOB": "10-14-2000",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1335650",
          "Patient_First_Name": "TERRY",
          "Patient_Last_Name": "WATERMAN",
          "Patient_DOB": "02-23-1973",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1340140",
          "Patient_First_Name": "SUE",
          "Patient_Last_Name": "ROACH",
          "Patient_DOB": "05-18-1951",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1340140",
          "Patient_First_Name": "SUE",
          "Patient_Last_Name": "ROACH",
          "Patient_DOB": "05-18-1951",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1340690",
          "Patient_First_Name": "BETTY",
          "Patient_Last_Name": "ROSENBERG",
          "Patient_DOB": "05-08-1952",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1342000",
          "Patient_First_Name": "JUDITH",
          "Patient_Last_Name": "POWELL MARABLE",
          "Patient_DOB": "05-12-1968",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1344430",
          "Patient_First_Name": "JUSTIN",
          "Patient_Last_Name": "KLOTZ",
          "Patient_DOB": "03-28-1988",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1344560",
          "Patient_First_Name": "TONY",
          "Patient_Last_Name": "KURTZ",
          "Patient_DOB": "12-09-2006",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1284210",
          "Patient_First_Name": "HANNAH",
          "Patient_Last_Name": "COATES",
          "Patient_DOB": "09-13-2003",
          "Appt_DateTime": "2025-07-29T12:15:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "BH - Karen",
          "Appt_Resource_Assoc_Prov_LFI": "Nugent, Karen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1285510",
          "Patient_First_Name": "ANTHONY",
          "Patient_Last_Name": "HUNTER",
          "Patient_DOB": "03-02-1996",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1291170",
          "Patient_First_Name": "JYOTHI",
          "Patient_Last_Name": "TEST",
          "Patient_DOB": "01-31-2003",
          "Appt_DateTime": "2025-07-29T07:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1292150",
          "Patient_First_Name": "JOHN EDWARD",
          "Patient_Last_Name": "HUGHES",
          "Patient_DOB": "02-04-1973",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Hamtramck Davison",
          "Appt_Resource_Descr": "Whitmore PA, Nicole",
          "Appt_Resource_Assoc_Prov_LFI": "Whitmore, Nicole",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1368580",
          "Patient_First_Name": "MATILDE",
          "Patient_Last_Name": "PESCE",
          "Patient_DOB": "04-12-1964",
          "Appt_DateTime": "2025-07-29T08:55:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1368900",
          "Patient_First_Name": "JESUS",
          "Patient_Last_Name": "JIMENEZ",
          "Patient_DOB": "06-12-1953",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1369110",
          "Patient_First_Name": "GENESIS",
          "Patient_Last_Name": "PINCAY",
          "Patient_DOB": "10-05-2007",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1369590",
          "Patient_First_Name": "BENJAMIN",
          "Patient_Last_Name": "DEVORA",
          "Patient_DOB": "01-19-2014",
          "Appt_DateTime": "2025-07-29T14:25:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1370790",
          "Patient_First_Name": "CISNE",
          "Patient_Last_Name": "PINCAY",
          "Patient_DOB": "09-14-2016",
          "Appt_DateTime": "2025-07-29T11:25:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1373840",
          "Patient_First_Name": "ROSALINDA",
          "Patient_Last_Name": "QUIBAJA",
          "Patient_DOB": "01-04-2013",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1376830",
          "Patient_First_Name": "ANTHONY",
          "Patient_Last_Name": "OWENS",
          "Patient_DOB": "05-26-2017",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1377410",
          "Patient_First_Name": "MAHMOUD",
          "Patient_Last_Name": "KOOK",
          "Patient_DOB": "12-30-2010",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1378310",
          "Patient_First_Name": "ARACELI",
          "Patient_Last_Name": "ALEMAN RUBIO",
          "Patient_DOB": "09-03-1981",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1302510",
          "Patient_First_Name": "RONALD",
          "Patient_Last_Name": "BAILEY",
          "Patient_DOB": "05-24-1952",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1303110",
          "Patient_First_Name": "JUDITH",
          "Patient_Last_Name": "BLOODWORTH",
          "Patient_DOB": "12-16-1946",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1308540",
          "Patient_First_Name": "ROBERT",
          "Patient_Last_Name": "HUEBEL",
          "Patient_DOB": "04-18-1942",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1310980",
          "Patient_First_Name": "SHERRY",
          "Patient_Last_Name": "LIVERSEDGE",
          "Patient_DOB": "03-03-1947",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1313420",
          "Patient_First_Name": "JEAN",
          "Patient_Last_Name": "RAIS",
          "Patient_DOB": "02-24-1952",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1398550",
          "Patient_First_Name": "LEE",
          "Patient_Last_Name": "XIONG",
          "Patient_DOB": "08-14-1988",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1400730",
          "Patient_First_Name": "DAMARI",
          "Patient_Last_Name": "FORD",
          "Patient_DOB": "03-14-2002",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1400830",
          "Patient_First_Name": "JAMIER",
          "Patient_Last_Name": "GARDINER",
          "Patient_DOB": "08-19-2002",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1402780",
          "Patient_First_Name": "ANTHONY",
          "Patient_Last_Name": "NOVAK",
          "Patient_DOB": "08-27-1961",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1403340",
          "Patient_First_Name": "PAIGE",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "01-15-1991",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1404110",
          "Patient_First_Name": "ALI",
          "Patient_Last_Name": "FSAI",
          "Patient_DOB": "01-02-1969",
          "Appt_DateTime": "2025-07-29T09:50:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1405370",
          "Patient_First_Name": "NAILA",
          "Patient_Last_Name": "ALSABEH",
          "Patient_DOB": "12-01-1959",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1405550",
          "Patient_First_Name": "Ayushi",
          "Patient_Last_Name": "Test",
          "Patient_DOB": "07-07-2000",
          "Appt_DateTime": "2025-07-29T07:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1407110",
          "Patient_First_Name": "JANAE",
          "Patient_Last_Name": "WASHINGTON",
          "Patient_DOB": "08-15-2004",
          "Appt_DateTime": "2025-07-29T14:15:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1407750",
          "Patient_First_Name": "KENNETH",
          "Patient_Last_Name": "DIXON",
          "Patient_DOB": "04-26-1965",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1408380",
          "Patient_First_Name": "ARTIE L",
          "Patient_Last_Name": "LOCKETT",
          "Patient_DOB": "05-16-1960",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Joseph, Rosilin",
          "Appt_Resource_Assoc_Prov_LFI": "Joseph, rosilin",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1408450",
          "Patient_First_Name": "ABIODUN",
          "Patient_Last_Name": "BANKOLE",
          "Patient_DOB": "01-04-1993",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Gray, Jacquis",
          "Appt_Resource_Assoc_Prov_LFI": "Gray, Jacquis",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1408450",
          "Patient_First_Name": "ABIODUN",
          "Patient_Last_Name": "BANKOLE",
          "Patient_DOB": "01-04-1993",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1409710",
          "Patient_First_Name": "JUSTIN",
          "Patient_Last_Name": "LAFRAMBOISE",
          "Patient_DOB": "06-04-1984",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1466330",
          "Patient_First_Name": "NICHOLE",
          "Patient_Last_Name": "WRIGHT",
          "Patient_DOB": "07-08-1993",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1466910",
          "Patient_First_Name": "CECILIA",
          "Patient_Last_Name": "OROS",
          "Patient_DOB": "09-06-1999",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1467720",
          "Patient_First_Name": "DE'JA",
          "Patient_Last_Name": "GRAY",
          "Patient_DOB": "09-20-1995",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1467930",
          "Patient_First_Name": "ANNETTE",
          "Patient_Last_Name": "SIMS",
          "Patient_DOB": "12-18-1963",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1404310",
          "Patient_First_Name": "BALQES",
          "Patient_Last_Name": "ALJEBORI",
          "Patient_DOB": "01-01-1977",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "000005",
          "Patient_First_Name": "CAROL",
          "Patient_Last_Name": "JONES",
          "Patient_DOB": "10-07-1975",
          "Appt_DateTime": "2025-07-29T17:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1468040",
          "Patient_First_Name": "ELVIA",
          "Patient_Last_Name": "RODRIGUEZ",
          "Patient_DOB": "01-09-1980",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1468110",
          "Patient_First_Name": "JULIE",
          "Patient_Last_Name": "BONDY",
          "Patient_DOB": "04-21-1964",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1470460",
          "Patient_First_Name": "EMILY",
          "Patient_Last_Name": "TENNISWOOD",
          "Patient_DOB": "04-15-2000",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1470590",
          "Patient_First_Name": "MARALEE",
          "Patient_Last_Name": "LACHOVSKY",
          "Patient_DOB": "01-02-1958",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1470910",
          "Patient_First_Name": "LEONARD",
          "Patient_Last_Name": "WALLS",
          "Patient_DOB": "04-26-1995",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1471570",
          "Patient_First_Name": "SIMONE",
          "Patient_Last_Name": "ALEXANDER",
          "Patient_DOB": "11-30-1966",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1471620",
          "Patient_First_Name": "KORY",
          "Patient_Last_Name": "BENNETT",
          "Patient_DOB": "01-18-2002",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1471890",
          "Patient_First_Name": "THEOPHIS EUGENE",
          "Patient_Last_Name": "THOMAS",
          "Patient_DOB": "01-29-2005",
          "Appt_DateTime": "2025-07-29T12:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1170500",
          "Patient_First_Name": "ANGELINA",
          "Patient_Last_Name": "BARNETT",
          "Patient_DOB": "08-19-2012",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1469440",
          "Patient_First_Name": "SARAH",
          "Patient_Last_Name": "ZOLLER",
          "Patient_DOB": "01-05-1987",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1469650",
          "Patient_First_Name": "TIFFANY",
          "Patient_Last_Name": "GUNNING",
          "Patient_DOB": "08-20-1985",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Allergy Testing",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1472090",
          "Patient_First_Name": "ANIKA",
          "Patient_Last_Name": "ROBINSON",
          "Patient_DOB": "02-15-1972",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1472210",
          "Patient_First_Name": "TODD",
          "Patient_Last_Name": "CAMPBELL",
          "Patient_DOB": "05-31-1987",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1473340",
          "Patient_First_Name": "JAYDEN",
          "Patient_Last_Name": "RODRIGUEZ",
          "Patient_DOB": "08-20-2010",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1473440",
          "Patient_First_Name": "ALAN",
          "Patient_Last_Name": "SCHWARZ",
          "Patient_DOB": "07-13-1967",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Gadoua, Christopher",
          "Appt_Resource_Assoc_Prov_LFI": "Gadoua, Christopher",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1473630",
          "Patient_First_Name": "ANNA",
          "Patient_Last_Name": "MILLER",
          "Patient_DOB": "01-09-1998",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1473650",
          "Patient_First_Name": "MICHAEL",
          "Patient_Last_Name": "KOZLOWSKI",
          "Patient_DOB": "07-10-1968",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1473830",
          "Patient_First_Name": "NINA",
          "Patient_Last_Name": "LEBEDINSKAYA",
          "Patient_DOB": "08-04-1949",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1474110",
          "Patient_First_Name": "ANDRE",
          "Patient_Last_Name": "WYNES",
          "Patient_DOB": "01-01-2002",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Sufi PA, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Sufi, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1474180",
          "Patient_First_Name": "AUSTIN",
          "Patient_Last_Name": "HEARNS",
          "Patient_DOB": "07-07-1998",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1474980",
          "Patient_First_Name": "LAQUINTA",
          "Patient_Last_Name": "EDWARDS",
          "Patient_DOB": "10-14-1974",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1475060",
          "Patient_First_Name": "WANDA",
          "Patient_Last_Name": "HALL",
          "Patient_DOB": "03-02-1987",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1475440",
          "Patient_First_Name": "RONALD",
          "Patient_Last_Name": "FREEMAN",
          "Patient_DOB": "05-14-1976",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1475800",
          "Patient_First_Name": "DWAYNE",
          "Patient_Last_Name": "HOUSTON",
          "Patient_DOB": "04-11-1982",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1394480",
          "Patient_First_Name": "MARCIA",
          "Patient_Last_Name": "MCGOWAN",
          "Patient_DOB": "01-20-1965",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "589261",
          "Patient_First_Name": "RONALD",
          "Patient_Last_Name": "BOOKER",
          "Patient_DOB": "05-30-1961",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1475680",
          "Patient_First_Name": "ANTHONY",
          "Patient_Last_Name": "VITALI",
          "Patient_DOB": "09-28-2001",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1475960",
          "Patient_First_Name": "RAKYA",
          "Patient_Last_Name": "MONPGOMERY",
          "Patient_DOB": "11-20-2007",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Sufi PA, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Sufi, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1476630",
          "Patient_First_Name": "ASHER",
          "Patient_Last_Name": "GRIFFIN",
          "Patient_DOB": "11-13-2020",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Tourlaeva NP, Alyona",
          "Appt_Resource_Assoc_Prov_LFI": "Tourlaeva, Alyona",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477160",
          "Patient_First_Name": "KLAVDIYA",
          "Patient_Last_Name": "KOZITSKA",
          "Patient_DOB": "03-21-1946",
          "Appt_DateTime": "2025-07-29T11:45:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477160",
          "Patient_First_Name": "KLAVDIYA",
          "Patient_Last_Name": "KOZITSKA",
          "Patient_DOB": "03-21-1946",
          "Appt_DateTime": "2025-07-29T12:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477250",
          "Patient_First_Name": "KAMRYN",
          "Patient_Last_Name": "PARKMAN",
          "Patient_DOB": "09-24-2009",
          "Appt_DateTime": "2025-07-29T13:10:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477420",
          "Patient_First_Name": "ATHENA",
          "Patient_Last_Name": "MARCHAN ROMAN",
          "Patient_DOB": "08-20-2011",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477430",
          "Patient_First_Name": "Carol",
          "Patient_Last_Name": "Spencer",
          "Patient_DOB": "01-01-1971",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477430",
          "Patient_First_Name": "Carol",
          "Patient_Last_Name": "Spencer",
          "Patient_DOB": "01-01-1971",
          "Appt_DateTime": "2025-07-29T16:10:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1200970",
          "Patient_First_Name": "LINDSAY",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "11-18-1998",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1202530",
          "Patient_First_Name": "BERITA",
          "Patient_Last_Name": "MALONE",
          "Patient_DOB": "02-03-1970",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1208200",
          "Patient_First_Name": "KAREN",
          "Patient_Last_Name": "JANICE",
          "Patient_DOB": "02-02-1955",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1210730",
          "Patient_First_Name": "GARY",
          "Patient_Last_Name": "OWENS",
          "Patient_DOB": "07-27-1997",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1211460",
          "Patient_First_Name": "JAMIE",
          "Patient_Last_Name": "ROSE",
          "Patient_DOB": "06-23-1988",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1211460",
          "Patient_First_Name": "JAMIE",
          "Patient_Last_Name": "ROSE",
          "Patient_DOB": "06-23-1988",
          "Appt_DateTime": "2025-07-29T12:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Henderson, Lauren",
          "Appt_Resource_Assoc_Prov_LFI": "Henderson, Lauren",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1213540",
          "Patient_First_Name": "CANDACE",
          "Patient_Last_Name": "CARRINGTON",
          "Patient_DOB": "01-03-1969",
          "Appt_DateTime": "2025-07-29T17:50:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1213940",
          "Patient_First_Name": "AUJHANE",
          "Patient_Last_Name": "BATES",
          "Patient_DOB": "04-16-1997",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1216170",
          "Patient_First_Name": "BRELYNN",
          "Patient_Last_Name": "ANDREWS",
          "Patient_DOB": "11-09-1996",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1351540",
          "Patient_First_Name": "TYLER",
          "Patient_Last_Name": "ZIEMKE",
          "Patient_DOB": "09-14-1989",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1353220",
          "Patient_First_Name": "ASHLEY",
          "Patient_Last_Name": "SINGER",
          "Patient_DOB": "10-07-1992",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1354270",
          "Patient_First_Name": "ALEXANDER",
          "Patient_Last_Name": "PARTRIDGE",
          "Patient_DOB": "02-23-1995",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1354860",
          "Patient_First_Name": "HANS",
          "Patient_Last_Name": "VANDYKE",
          "Patient_DOB": "02-26-1944",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1354920",
          "Patient_First_Name": "DORIS",
          "Patient_Last_Name": "GARRETT",
          "Patient_DOB": "12-15-1951",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Benti",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/CAROTID",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1355500",
          "Patient_First_Name": "JORDAN",
          "Patient_Last_Name": "ADAMS",
          "Patient_DOB": "02-08-2002",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kurishi PA, Yasmine",
          "Appt_Resource_Assoc_Prov_LFI": "Kurishi, Yasmine",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1355500",
          "Patient_First_Name": "JORDAN",
          "Patient_Last_Name": "ADAMS",
          "Patient_DOB": "02-08-2002",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Tamara",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1356090",
          "Patient_First_Name": "ASHLEY",
          "Patient_Last_Name": "COLEMAN",
          "Patient_DOB": "11-10-1993",
          "Appt_DateTime": "2025-07-29T13:45:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1356530",
          "Patient_First_Name": "DANIEL",
          "Patient_Last_Name": "KOTA",
          "Patient_DOB": "11-21-1987",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1357920",
          "Patient_First_Name": "CHERYL",
          "Patient_Last_Name": "HOLLIDAY",
          "Patient_DOB": "11-28-1956",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Benti",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/CAROTID",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1358540",
          "Patient_First_Name": "TIFFANY",
          "Patient_Last_Name": "LAWRENCE",
          "Patient_DOB": "02-14-1976",
          "Appt_DateTime": "2025-07-29T13:30:00.000Z",
          "Appt_Sched_Location_Descr": "BLUE SKY",
          "Appt_Resource_Descr": "BLUE SKY, PROVENTION CENTERS",
          "Appt_Resource_Assoc_Prov_LFI": "BLUE SKY, PROVENTION CENTERS",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1358980",
          "Patient_First_Name": "CARTER",
          "Patient_Last_Name": "TOLBERT",
          "Patient_DOB": "04-21-2005",
          "Appt_DateTime": "2025-07-29T13:01:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1359270",
          "Patient_First_Name": "CYNTHIA",
          "Patient_Last_Name": "DORMAN",
          "Patient_DOB": "11-06-1962",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Hnatio PA, Bryan",
          "Appt_Resource_Assoc_Prov_LFI": "Hnatio, Bryan",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1360180",
          "Patient_First_Name": "TRINA",
          "Patient_Last_Name": "KARR",
          "Patient_DOB": "07-11-1956",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1361580",
          "Patient_First_Name": "KENNETH",
          "Patient_Last_Name": "GREER",
          "Patient_DOB": "10-28-1960",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1361780",
          "Patient_First_Name": "DENISE",
          "Patient_Last_Name": "HAZIRI",
          "Patient_DOB": "08-28-1974",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Syms PA, Margaret",
          "Appt_Resource_Assoc_Prov_LFI": "Syms, Margaret",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1361850",
          "Patient_First_Name": "WANDA",
          "Patient_Last_Name": "MCKEOWN",
          "Patient_DOB": "02-17-1964",
          "Appt_DateTime": "2025-07-29T09:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1362050",
          "Patient_First_Name": "DONNA",
          "Patient_Last_Name": "WHITE-JONES",
          "Patient_DOB": "11-12-1965",
          "Appt_DateTime": "2025-07-29T17:10:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1362360",
          "Patient_First_Name": "DEBRA",
          "Patient_Last_Name": "ABRAHAM",
          "Patient_DOB": "09-23-1959",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Sufi PA, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Sufi, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1362420",
          "Patient_First_Name": "YERIKO",
          "Patient_Last_Name": "VARGAS SANTAMARIA",
          "Patient_DOB": "11-03-1993",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1363030",
          "Patient_First_Name": "KARA",
          "Patient_Last_Name": "NIEMI",
          "Patient_DOB": "07-20-1994",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Cunningham PA, Alexa",
          "Appt_Resource_Assoc_Prov_LFI": "Cunningham, Alexa",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1363030",
          "Patient_First_Name": "KARA",
          "Patient_Last_Name": "NIEMI",
          "Patient_DOB": "07-20-1994",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1363320",
          "Patient_First_Name": "FLORES",
          "Patient_Last_Name": "MARIA",
          "Patient_DOB": "05-10-1950",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Chicago N Cicero",
          "Appt_Resource_Descr": "Leong MD, Jack",
          "Appt_Resource_Assoc_Prov_LFI": "Leong, Jack",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1382650",
          "Patient_First_Name": "DARLINE",
          "Patient_Last_Name": "FITZPATRICK",
          "Patient_DOB": "07-29-1980",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Gray, Jacquis",
          "Appt_Resource_Assoc_Prov_LFI": "Gray, Jacquis",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1383660",
          "Patient_First_Name": "DARIUS",
          "Patient_Last_Name": "PINDER",
          "Patient_DOB": "08-29-1977",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Wright, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Wright, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1384680",
          "Patient_First_Name": "TARA",
          "Patient_Last_Name": "CARTER",
          "Patient_DOB": "10-30-1998",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1387280",
          "Patient_First_Name": "ABRIANNA",
          "Patient_Last_Name": "SUTHERLAND",
          "Patient_DOB": "06-16-2001",
          "Appt_DateTime": "2025-07-29T08:45:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Brodsky MD, Burton",
          "Appt_Resource_Assoc_Prov_LFI": "Brodsky, Burton",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1388680",
          "Patient_First_Name": "AMANDA",
          "Patient_Last_Name": "DUNCAN",
          "Patient_DOB": "11-13-1989",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1390850",
          "Patient_First_Name": "MARY",
          "Patient_Last_Name": "JOHNSON",
          "Patient_DOB": "09-12-1987",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Doherty FNP, Kelly",
          "Appt_Resource_Assoc_Prov_LFI": "Doherty, Kelly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1391940",
          "Patient_First_Name": "JOSHUA",
          "Patient_Last_Name": "DOWELL",
          "Patient_DOB": "03-02-1991",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1392680",
          "Patient_First_Name": "SHIRINA",
          "Patient_Last_Name": "MANIER",
          "Patient_DOB": "01-12-1980",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1393850",
          "Patient_First_Name": "LISA",
          "Patient_Last_Name": "WALKER",
          "Patient_DOB": "09-29-1959",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Hobson PA, Allison",
          "Appt_Resource_Assoc_Prov_LFI": "Hobson, Alison",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1396840",
          "Patient_First_Name": "SHAUN",
          "Patient_Last_Name": "SAYYAE",
          "Patient_DOB": "10-17-1991",
          "Appt_DateTime": "2025-07-29T08:25:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1396890",
          "Patient_First_Name": "NICOLE",
          "Patient_Last_Name": "CARTER",
          "Patient_DOB": "02-18-1985",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1317140",
          "Patient_First_Name": "ANDREA",
          "Patient_Last_Name": "WILLMAN",
          "Patient_DOB": "10-22-1952",
          "Appt_DateTime": "2025-07-29T09:25:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1317700",
          "Patient_First_Name": "JOHN",
          "Patient_Last_Name": "AMBROSIER",
          "Patient_DOB": "03-14-1951",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1319630",
          "Patient_First_Name": "EVAN",
          "Patient_Last_Name": "CHAMBERS",
          "Patient_DOB": "02-24-2006",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1321170",
          "Patient_First_Name": "DANIEL",
          "Patient_Last_Name": "ECHOLS",
          "Patient_DOB": "04-12-1975",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1322080",
          "Patient_First_Name": "MARIELL",
          "Patient_Last_Name": "GENOVESI",
          "Patient_DOB": "11-24-1979",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1322700",
          "Patient_First_Name": "JAMES",
          "Patient_Last_Name": "GUERRERO",
          "Patient_DOB": "04-03-1972",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1326000",
          "Patient_First_Name": "TAMMY",
          "Patient_Last_Name": "LIVERSEDGE",
          "Patient_DOB": "08-24-1975",
          "Appt_DateTime": "2025-07-29T11:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1326330",
          "Patient_First_Name": "DERICK",
          "Patient_Last_Name": "MARCUM",
          "Patient_DOB": "07-16-1985",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1329000",
          "Patient_First_Name": "ALEXIS",
          "Patient_Last_Name": "POGGIALI",
          "Patient_DOB": "06-26-1981",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1329520",
          "Patient_First_Name": "KENNETH",
          "Patient_Last_Name": "REEVES",
          "Patient_DOB": "02-12-1965",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1330390",
          "Patient_First_Name": "BERNADETTE",
          "Patient_Last_Name": "SCOTT",
          "Patient_DOB": "04-22-1962",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1331230",
          "Patient_First_Name": "MICHAEL",
          "Patient_Last_Name": "SPURGEON",
          "Patient_DOB": "01-24-1963",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1331300",
          "Patient_First_Name": "BEVERLY",
          "Patient_Last_Name": "STORM",
          "Patient_DOB": "03-11-1953",
          "Appt_DateTime": "2025-07-29T13:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Vegezzi NP, Lindsay",
          "Appt_Resource_Assoc_Prov_LFI": "Vegezzi, Lindsay",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1429830",
          "Patient_First_Name": "LAURA",
          "Patient_Last_Name": "SEGAL",
          "Patient_DOB": "02-20-1953",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1432300",
          "Patient_First_Name": "LYUDMILA",
          "Patient_Last_Name": "ZAVERINA",
          "Patient_DOB": "07-15-1948",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1433090",
          "Patient_First_Name": "YURY",
          "Patient_Last_Name": "VOLDMAN",
          "Patient_DOB": "02-21-1947",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1433670",
          "Patient_First_Name": "MARIYA",
          "Patient_Last_Name": "CHERNOVA",
          "Patient_DOB": "03-29-1946",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1433670",
          "Patient_First_Name": "MARIYA",
          "Patient_Last_Name": "CHERNOVA",
          "Patient_DOB": "03-29-1946",
          "Appt_DateTime": "2025-07-29T12:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1434560",
          "Patient_First_Name": "ANNA",
          "Patient_Last_Name": "SHTRIKMAN",
          "Patient_DOB": "06-09-1943",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1436020",
          "Patient_First_Name": "BELA",
          "Patient_Last_Name": "GUREVICH",
          "Patient_DOB": "12-16-1938",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1436360",
          "Patient_First_Name": "RAISA",
          "Patient_Last_Name": "STASYUK",
          "Patient_DOB": "01-01-1938",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1436930",
          "Patient_First_Name": "ILLIODOR",
          "Patient_Last_Name": "SHUTKOV",
          "Patient_DOB": "11-28-1936",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1436990",
          "Patient_First_Name": "CHARLES",
          "Patient_Last_Name": "BELLMORE",
          "Patient_DOB": "08-28-1936",
          "Appt_DateTime": "2025-07-29T10:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1437550",
          "Patient_First_Name": "ISAK",
          "Patient_Last_Name": "PRESS",
          "Patient_DOB": "07-14-1934",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1442780",
          "Patient_First_Name": "DENISE",
          "Patient_Last_Name": "CALDWELL",
          "Patient_DOB": "04-20-1970",
          "Appt_DateTime": "2025-07-29T14:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Benti",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - NO ECHO/CAROTID",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1445570",
          "Patient_First_Name": "STEVEN",
          "Patient_Last_Name": "ERNST",
          "Patient_DOB": "03-06-1957",
          "Appt_DateTime": "2025-07-29T11:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit W Davison",
          "Appt_Resource_Descr": "Baugh PA, Leslie",
          "Appt_Resource_Assoc_Prov_LFI": "Baugh, Leslie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1447140",
          "Patient_First_Name": "MARGARET",
          "Patient_Last_Name": "GRIMES",
          "Patient_DOB": "12-27-1962",
          "Appt_DateTime": "2025-07-29T15:45:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit W Davison",
          "Appt_Resource_Descr": "Baugh PA, Leslie",
          "Appt_Resource_Assoc_Prov_LFI": "Baugh, Leslie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1450050",
          "Patient_First_Name": "AZELE",
          "Patient_Last_Name": "JONES",
          "Patient_DOB": "02-01-1949",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit W Davison",
          "Appt_Resource_Descr": "Baugh PA, Leslie",
          "Appt_Resource_Assoc_Prov_LFI": "Baugh, Leslie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1455660",
          "Patient_First_Name": "JAMEELAH",
          "Patient_Last_Name": "ROBERTS",
          "Patient_DOB": "04-25-1978",
          "Appt_DateTime": "2025-07-29T09:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Khemmoro PA, Annaliese",
          "Appt_Resource_Assoc_Prov_LFI": "Khemmoro, Annaliese",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1462090",
          "Patient_First_Name": "ALEXANDER",
          "Patient_Last_Name": "GOULET",
          "Patient_DOB": "02-10-1996",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit 7 Mile",
          "Appt_Resource_Descr": "Melek PA, Youstina",
          "Appt_Resource_Assoc_Prov_LFI": "Melek, Youstina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1463930",
          "Patient_First_Name": "ROCKYBA",
          "Patient_Last_Name": "FERGUSON",
          "Patient_DOB": "03-05-1976",
          "Appt_DateTime": "2025-07-29T14:10:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "US - Safa",
          "Appt_Resource_Assoc_Prov_LFI": "Ultrasound - ECHO ONLY",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1464220",
          "Patient_First_Name": "JOAN",
          "Patient_Last_Name": "BUTLER",
          "Patient_DOB": "08-21-1952",
          "Appt_DateTime": "2025-07-29T14:00:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1464220",
          "Patient_First_Name": "JOAN",
          "Patient_Last_Name": "BUTLER",
          "Patient_DOB": "08-21-1952",
          "Appt_DateTime": "2025-07-29T15:10:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "US - Ronica",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1464590",
          "Patient_First_Name": "MIKA",
          "Patient_Last_Name": "MISAWA",
          "Patient_DOB": "05-31-2003",
          "Appt_DateTime": "2025-07-29T11:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Chabaan, Deena",
          "Appt_Resource_Assoc_Prov_LFI": "Chabaan, Deena",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1464830",
          "Patient_First_Name": "CHRISTOPHER",
          "Patient_Last_Name": "SMITH",
          "Patient_DOB": "09-15-1989",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Xiong PA, Bethany",
          "Appt_Resource_Assoc_Prov_LFI": "Xiong, Bethany",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1465410",
          "Patient_First_Name": "CAMILLE",
          "Patient_Last_Name": "WALKER",
          "Patient_DOB": "08-01-1967",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Sadler, Jessica",
          "Appt_Resource_Assoc_Prov_LFI": "Sadler, Jessica",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1465460",
          "Patient_First_Name": "JOSHUA",
          "Patient_Last_Name": "SCHAFFER",
          "Patient_DOB": "11-06-2003",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "BH - Shavon",
          "Appt_Resource_Assoc_Prov_LFI": "ROMITA, SHAVON",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1465810",
          "Patient_First_Name": "VANESSA",
          "Patient_Last_Name": "CALLAHAN",
          "Patient_DOB": "07-31-1990",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Ferndale",
          "Appt_Resource_Descr": "DPT - Ebert, McKenna",
          "Appt_Resource_Assoc_Prov_LFI": "Ebert, McKenna",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1414550",
          "Patient_First_Name": "GLORIA",
          "Patient_Last_Name": "WORKS",
          "Patient_DOB": "09-29-1988",
          "Appt_DateTime": "2025-07-29T15:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1414670",
          "Patient_First_Name": "BORIS",
          "Patient_Last_Name": "KRASNOV",
          "Patient_DOB": "06-15-1988",
          "Appt_DateTime": "2025-07-29T17:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1415770",
          "Patient_First_Name": "OKSANA",
          "Patient_Last_Name": "MIRZOYAN",
          "Patient_DOB": "08-28-1984",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Webster, Shannon PAC",
          "Appt_Resource_Assoc_Prov_LFI": "Webster, Shannon",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1418360",
          "Patient_First_Name": "VIKTORIYA",
          "Patient_Last_Name": "KHAYKIN",
          "Patient_DOB": "12-03-1976",
          "Appt_DateTime": "2025-07-29T15:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1418530",
          "Patient_First_Name": "ROBERT",
          "Patient_Last_Name": "MCCOMBE",
          "Patient_DOB": "03-01-1976",
          "Appt_DateTime": "2025-07-29T08:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1418640",
          "Patient_First_Name": "IRINA",
          "Patient_Last_Name": "ZVONOVA",
          "Patient_DOB": "11-17-1975",
          "Appt_DateTime": "2025-07-29T14:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1418640",
          "Patient_First_Name": "IRINA",
          "Patient_Last_Name": "ZVONOVA",
          "Patient_DOB": "11-17-1975",
          "Appt_DateTime": "2025-07-29T15:50:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1418660",
          "Patient_First_Name": "ROMAN",
          "Patient_Last_Name": "ZILBERMAN",
          "Patient_DOB": "09-28-1975",
          "Appt_DateTime": "2025-07-29T13:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1424340",
          "Patient_First_Name": "IGOR",
          "Patient_Last_Name": "BEDRUS",
          "Patient_DOB": "06-25-1963",
          "Appt_DateTime": "2025-07-29T08:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Yaldoo, Mary",
          "Appt_Resource_Assoc_Prov_LFI": "Yaldoo, Mary",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1425810",
          "Patient_First_Name": "LARISA",
          "Patient_Last_Name": "KOTOV",
          "Patient_DOB": "01-05-1961",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1426430",
          "Patient_First_Name": "EUGENIA",
          "Patient_Last_Name": "FEY",
          "Patient_DOB": "11-16-1959",
          "Appt_DateTime": "2025-07-29T08:55:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "PA, Lab X-Ray",
          "Appt_Resource_Assoc_Prov_LFI": "PA, Lab X-Ray",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1426520",
          "Patient_First_Name": "MARSHA",
          "Patient_Last_Name": "TORBERT",
          "Patient_DOB": "09-22-1959",
          "Appt_DateTime": "2025-07-29T09:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1427170",
          "Patient_First_Name": "JEANNETTE",
          "Patient_Last_Name": "BARNES",
          "Patient_DOB": "04-14-1958",
          "Appt_DateTime": "2025-07-29T08:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield Telegraph",
          "Appt_Resource_Descr": "Fedirko FNP-BC, Nicolas",
          "Appt_Resource_Assoc_Prov_LFI": "Fedirko, Nicolas",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1427170",
          "Patient_First_Name": "JEANNETTE",
          "Patient_Last_Name": "BARNES",
          "Patient_DOB": "04-14-1958",
          "Appt_DateTime": "2025-07-29T09:30:00.000Z",
          "Appt_Sched_Location_Descr": "Farmbrook Radiology Associates PC",
          "Appt_Resource_Descr": "FBRAD-Christine",
          "Appt_Resource_Assoc_Prov_LFI": null,
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1428650",
          "Patient_First_Name": "BONNIE",
          "Patient_Last_Name": "MEDWED",
          "Patient_DOB": "06-21-1955",
          "Appt_DateTime": "2025-07-29T10:30:00.000Z",
          "Appt_Sched_Location_Descr": "DIAG EP Southfield",
          "Appt_Resource_Descr": "Exercise Stress, Stress ABI, DEXA",
          "Appt_Resource_Assoc_Prov_LFI": "Stress Testing, GXT & ABI",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1463690",
          "Patient_First_Name": "RONALD",
          "Patient_Last_Name": "TATE",
          "Patient_DOB": "03-19-1966",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "SPEC EP Southfield Telegraph",
          "Appt_Resource_Descr": "Hadla MD, Tarek",
          "Appt_Resource_Assoc_Prov_LFI": "Hadla, Tarek",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1476210",
          "Patient_First_Name": "DASHANA",
          "Patient_Last_Name": "O'NEAL",
          "Patient_DOB": "01-15-1987",
          "Appt_DateTime": "2025-07-29T13:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Riggins NP, Valerie",
          "Appt_Resource_Assoc_Prov_LFI": "Riggins, Valerie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1476430",
          "Patient_First_Name": "ANIEASHA",
          "Patient_Last_Name": "JUSTICE",
          "Patient_DOB": "12-05-1996",
          "Appt_DateTime": "2025-07-29T14:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Royal Oak Woodward",
          "Appt_Resource_Descr": "Yazdani PA, Hajira",
          "Appt_Resource_Assoc_Prov_LFI": "Yazdani, Hajira",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1476680",
          "Patient_First_Name": "CAMARI",
          "Patient_Last_Name": "WATTS",
          "Patient_DOB": "02-20-2012",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "George FNP-BC, Christina",
          "Appt_Resource_Assoc_Prov_LFI": "George, Christina",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477010",
          "Patient_First_Name": "LEAH",
          "Patient_Last_Name": "WHITEHEAD",
          "Patient_DOB": "03-04-1992",
          "Appt_DateTime": "2025-07-29T16:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Southfield 10 Mile",
          "Appt_Resource_Descr": "Kalabat, Amber",
          "Appt_Resource_Assoc_Prov_LFI": "Kalabat, Amber",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477040",
          "Patient_First_Name": "DAMON",
          "Patient_Last_Name": "SEWELL",
          "Patient_DOB": "06-05-1992",
          "Appt_DateTime": "2025-07-29T10:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit W Davison",
          "Appt_Resource_Descr": "Baugh PA, Leslie",
          "Appt_Resource_Assoc_Prov_LFI": "Baugh, Leslie",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477180",
          "Patient_First_Name": "CHRISTIAN",
          "Patient_Last_Name": "COHILL",
          "Patient_DOB": "06-09-2007",
          "Appt_DateTime": "2025-07-29T17:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Detroit Livernois",
          "Appt_Resource_Descr": "Haggerty PA, Kimberly",
          "Appt_Resource_Assoc_Prov_LFI": "Haggerty, Kimberly",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477240",
          "Patient_First_Name": "BRIAN",
          "Patient_Last_Name": "FINERAN",
          "Patient_DOB": "12-24-1970",
          "Appt_DateTime": "2025-07-29T15:40:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Ferndale 9 Mile",
          "Appt_Resource_Descr": "Mozurkewich, Eric",
          "Appt_Resource_Assoc_Prov_LFI": "Mozurkewich, Eric",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1477470",
          "Patient_First_Name": "KYMIR",
          "Patient_Last_Name": "WEBSTER",
          "Patient_DOB": "03-27-1997",
          "Appt_DateTime": "2025-07-29T16:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC Flint Linden",
          "Appt_Resource_Descr": "Davis, Janelle",
          "Appt_Resource_Assoc_Prov_LFI": "Davis, Janelle",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1123840",
          "Patient_First_Name": "GERALD",
          "Patient_Last_Name": "WIMBROW",
          "Patient_DOB": "12-15-1959",
          "Appt_DateTime": "2025-07-29T10:20:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      },
      {
        "json": {
          "MRN": "1123990",
          "Patient_First_Name": "ULRICH",
          "Patient_Last_Name": "PEARCE",
          "Patient_DOB": "07-19-1956",
          "Appt_DateTime": "2025-07-29T16:00:00.000Z",
          "Appt_Sched_Location_Descr": "EPIC SCS Harper",
          "Appt_Resource_Descr": "Toubia, Allen",
          "Appt_Resource_Assoc_Prov_LFI": "Toubia, Allen",
          "Appt_Status": "A"
        }
      }
    ],
    "Get many rows1": [
      {
        "json": {
          "Id": 3,
          "Field": "location",
          "CreatedAt": "2025-06-17 16:34:51",
          "UpdatedAt": "2025-06-17 16:35:07",
          "Value": "EPIC Southfield 10 Mile"
        }
      },
      {
        "json": {
          "Id": 7,
          "Field": "location",
          "CreatedAt": "2025-06-17 17:27:36",
          "UpdatedAt": null,
          "Value": "EPIC Southfield Telegraph"
        }
      },
      {
        "json": {
          "Id": 11,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:13:29",
          "UpdatedAt": null,
          "Value": "EPIC Chicago North Cicero"
        }
      },
      {
        "json": {
          "Id": 12,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:13:45",
          "UpdatedAt": null,
          "Value": "EPIC Detroit 7 Mile"
        }
      },
      {
        "json": {
          "Id": 13,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:13:56",
          "UpdatedAt": null,
          "Value": "EPIC Detroit Livernois"
        }
      },
      {
        "json": {
          "Id": 15,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:14:20",
          "UpdatedAt": null,
          "Value": "EPIC Detroit W Davison"
        }
      },
      {
        "json": {
          "Id": 16,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:14:31",
          "UpdatedAt": null,
          "Value": "EPIC Ferndale 9 Mile"
        }
      },
      {
        "json": {
          "Id": 17,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:14:40",
          "UpdatedAt": null,
          "Value": "EPIC Flint Linden"
        }
      },
      {
        "json": {
          "Id": 18,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:14:49",
          "UpdatedAt": null,
          "Value": "EPIC Hamtramck Davison"
        }
      },
      {
        "json": {
          "Id": 20,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:14:58",
          "UpdatedAt": null,
          "Value": "EPIC Royal Oak Woodward"
        }
      },
      {
        "json": {
          "Id": 21,
          "Field": "location",
          "CreatedAt": "2025-06-17 18:15:08",
          "UpdatedAt": null,
          "Value": "EPIC SCS Harper"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 7,
  "updatedAt": "2025-07-30T09:18:46.026Z",
  "versionId": "aa9258a7-0345-411f-868d-60fbd1d145b3"
}