{
  "active": false,
  "connections": {
    "Webhook1": {
      "main": [
        [
          {
            "node": "NocoDB1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NocoDB2": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [
          {
            "node": "Limit",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NocoDB3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [
          {
            "node": "Limit1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "NocoDB5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking \"Test workflow\"": {
      "main": [
        [
          {
            "node": "NocoDB4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit": {
      "main": [
        [
          {
            "node": "Send Script to all Agents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NocoDB3": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NocoDB4": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NocoDB5": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "NocoDB6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [],
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out Site Names": {
      "main": [
        [
          {
            "node": "Filter to CDN Site",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Retrieve All Site Agents": {
      "main": [
        [
          {
            "node": "Map Room to Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get RMM Clients2": {
      "main": [
        [
          {
            "node": "Split Out Site Names",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter to CDN Site": {
      "main": [
        [
          {
            "node": "Retrieve All Site Agents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Map Room to Agent2": {
      "main": [
        [
          {
            "node": "Send Download Script to Single Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "NocoDB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "NocoDB6": {
      "main": [
        [
          {
            "node": "Limit2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Script to all Agents": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "NocoDB7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Script to all Agents1": {
      "main": [
        []
      ]
    },
    "NocoDB7": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "No Operation, do nothing2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Map Room to Agent": {
      "main": [
        [
          {
            "node": "Send Download Script to Single Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Download Script to Single Agent1": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Download Script to Single Agent": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get RMM Clients4": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk1": {
      "main": [
        [
          {
            "node": "Extract from File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File1": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Map Room to Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk2": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read/Write Files from Disk3": {
      "main": [
        [
          {
            "node": "Extract from File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File2": {
      "main": [
        [
          {
            "node": "Split Out2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out2": {
      "main": [
        [
          {
            "node": "Map Room to Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit1": {
      "main": [
        [
          {
            "node": "Send Script to all Agents1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Operation, do nothing": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Operation, do nothing1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Operation, do nothing3": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "NocoDB2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Limit2": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Operation, do nothing2": {
      "main": [
        [
          {
            "node": "Read/Write Files from Disk3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger2": {
      "main": [
        [
          {
            "node": "NocoDB4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2024-06-30T11:44:01.784Z",
  "id": "Pfl21AwQxhCU3hnh",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "EHR 2024 Check",
  "nodes": [
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "create",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mnw77dpsv1v54m3",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldName": "Hostname",
              "fieldValue": "={{ $json.query.hostname }}"
            },
            {
              "fieldName": "Status",
              "fieldValue": "={{ $json.query.status }}"
            }
          ]
        }
      },
      "id": "c10ea44f-2dd3-41a7-85bf-2d3b6de83843",
      "name": "NocoDB",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        1360,
        560
      ],
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "create",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mg86jglo5qmeb27",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldName": "Hostname",
              "fieldValue": "={{ $json.query.hostname }}"
            },
            {
              "fieldName": "Status",
              "fieldValue": "={{ $json.query.status }}"
            }
          ]
        }
      },
      "id": "86c073b9-3fb8-413e-bc7a-d27f186bdeb4",
      "name": "NocoDB1",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        1360,
        780
      ],
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      }
    },
    {
      "parameters": {
        "path": "9c562997-78ef-4743-a8cd-d2619ff40daf",
        "options": {}
      },
      "id": "a67c9b1a-c46b-4ba2-8242-af50d0987948",
      "name": "Webhook1",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        1140,
        780
      ],
      "webhookId": "9c562997-78ef-4743-a8cd-d2619ff40daf",
      "disabled": true
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "0f5f72f0-353c-4df7-93a8-c260b18bdecc",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        3440,
        1440
      ]
    },
    {
      "parameters": {
        "content": "# Delete Records",
        "height": 476.9253735840722,
        "width": 1364.9174113959828,
        "color": 3
      },
      "id": "e616a0b5-b052-4284-9d50-4a2425fd2b07",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1180,
        1220
      ]
    },
    {
      "parameters": {
        "height": 644.8660529903567,
        "width": 2867.638976691342,
        "color": 5
      },
      "id": "09c45948-1f7e-4e38-8d22-f690703b2b8a",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2660,
        1220
      ]
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "getAll",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mg86jglo5qmeb27",
        "returnAll": true,
        "options": {}
      },
      "id": "6b2a50bb-b90e-4435-ad22-a76ca2a32c70",
      "name": "NocoDB2",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        1220,
        1380
      ],
      "alwaysOutputData": true,
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "03722d28-6650-4236-b6d3-6748cfc9e68a",
      "name": "Loop Over Items1",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1440,
        1380
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "ac5e1153-e9c8-4364-8eac-0018ee192e0d",
      "name": "Loop Over Items2",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1480,
        2220
      ]
    },
    {
      "parameters": {},
      "id": "faa0a68c-0870-4e70-8bf5-79c0118b9c43",
      "name": "When clicking \"Test workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        880,
        1900
      ]
    },
    {
      "parameters": {},
      "id": "9abda1d5-5908-4f09-b1c4-aa15b5e4dfec",
      "name": "Limit",
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        1660,
        1280
      ]
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "delete",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mg86jglo5qmeb27",
        "id": "={{ $json.Id }}"
      },
      "id": "4c9025d8-824f-4088-8351-4b0febe8c998",
      "name": "NocoDB3",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        1700,
        1460
      ],
      "alwaysOutputData": true,
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "getAll",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mnw77dpsv1v54m3",
        "returnAll": true,
        "options": {}
      },
      "id": "b52ba8a4-6322-4fe6-a2a1-b833eb6d79df",
      "name": "NocoDB4",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        1260,
        2180
      ],
      "alwaysOutputData": true,
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "delete",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mnw77dpsv1v54m3",
        "id": "={{ $json.Id }}"
      },
      "id": "69673633-da99-42cd-b4bc-a0eb898b0b2b",
      "name": "NocoDB5",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        1740,
        2300
      ],
      "alwaysOutputData": true,
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "= https://api.wiretapped.app/agents/{{ $('Map Room to Agent2').item.json[\"agent_id\"] }}/cmd/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={\n\"args\":[],\n\"custom_field\":\"null\",\n\"emailMode\":\"default\",\n\"emails\": [],\n\"env_vars\":[],\n\"output\":\"forget\",\n\"run_as_user\":\"false\",\n\"save_all_output\": \"false\",\n\"script\":\"155\",\n\"timeout\":\"90\"\n}",
        "options": {}
      },
      "id": "aa038f7e-ed0b-40f8-a810-1f39bc8a184e",
      "name": "Send Powershell CMD to RMM Agent6",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        3060,
        -80
      ],
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.wiretapped.app/agents/KifkNQAdFtykPUeIJBstTLLqFMsXkuFNJJopRWRp/runscript/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "options": {}
      },
      "id": "64dec979-f190-4ee6-99d3-08070ec12cae",
      "name": "Get RMM Clients1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        2760,
        -80
      ]
    },
    {
      "parameters": {
        "height": 559.0707433944768,
        "width": 2106.242594109466
      },
      "id": "2fec373f-1e5d-4288-8b76-08de405e21ff",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2400,
        -280
      ]
    },
    {
      "parameters": {
        "amount": 15
      },
      "id": "bd862348-c3a6-477d-8b15-ebfc6d25957c",
      "name": "Wait",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2960,
        1440
      ],
      "webhookId": "d52629c4-abb2-4222-8a3f-c9db7821da20"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "767e6df8-5199-4c4a-830d-4a5241b77aa4",
              "leftValue": "={{ $json.Status }}",
              "rightValue": "=ManualCheckRequired",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "9fee98d5-c311-4525-a31b-fcc0b921ba7c",
      "name": "If",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        3740,
        1460
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "74b2ab28-7bf6-4790-a14a-4924c17e1deb",
      "name": "Loop Over Items3",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        3440,
        2180
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "sites",
        "options": {}
      },
      "id": "cd485fa1-f724-41ee-9b5a-89876572c081",
      "name": "Split Out Site Names",
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        5120,
        360
      ]
    },
    {
      "parameters": {
        "url": "=https://api.wiretapped.app/agents/?site={{ $json.id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "options": {}
      },
      "id": "d8cab095-edab-449a-801f-78a58606f491",
      "name": "Retrieve All Site Agents",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        5580,
        360
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "b82c02fb-fd74-4489-80a1-788540f6ec46",
                    "leftValue": "={{ $json.hostname }}",
                    "rightValue": "={{ $('Webhook').item.json[\"query\"][\"hostname\"] }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "08617ba5-ed25-4491-9e3d-7816c4aeed98",
      "name": "Map Room to Agent1",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        6000,
        360
      ]
    },
    {
      "parameters": {
        "url": " https://api.wiretapped.app/clients/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "options": {}
      },
      "id": "5f04968b-5518-4d03-b3a0-63a036960bbd",
      "name": "Get RMM Clients2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        4940,
        360
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.client }}",
                    "rightValue": 5,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "7010c7bd-cfb4-476b-80fb-49b4a160bb7c",
      "name": "Filter to CDN Site",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        5280,
        360
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "b82c02fb-fd74-4489-80a1-788540f6ec46",
                    "leftValue": "={{ $json.hostname }}",
                    "rightValue": "={{ $('If').item.json.Hostname }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "5f2165d7-ad36-4185-ad1a-d8bde07b5603",
      "name": "Map Room to Agent2",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        5040,
        1460
      ]
    },
    {
      "parameters": {
        "path": "9146da97-9f65-4e75-bcbf-f20363f604ec",
        "options": {}
      },
      "id": "2788869b-e8d4-497c-9211-58c0ad33e642",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        1140,
        560
      ],
      "webhookId": "9146da97-9f65-4e75-bcbf-f20363f604ec",
      "disabled": true
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "getAll",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mg86jglo5qmeb27",
        "returnAll": true,
        "options": {
          "sort": {
            "property": [
              {
                "field": "Status",
                "direction": "desc"
              }
            ]
          }
        }
      },
      "id": "4ee6b361-696f-4b4f-ab34-beeb66eeac7e",
      "name": "NocoDB6",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        3120,
        1440
      ],
      "alwaysOutputData": true,
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.wiretapped.app/agents/actions/bulk/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "{\"mode\":\"script\",\"target\":\"all\",\"monType\":\"workstations\",\"osType\":\"windows\",\"cmd\":\"\",\"shell\":\"cmd\",\"custom_shell\":null,\"patchMode\":\"scan\",\"offlineAgents\":false,\"client\":null,\"site\":null,\"agents\":[],\"script\":155,\"timeout\":90,\"args\":[],\"env_vars\":[],\"run_as_user\":false}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "25c9be28-45af-46ad-97cf-5db785653113",
      "name": "Send Script to all Agents",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        2760,
        1440
      ],
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "amount": 15
      },
      "id": "e263d449-3664-4c7a-a08b-e47fc1b5d4d7",
      "name": "Wait1",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2980,
        2180
      ],
      "webhookId": "d52629c4-abb2-4222-8a3f-c9db7821da20"
    },
    {
      "parameters": {
        "authentication": "nocoDbApiToken",
        "operation": "getAll",
        "projectId": "p3hb5s2opbotr1f",
        "table": "mnw77dpsv1v54m3",
        "returnAll": true,
        "options": {}
      },
      "id": "5b25ab78-b734-400a-a809-14cb6336935c",
      "name": "NocoDB7",
      "type": "n8n-nodes-base.nocoDb",
      "typeVersion": 3,
      "position": [
        3180,
        2180
      ],
      "alwaysOutputData": true,
      "credentials": {
        "nocoDbApiToken": {
          "id": "NQp5MuqQIS7vyAPq",
          "name": "NocoDB account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.wiretapped.app/agents/actions/bulk/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={\"mode\":\"script\",\"target\":\"all\",\"monType\":\"all\",\"osType\":\"windows\",\"cmd\":\"\",\"shell\":\"cmd\",\"custom_shell\":null,\"patchMode\":\"scan\",\"offlineAgents\":false,\"client\":null,\"site\":null,\"agents\":[],\"script\":154,\"timeout\":90,\"args\":[],\"env_vars\":[],\"run_as_user\":false}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "a6717140-d952-4c9f-9a26-ef5b259a558c",
      "name": "Send Script to all Agents1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        2780,
        2180
      ],
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "767e6df8-5199-4c4a-830d-4a5241b77aa4",
              "leftValue": "={{ $json.Status }}",
              "rightValue": "=ManualCheckRequired",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "0359dac1-d614-41fe-a3d7-83c8302b85ae",
      "name": "If1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        3720,
        2220
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "id": "b82c02fb-fd74-4489-80a1-788540f6ec46",
                    "leftValue": "={{ $json.hostname }}",
                    "rightValue": "={{ $('If1').item.json.Hostname }}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "6121b327-8e29-43c0-bc2c-c11e3fecd5b4",
      "name": "Map Room to Agent",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        5000,
        2200
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "= https://api.wiretapped.app/agents/{{ $json[\"agent_id\"] }}/runscript/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={ \"output\": \"forget\",  \"emails\": [],  \"emailMode\": \"default\",  \"custom_field\": null,  \"save_all_output\": false,  \"script\": 153,  \"args\": [],  \"env_vars\": [],  \"timeout\": 90,  \"run_as_user\": false}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "541312e2-0385-4923-9cfc-9567509f4081",
      "name": "Send Download Script to Single Agent1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        5200,
        2200
      ],
      "alwaysOutputData": true,
      "disabled": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "= https://api.wiretapped.app/agents/{{ $json[\"agent_id\"] }}/runscript/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={ \"output\": \"forget\",  \"emails\": [],  \"emailMode\": \"default\",  \"custom_field\": null,  \"save_all_output\": false,  \"script\": 152,  \"args\": [],  \"env_vars\": [],  \"timeout\": 90,  \"run_as_user\": false}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "id": "713c1d91-d536-4fb9-aca5-7d860e58411f",
      "name": "Send Download Script to Single Agent",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        5340,
        1460
      ],
      "alwaysOutputData": true,
      "disabled": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "height": 803.0688416610162,
        "width": 2729.9318631363003,
        "color": 5
      },
      "id": "9dff18d1-b846-49e7-b9fa-c4cd47aaba59",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2740,
        2060
      ]
    },
    {
      "parameters": {
        "url": " https://api.wiretapped.app/agents/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "X-API-KEY",
              "value": "YTKN6UOV8EZMJOG591GUCESFVTPEJLUG"
            }
          ]
        },
        "options": {}
      },
      "id": "2c211b23-6fe9-432b-bb27-d2c48e552304",
      "name": "Get RMM Clients4",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        3020,
        420
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "7a1eb2bd-78be-42c9-bed3-35f5826a9510",
      "name": "Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        3200,
        420
      ]
    },
    {
      "parameters": {
        "operation": "write",
        "fileName": "agents.txt",
        "options": {}
      },
      "id": "14d54122-3710-42e5-a115-8484e70eaf7b",
      "name": "Read/Write Files from Disk",
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        3640,
        420
      ]
    },
    {
      "parameters": {
        "operation": "toText",
        "sourceProperty": "data",
        "options": {}
      },
      "id": "c245e876-fc05-4b85-9f65-28d6bbfe3b18",
      "name": "Convert to File",
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        3420,
        420
      ]
    },
    {
      "parameters": {
        "fileSelector": "agents.txt",
        "options": {}
      },
      "id": "8ecb17f5-2207-4d97-8d7a-cb479323c3a2",
      "name": "Read/Write Files from Disk1",
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        4300,
        1460
      ]
    },
    {
      "parameters": {
        "operation": "fromJson",
        "options": {}
      },
      "id": "809a032a-f043-4f6f-b4e5-96c691f6fdd0",
      "name": "Extract from File1",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        4520,
        1460
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "a03b2e86-47d9-4773-8001-c7ee44ae6bb4",
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        4740,
        1460
      ]
    },
    {
      "parameters": {
        "fileSelector": "agents.txt",
        "options": {}
      },
      "id": "5fafcfb3-8b89-4fe1-b06f-8216adf535ca",
      "name": "Read/Write Files from Disk2",
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        3180,
        620
      ]
    },
    {
      "parameters": {
        "operation": "fromJson",
        "options": {}
      },
      "id": "e012d835-2978-4125-b69d-661b9d01fa5c",
      "name": "Extract from File",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        3400,
        620
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "c809918e-5766-45e5-9bcd-f4959fcc134d",
      "name": "Split Out1",
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        3620,
        620
      ]
    },
    {
      "parameters": {
        "fileSelector": "agents.txt",
        "options": {}
      },
      "id": "e2e94eda-5eab-4693-9a22-d8402bd0c88f",
      "name": "Read/Write Files from Disk3",
      "type": "n8n-nodes-base.readWriteFile",
      "typeVersion": 1,
      "position": [
        4340,
        2200
      ]
    },
    {
      "parameters": {
        "operation": "fromJson",
        "options": {}
      },
      "id": "f7c27397-2b4c-4437-8e6a-d184dfd4cb92",
      "name": "Extract from File2",
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        4560,
        2200
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "293cdbc7-58bb-40c4-a1d2-e7621d64692c",
      "name": "Split Out2",
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        4780,
        2200
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 6
            }
          ]
        }
      },
      "id": "7d6ae2ac-0677-4be5-be05-5b55bcf2df81",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        940,
        1380
      ],
      "disabled": true
    },
    {
      "parameters": {},
      "id": "98810de6-c197-4a53-b32b-0b39c4bcd2c4",
      "name": "Limit1",
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        1740,
        2120
      ]
    },
    {
      "parameters": {},
      "id": "bd93a58a-e711-42ee-9c37-46b8a1cd4bc0",
      "name": "No Operation, do nothing",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        4100,
        1460
      ]
    },
    {
      "parameters": {},
      "id": "f67c040a-a4d0-4557-b76d-13a1b4f5534e",
      "name": "No Operation, do nothing1",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        3980,
        1680
      ]
    },
    {
      "parameters": {},
      "id": "b1edbe49-bd87-4358-80dd-307c955af7b2",
      "name": "No Operation, do nothing2",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        4080,
        2200
      ]
    },
    {
      "parameters": {},
      "id": "6f94fb64-b0e1-4c38-b98b-6438e4c8af4d",
      "name": "No Operation, do nothing3",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        3760,
        2560
      ]
    },
    {
      "parameters": {},
      "id": "80a789ad-2fa7-402b-bd77-cfa37e63f9bf",
      "name": "Limit2",
      "type": "n8n-nodes-base.limit",
      "typeVersion": 1,
      "position": [
        3280,
        1320
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 15
            }
          ]
        }
      },
      "id": "3edb7fd2-bfb1-4ba5-a56a-b500eca1da07",
      "name": "Schedule Trigger2",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [
        960,
        2180
      ],
      "disabled": true
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": {
    "node:Schedule Trigger": {
      "recurrencyRules": []
    },
    "node:Schedule Trigger2": {
      "recurrencyRules": []
    }
  },
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2024-07-26T15:05:11.137Z",
  "versionId": "50030e30-88f7-4c1c-907f-00d6e2f55107"
}